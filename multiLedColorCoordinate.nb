(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    229975,       5306]
NotebookOptionsPosition[    227324,       5226]
NotebookOutlinePosition[    227678,       5242]
CellTagsIndexPosition[    227635,       5239]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:901a\:8fc7\:5b9e\:9a8c\:6d4b\:5f97\:7684Red", " ", 
    "LED\:5149\:8c31\:6570\:636e"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"redSpdData", "=", 
     RowBox[{
      RowBox[{
      "Import", "[", "\"\<D:\\\\smartLighting\\\\redSpdData.xls\>\"", "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"redSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"redSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxRedSpd", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"redSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{
    "\:76f8\:5bf9\:5149\:8c31\:5cf0\:503c\:5927\:5c0f", "\:ff0c", 
     "\:5e94\:8be5\:4e3a1"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"redCenterLamda", "=", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"redSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"redSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "maxRedSpd"}], 
      "]"}]}], ";"}], "          ", 
   RowBox[{"(*", "\:5cf0\:503c\:5904\:5bf9\:5e94\:7684\:6ce2\:957f", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"redHwList", "=", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"redSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"redSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"maxRedSpd", "/", "2"}], ",", "2"}], "]"}]}], ";"}], "      ", 
   RowBox[{
   "(*", "spd\:6570\:503c\:4e3a\:5cf0\:503c\:6ce2\:957f\:7684\:4e00\:534a\
\:7684\:5de6\:53f3\:4e24\:70b9\:6ce2\:957f\:5750\:6807", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"redHwL", "=", 
     RowBox[{
      RowBox[{"redCenterLamda", "-", 
       RowBox[{"redHwList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "//", "Abs"}]}], ";"}], 
   "           ", 
   RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:5de6\:8fb9", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"redHwR", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"redHwList", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", "redCenterLamda"}], "  ", "//", 
      "Abs"}]}], ";"}], "           ", 
   RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:53f3\:8fb9", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"redHW", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"redHwList", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "-", 
       RowBox[{"redHwList", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "//", "Abs"}]}], ";"}], 
   "               ", 
   RowBox[{"(*", "\:534a\:6ce2\:5bbd", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"redSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"redSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", "maxRedSpd"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gRed0", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"redSpdData", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"370", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", "0"}], "}"}]}], ","}], "*)"}], 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "\"\<spd\>\""}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Orange", "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\:7ea2\:8272LED\:7684SPD\:6570\:5b66\:6a21\:578b", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"redSpdModel", "[", 
      RowBox[{"x_", ",", "k1L_", ",", "k2L_", ",", "k1R_", ",", "k2R_"}], 
      "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1L"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"redCenterLamda", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"redHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1L"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"redCenterLamda", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"redHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2L", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", 
                   RowBox[{"redCenterLamda", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"redHwL", "*", "2"}], ")"}], "^", "2"}]}]}], "]"}], 
             "^", "2.2"}]}], ",", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], "\[LessEqual]", "x", "<=", 
            RowBox[{"redCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1R"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"redCenterLamda", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"redHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1R"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", 
                    RowBox[{"redCenterLamda", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"redHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2R", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", 
                   RowBox[{"redCenterLamda", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"redHwR", "*", "2"}], ")"}], "^", "2"}]}]}], "]"}], 
             "^", "2"}]}], ",", 
           RowBox[{
            RowBox[{"redCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<=", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gRed1", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"redSpdModel", "[", 
        RowBox[{"x", ",", "0.4233", ",", 
         RowBox[{"-", "0.128"}], ",", "1.746", ",", 
         RowBox[{"-", "0.2381"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"380", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}], ",", 
         RowBox[{"780", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", " ", 
         RowBox[{"Green", ",", 
          RowBox[{"Thickness", "[", "0.004", "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"gRed0", ",", "gRed1"}], "]"}], ";"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.6544944959813123`*^9, 3.6544945150870504`*^9}, {
   3.6544946736082435`*^9, 3.6544947430090313`*^9}, {3.6544948558585167`*^9, 
   3.6544948714198904`*^9}, {3.654494903357071*^9, 3.6544949238617406`*^9}, {
   3.6544950524658747`*^9, 3.654495083592555*^9}, 3.6544952470199556`*^9, 
   3.6544952822964725`*^9, {3.654495371380968*^9, 3.654495380917328*^9}, {
   3.6544954626662908`*^9, 3.654495475961153*^9}, {3.6544955162739844`*^9, 
   3.654495545967432*^9}, 3.6544961779027824`*^9, {3.6544962195605383`*^9, 
   3.6544962687077904`*^9}, {3.6544963226742835`*^9, 
   3.6544963786966305`*^9}, {3.654496424706771*^9, 3.6544964679486446`*^9}, {
   3.654496620422727*^9, 3.6544966403670197`*^9}, {3.6544968195875587`*^9, 
   3.654496832024855*^9}, {3.6544968982223034`*^9, 3.654496924958044*^9}, {
   3.654496957072451*^9, 3.6544970232087436`*^9}, {3.6544970599170895`*^9, 
   3.654497064770327*^9}, 3.65457510232537*^9, {3.654575504403594*^9, 
   3.6545755055483556`*^9}, {3.6545758622616816`*^9, 
   3.6545758849797993`*^9}, {3.654991019579543*^9, 3.6549910303254166`*^9}, {
   3.654991419787898*^9, 3.654991420209793*^9}, {3.6551830016923695`*^9, 
   3.655183054332143*^9}, 3.655722413519084*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:901a\:8fc7\:5b9e\:9a8c\:6d4b\:5f97\:7684Green", " ", 
    "LED\:5149\:8c31\:6570\:636e"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"greenSpdData", "=", 
     RowBox[{
      RowBox[{
      "Import", "[", "\"\<D:\\\\smartLighting\\\\greenSpdData.xls\>\"", "]"}],
       "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"greenSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"greenSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"maxGreenSpd", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"greenSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
    "                          ", 
    RowBox[{"(*", 
     RowBox[{
     "\:76f8\:5bf9\:5149\:8c31\:5cf0\:503c\:5927\:5c0f", "\:ff0c", 
      "\:5e94\:8be5\:4e3a1"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"greenCenterLamda", "=", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"greenSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"greenSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "maxGreenSpd"}], 
      "]"}]}], ";", "      ", "\[IndentingNewLine]", " ", 
    RowBox[{"greenCenterLamda", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"greenCenterLamda", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"greenCenterLamda", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], ";", 
    RowBox[{"(*", "\:5cf0\:503c\:5904\:5bf9\:5e94\:7684\:6ce2\:957f", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"greenHwList", "=", 
     RowBox[{
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"greenSpdData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
         RowBox[{"greenSpdData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"maxGreenSpd", "/", "2"}], ",", "4"}], "]"}], "//", 
      "Sort"}]}], " ", ";", "     ", 
    RowBox[{
    "(*", "spd\:6570\:503c\:4e3a\:5cf0\:503c\:6ce2\:957f\:7684\:4e00\:534a\
\:7684\:5de6\:53f3\:76844\:4e2a\:70b9\:6ce2\:957f\:5750\:6807", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"greenHwL", "=", 
     RowBox[{
      RowBox[{"greenCenterLamda", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"greenHwList", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"greenHwList", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "/", "2"}]}], " ", "//", 
      "Abs"}]}], " ", ";", "         ", 
    RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:5de6\:8fb9", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"greenHwR", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"greenHwList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"greenHwList", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], "-", 
       "greenCenterLamda"}], " ", "//", "Abs"}]}], " ", ";", "         ", 
    RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:53f3\:8fb9", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"greenHW", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"greenHwList", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "+", 
        RowBox[{"greenHwList", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "-", 
        RowBox[{"greenHwList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"greenHwList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", ")"}], "/", "2"}]}], " ", ";",
     "            ", 
    RowBox[{"(*", "\:534a\:6ce2\:5bbd", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"greenSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"greenSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", "maxGreenSpd"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"gGreen0", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"greenSpdData", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"370", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", "0"}], "}"}]}], ","}], "*)"}], 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "\"\<spd\>\""}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Orange", "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", "\:7eff\:8272LED\:7684SPD\:6570\:5b66\:6a21\:578b", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"greenSpdModel", "[", 
      RowBox[{"x_", ",", "k1L_", ",", "k2L_", ",", "k1R_", ",", "k2R_"}], 
      "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1L"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "greenCenterLamda"}], ")"}], "^", "2"}],
                    "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"greenHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1L"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "greenCenterLamda"}], ")"}], "^", "2"}],
                     "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"greenHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2L", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "greenCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"greenHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
              "]"}], "^", 
             RowBox[{"-", "0.1"}]}]}], ",", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], "\[LessEqual]", "x", "<=", 
            "greenCenterLamda"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1R"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "greenCenterLamda"}], ")"}], "^", "2"}],
                    "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"greenHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1R"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "greenCenterLamda"}], ")"}], "^", "2"}],
                     "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"greenHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2R", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "greenCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"greenHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
              "]"}], "^", "0.1"}]}], ",", 
           RowBox[{"greenCenterLamda", "<", "x", "<=", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"gGreen1", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"greenSpdModel", "[", 
        RowBox[{"x", ",", "0.9524", ",", "7.312", ",", "0.6667", ",", 
         RowBox[{"-", "0.3175"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"380", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}], ",", 
         RowBox[{"780", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", " ", 
         RowBox[{"Green", ",", 
          RowBox[{"Thickness", "[", "0.004", "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"gGreen0", ",", "gGreen1"}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6544944959813123`*^9, 3.6544945150870504`*^9}, {
   3.6544946736082435`*^9, 3.6544947430090313`*^9}, {3.6544948558585167`*^9, 
   3.6544948714198904`*^9}, {3.654494903357071*^9, 3.654494909654269*^9}, {
   3.6544952517831306`*^9, 3.6544952798438377`*^9}, {3.654575117554471*^9, 
   3.6545751183139753`*^9}, {3.6545751985432496`*^9, 
   3.6545752635907865`*^9}, {3.6545753048416476`*^9, 
   3.6545753169296618`*^9}, {3.6545755253482227`*^9, 
   3.6545755270033207`*^9}, {3.6545756042121906`*^9, 
   3.6545756064766927`*^9}, {3.6545756410512447`*^9, 
   3.6545757288995857`*^9}, {3.6545758146250553`*^9, 
   3.6545758346083336`*^9}, {3.6545758965304594`*^9, 
   3.6545759710608215`*^9}, {3.6545910746515646`*^9, 3.6545910963394957`*^9}, 
   3.6545916026972485`*^9, {3.6545919561116877`*^9, 3.654591987095981*^9}, {
   3.6545921035227733`*^9, 3.6545921650119514`*^9}, {3.654593051727233*^9, 
   3.6545930575801163`*^9}, {3.6545930920149674`*^9, 
   3.6545931008738604`*^9}, {3.654991436489278*^9, 3.654991436875735*^9}, {
   3.6551830697003465`*^9, 3.65518312406581*^9}, 3.6557224448409634`*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "\:901a\:8fc7\:5b9e\:9a8c\:6d4b\:5f97\:7684Blue", " ", 
    "LED\:5149\:8c31\:6570\:636e"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"blueSpdData", "=", 
     RowBox[{
      RowBox[{
      "Import", "[", "\"\<D:\\\\smartLighting\\\\blueSpdData.xls\>\"", "]"}], 
      "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"blueSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"blueSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxBlueSpd", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"blueSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{
    "\:76f8\:5bf9\:5149\:8c31\:5cf0\:503c\:5927\:5c0f", "\:ff0c", 
     "\:5e94\:8be5\:4e3a1"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blueCenterLamda", "=", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"blueSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"blueSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "maxBlueSpd"}], 
      "]"}]}], " ", ";"}], "   ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"blueCenterLamda", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"blueCenterLamda", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"blueCenterLamda", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}]}], 
    RowBox[{"(*", "\:5cf0\:503c\:5904\:5bf9\:5e94\:7684\:6ce2\:957f", "*)"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blueHwList", "=", 
     RowBox[{
      RowBox[{"Nearest", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"blueSpdData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
         RowBox[{"blueSpdData", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"maxBlueSpd", "/", "2"}], ",", "4"}], "]"}], "//", "Sort"}]}],
     " ", ";"}], "     ", 
   RowBox[{
   "(*", "spd\:6570\:503c\:4e3a\:5cf0\:503c\:6ce2\:957f\:7684\:4e00\:534a\
\:7684\:5de6\:53f3\:4e24\:70b9\:6ce2\:957f\:5750\:6807", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blueHwL", "=", 
     RowBox[{
      RowBox[{"blueCenterLamda", "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"blueHwList", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "+", 
          RowBox[{"blueHwList", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], ")"}], "/", "2"}]}], " ", "//", 
      "Abs"}]}], ";"}], "        ", 
   RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:5de6\:8fb9", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blueHwR", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"blueHwList", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"blueHwList", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", "2"}], "-", 
       "blueCenterLamda"}], " ", "//", "Abs"}]}], " ", ";"}], "      ", 
   RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:53f3\:8fb9", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"blueHW", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"blueHwList", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "+", 
        RowBox[{"blueHwList", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "-", 
        RowBox[{"blueHwList", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"blueHwList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], " ", ")"}], "/", "2"}]}], ";"}], 
   "             ", 
   RowBox[{"(*", "\:534a\:6ce2\:5bbd", "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"blueSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"blueSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", "maxBlueSpd"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gBlue0", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"blueSpdData", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"370", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", "0"}], "}"}]}], ","}], "*)"}], 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "\"\<spd\>\""}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Orange", "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\:84dd\:8272LED\:7684SPD", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"blueSpdModel", "[", 
      RowBox[{"x_", ",", "k1L_", ",", "k2L_", ",", "k1R_", ",", "k2R_"}], 
      "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1L"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "blueCenterLamda"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"blueHwL", "*", "3"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1L"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "blueCenterLamda"}], ")"}], "^", "2"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"blueHwL", "*", "3"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2L", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "blueCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"blueHwL", "*", "3"}], ")"}], "^", "2"}]}]}], "]"}],
              "^", 
             RowBox[{"-", "0.1"}]}]}], ",", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], "\[LessEqual]", "x", "<=", 
            RowBox[{"blueCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1R"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "blueCenterLamda"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"blueHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1R"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "blueCenterLamda"}], ")"}], "^", "2"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"blueHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2R", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "blueCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"blueHwR", "*", "2"}], ")"}], "^", "2"}]}]}], "]"}],
              "^", "0.1"}]}], ",", 
           RowBox[{
            RowBox[{"blueCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<=", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gBlue1", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"blueSpdModel", "[", 
        RowBox[{
        "x", ",", "2.0899", ",", "5.566", ",", "0.7937", ",", "1.5873"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"380", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}], ",", 
         RowBox[{"780", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", " ", 
         RowBox[{"Green", ",", 
          RowBox[{"Thickness", "[", "0.004", "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", 
     RowBox[{"gBlue0", ",", "gBlue1"}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6544944959813123`*^9, 3.6544945150870504`*^9}, {
   3.6544946736082435`*^9, 3.6544947178132305`*^9}, {3.6544950918630667`*^9, 
   3.65449509602384*^9}, {3.654495254324828*^9, 3.6544952761103497`*^9}, {
   3.6545752855878663`*^9, 3.654575285987131*^9}, {3.6545760844236555`*^9, 
   3.6545760848849616`*^9}, {3.6545761327055225`*^9, 3.65457626970117*^9}, 
   3.654576306720117*^9, {3.6545765020642414`*^9, 3.65457660127931*^9}, {
   3.654991448793527*^9, 3.6549914491841693`*^9}, {3.655183303421217*^9, 
   3.655183333531328*^9}, 3.6557224675810513`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:901a\:8fc7\:5b9e\:9a8c\:6d4b\:5f97\:7684Amber", " ", 
    "LED\:5149\:8c31\:6570\:636e"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"amberSpdData", "=", 
     RowBox[{
      RowBox[{
      "Import", "[", "\"\<D:\\\\smartLighting\\\\amberSpdData.xls\>\"", "]"}],
       "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"amberSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"amberSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"maxAmberSpd", "=", 
     RowBox[{"Max", "[", 
      RowBox[{"amberSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";", "    ", 
    RowBox[{"(*", 
     RowBox[{
     "\:76f8\:5bf9\:5149\:8c31\:5cf0\:503c\:5927\:5c0f", "\:ff0c", 
      "\:5e94\:8be5\:4e3a1"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"amberCenterLamda", "=", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"amberSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"amberSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "maxAmberSpd"}], 
      "]"}]}], ";", "         ", 
    RowBox[{"(*", "\:5cf0\:503c\:5904\:5bf9\:5e94\:7684\:6ce2\:957f", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"amberHwList", "=", 
     RowBox[{"Nearest", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"amberSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}], "\[Rule]", 
        RowBox[{"amberSpdData", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"maxAmberSpd", "/", "2"}], ",", "2"}], "]"}]}], ";", "      ", 
    RowBox[{
    "(*", "spd\:6570\:503c\:4e3a\:5cf0\:503c\:6ce2\:957f\:7684\:4e00\:534a\
\:7684\:5de6\:53f3\:4e24\:70b9\:6ce2\:957f\:5750\:6807", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"amberHwL", "=", 
     RowBox[{"amberCenterLamda", "-", 
      RowBox[{"amberHwList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], " ", ";", "        ", 
    RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:5de6\:8fb9", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"amberHwR", "=", 
     RowBox[{
      RowBox[{"amberHwList", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", "amberCenterLamda"}]}], " ", ";", 
    "        ", 
    RowBox[{"(*", "\:6ce2\:957f\:534a\:5bbd\:53f3\:8fb9", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"amberHW", "=", 
     RowBox[{
      RowBox[{"amberHwList", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"amberHwList", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "            ", 
    RowBox[{"(*", "\:534a\:6ce2\:5bbd", "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"amberSpdData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"amberSpdData", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", "maxAmberSpd"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"gAmber0", "=", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"amberSpdData", ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"370", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", "0"}], "}"}]}], ","}], "*)"}], 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\[Lambda]\>\"", ",", "\"\<spd\>\""}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Orange", "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";", "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
    "(*", "\:7425\:73c0\:8272LED\:7684SPD\:6570\:5b66\:6a21\:578b", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"amberSpdModel", "[", 
      RowBox[{"x_", ",", "k1L_", ",", "k2L_", ",", "k1R_", ",", "k2R_"}], 
      "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1L"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "amberCenterLamda"}], ")"}], "^", "2"}],
                    "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"amberHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1L"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "amberCenterLamda"}], ")"}], "^", "2"}],
                     "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"amberHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "9"}], "*", "0"}]}], ")"}], "/", "1"}], ")"}], 
            "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2L", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "amberCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"amberHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
              "]"}], "^", "1.2"}]}], ",", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], "\[LessEqual]", "x", "<=", 
            RowBox[{"amberCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1R"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "amberCenterLamda"}], ")"}], "^", "2"}],
                    "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"amberHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1R"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "amberCenterLamda"}], ")"}], "^", "2"}],
                     "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"amberHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2R", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "amberCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"amberHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
              "]"}], "^", "0.4"}]}], ",", 
           RowBox[{
            RowBox[{"amberCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<=", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}],
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"amberSpdModel", "[", 
      RowBox[{"6.078`*^-7", ",", "4.0741", ",", 
       RowBox[{"-", "2.698"}], ",", "1.4815", ",", "1.92"}], "]"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"gAmber1", "=", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"amberSpdModel", "[", 
        RowBox[{"x", ",", "4.0741", ",", 
         RowBox[{"-", "2.698"}], ",", "0.7937`", ",", 
         RowBox[{"-", "0.106`"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"380", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}], ",", 
         RowBox[{"780", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", " ", 
         RowBox[{"Green", ",", 
          RowBox[{"Thickness", "[", "0.004", "]"}]}], "}"}]}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{"gAmber0", ",", "gAmber1"}], "]"}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6544944959813123`*^9, 3.6544945150870504`*^9}, {
   3.6544946736082435`*^9, 3.6544947178132305`*^9}, {3.6544950918630667`*^9, 
   3.6544951149324455`*^9}, {3.65449516557507*^9, 3.6544951754446507`*^9}, {
   3.654495256818487*^9, 3.6544952666830645`*^9}, {3.654576615079466*^9, 
   3.6545766317135077`*^9}, 3.654576856013795*^9, {3.6545769289572077`*^9, 
   3.6545769834579515`*^9}, {3.6545770801583395`*^9, 
   3.6545771128920536`*^9}, {3.6545771672166204`*^9, 
   3.6545771863593206`*^9}, {3.6545772257534003`*^9, 
   3.6545772720446377`*^9}, {3.6545773108523827`*^9, 3.654577315010147*^9}, {
   3.6545773656868973`*^9, 3.6545773720731363`*^9}, {3.654577467901845*^9, 
   3.6545774930665426`*^9}, 3.654577525703714*^9, 3.654577712041424*^9, 
   3.6545778431607523`*^9, 3.6545778886254797`*^9, 3.654578067943458*^9, {
   3.6545782454607143`*^9, 3.654578247628149*^9}, {3.6545808451753335`*^9, 
   3.65458089125841*^9}, 3.6545809894580083`*^9, {3.654581691655048*^9, 
   3.6545817276934347`*^9}, {3.654581793292506*^9, 3.654581873381751*^9}, 
   3.654591062629589*^9, 3.654594212063306*^9, {3.6545982494400625`*^9, 
   3.654598258598139*^9}, {3.654991457554839*^9, 3.6549914579740105`*^9}, {
   3.6551833879060163`*^9, 3.6551834267678213`*^9}, 3.655722499823558*^9}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Lime", " ", "LED"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"limeCenterLamda", "=", 
     RowBox[{"{", 
      RowBox[{"545", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "9"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limeHwL", "=", 
     RowBox[{"30", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"limeHwR", "=", 
     RowBox[{"60", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"limeSpdModel", "[", 
      RowBox[{"x_", ",", "k1L_", ",", "k2L_", ",", "k1R_", ",", "k2R_"}], 
      "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1L"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "limeCenterLamda"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"limeHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1L"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "limeCenterLamda"}], ")"}], "^", "2"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"limeHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2L", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "limeCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"limeHwL", "*", "2"}], ")"}], "^", "2"}]}]}], "]"}],
              "^", 
             RowBox[{"-", "2"}]}]}], ",", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], "\[LessEqual]", "x", "<=", 
            RowBox[{"limeCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1R"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "limeCenterLamda"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"limeHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1R"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "limeCenterLamda"}], ")"}], "^", "2"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"limeHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2R", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "limeCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"limeHwR", "*", "2"}], ")"}], "^", "2"}]}]}], "]"}],
              "^", "0.4"}]}], ",", 
           RowBox[{
            RowBox[{"limeCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<=", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.654578254626792*^9, 3.654578485181529*^9}, {
   3.6545786302258873`*^9, 3.654578727148246*^9}, {3.6545787680499134`*^9, 
   3.6545790682937503`*^9}, {3.6545790995224733`*^9, 3.654579100556156*^9}, {
   3.6545791429082975`*^9, 3.6545791432605295`*^9}, {3.654579191173193*^9, 
   3.6545792131547756`*^9}, 3.654579271032577*^9, {3.654579413264002*^9, 
   3.654579438403205*^9}, {3.6545796363979187`*^9, 3.654579699827993*^9}, {
   3.6545806196689577`*^9, 3.6545806235262814`*^9}, {3.6545958348257775`*^9, 
   3.6545958437336893`*^9}, {3.654595901939277*^9, 3.65459606075113*^9}, {
   3.6549914660332813`*^9, 3.65499146640553*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"pcAmber", " ", "LED\:7684SPD\:6570\:5b66\:6a21\:578b"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"pcAmberCenterLamda", "=", 
     RowBox[{"{", 
      RowBox[{"595", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "9"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pcAmberHwL", "=", 
     RowBox[{"30", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pcAmberHwR", "=", 
     RowBox[{"50", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"pcAmberSpdModel", "[", 
      RowBox[{"x_", ",", "k1L_", ",", "k2L_", ",", "k1R_", ",", "k2R_"}], 
      "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1L"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "pcAmberCenterLamda"}], ")"}], "^", 
                    "2"}], "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pcAmberHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1L"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "pcAmberCenterLamda"}], ")"}], "^", 
                    "2"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pcAmberHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2L", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "pcAmberCenterLamda"}], ")"}], "^", "2"}],
                 "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pcAmberHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
              "]"}], "^", 
             RowBox[{"-", "2"}]}]}], ",", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], "\[LessEqual]", "x", "<=", 
            RowBox[{"pcAmberCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1R"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "pcAmberCenterLamda"}], ")"}], "^", 
                    "2"}], "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pcAmberHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1R"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "pcAmberCenterLamda"}], ")"}], "^", 
                    "2"}], "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"pcAmberHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2R", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "pcAmberCenterLamda"}], ")"}], "^", "2"}],
                 "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pcAmberHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
              "]"}], "^", 
             RowBox[{"-", "0.4"}]}]}], ",", 
           RowBox[{
            RowBox[{"pcAmberCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<=", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654578254626792*^9, 3.654578485181529*^9}, {
   3.6545786302258873`*^9, 3.654578727148246*^9}, {3.6545787680499134`*^9, 
   3.6545790682937503`*^9}, {3.6545790995224733`*^9, 3.654579100556156*^9}, {
   3.6545791429082975`*^9, 3.6545791432605295`*^9}, {3.654579191173193*^9, 
   3.6545792131547756`*^9}, 3.654579271032577*^9, {3.654579413264002*^9, 
   3.654579438403205*^9}, {3.6545796363979187`*^9, 3.654579699827993*^9}, {
   3.6545806196689577`*^9, 3.6545806235262814`*^9}, {3.6545958348257775`*^9, 
   3.6545958437336893`*^9}, {3.654595901939277*^9, 3.6545960382280183`*^9}, {
   3.654596099730996*^9, 3.654596105908923*^9}, {3.6545986296819487`*^9, 
   3.6545986327519827`*^9}, {3.654599294139838*^9, 3.654599301791916*^9}, {
   3.654811320036723*^9, 3.654811325934035*^9}, {3.6549914727699738`*^9, 
   3.6549914731293697`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"cyan", " ", "LED\:7684SPD\:6570\:5b66\:6a21\:578b"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cyanCenterLamda", "=", 
     RowBox[{"{", 
      RowBox[{"505", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "9"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cyanHwL", "=", 
     RowBox[{"12", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cyanHwR", "=", 
     RowBox[{"18", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"cyanSpdModel", "[", 
      RowBox[{"x_", ",", "k1L_", ",", "k2L_", ",", "k1R_", ",", "k2R_"}], 
      "]"}], ":=", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1L"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "cyanCenterLamda"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cyanHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1L"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "cyanCenterLamda"}], ")"}], "^", "2"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cyanHwL", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2L", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "cyanCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"cyanHwL", "*", "2"}], ")"}], "^", "2"}]}]}], "]"}],
              "^", "0"}]}], ",", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], "\[LessEqual]", "x", "<=", 
            RowBox[{"cyanCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "k1R"}], "*", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "cyanCenterLamda"}], ")"}], "^", "2"}], 
                   "/", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cyanHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                 "]"}], "+", 
                RowBox[{"2", "*", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "k1R"}], "*", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "cyanCenterLamda"}], ")"}], "^", "2"}], 
                    "/", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"cyanHwR", "*", "2"}], ")"}], "^", "2"}]}]}], 
                   "]"}], "^", "5"}]}]}], ")"}], "/", "3"}], ")"}], "*", 
            RowBox[{
             RowBox[{"Cosh", "[", 
              RowBox[{"k2R", "*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"x", "-", "cyanCenterLamda"}], ")"}], "^", "2"}], 
                "/", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"cyanHwR", "*", "2"}], ")"}], "^", "2"}]}]}], "]"}],
              "^", "0"}]}], ",", 
           RowBox[{
            RowBox[{"cyanCenterLamda", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<", "x", "<=", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}]}], "}"}]}], "}"}], ",", "0"}], "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654578254626792*^9, 3.654578485181529*^9}, {
   3.6545786302258873`*^9, 3.654578727148246*^9}, {3.6545787680499134`*^9, 
   3.6545790682937503`*^9}, {3.6545790995224733`*^9, 3.654579100556156*^9}, {
   3.6545791429082975`*^9, 3.6545791432605295`*^9}, {3.654579191173193*^9, 
   3.6545792131547756`*^9}, 3.654579271032577*^9, {3.654579413264002*^9, 
   3.654579438403205*^9}, {3.6545796363979187`*^9, 3.654579699827993*^9}, {
   3.6545806196689577`*^9, 3.6545806235262814`*^9}, {3.6545958348257775`*^9, 
   3.6545958437336893`*^9}, {3.654595901939277*^9, 3.6545960382280183`*^9}, {
   3.654596099730996*^9, 3.654596105908923*^9}, {3.6545986296819487`*^9, 
   3.6545986327519827`*^9}, {3.654599294139838*^9, 3.654599301791916*^9}, {
   3.654811320036723*^9, 3.65481137264907*^9}, {3.6549914799010534`*^9, 
   3.6549914802760715`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"multiLedSpdModel", "[", 
      RowBox[{
      "x_", ",", "kRed_", ",", "kBlue_", ",", "kLime_", ",", "kPcAmber_", ",",
        "kCyan_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"kRed", "*", 
       RowBox[{"redSpdModel", "[", 
        RowBox[{"x", ",", "0.4233", ",", 
         RowBox[{"-", "0.128"}], ",", "1.746", ",", 
         RowBox[{"-", "0.2381"}]}], "]"}]}], "+", 
      RowBox[{"kBlue", "*", 
       RowBox[{"blueSpdModel", "[", 
        RowBox[{
        "x", ",", "2.0899", ",", "5.566", ",", "0.7937", ",", "1.5873"}], 
        "]"}]}], "+", 
      RowBox[{"kLime", "*", 
       RowBox[{"limeSpdModel", "[", 
        RowBox[{"x", ",", "2.17", ",", 
         RowBox[{"-", "1.75"}], ",", "1.4815", ",", "1.92"}], "]"}]}], "+", 
      RowBox[{"kPcAmber", "*", 
       RowBox[{"pcAmberSpdModel", "[", 
        RowBox[{"x", ",", "2.17", ",", 
         RowBox[{"-", "1.53"}], ",", "1.11", ",", "1.53"}], "]"}]}], "+", 
      RowBox[{"kCyan", "*", 
       RowBox[{"cyanSpdModel", "[", 
        RowBox[{"x", ",", "0.79", ",", 
         RowBox[{"-", "1.53"}], ",", "1.11", ",", "1.53"}], "]"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"multiLedSpdModel", "[", 
        RowBox[{
        "x", ",", "kRed", ",", "kBlue", ",", "kLime", ",", "kPcAmber", ",", 
         "kCyan"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"380", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}], ",", 
         RowBox[{"780", "*", 
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"380", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}], ",", 
            RowBox[{"780", "*", 
             RowBox[{"10", "^", 
              RowBox[{"-", "9"}]}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", " ", 
         RowBox[{"Green", ",", 
          RowBox[{"Thickness", "[", "0.004", "]"}]}], "}"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "*)"}], 
       ",", 
       RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
       RowBox[{"GridLinesStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"Orange", ",", "Dashed"}], "]"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kRed", ",", "0.6", ",", "\"\<kRed\>\""}], "}"}], ",", "0", 
       ",", "1", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kBlue", ",", "0.2", ",", "\"\<kBlue\>\""}], "}"}], ",", "0", 
       ",", "1", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kLime", ",", "0.6", ",", "\"\<kLime\>\""}], "}"}], ",", "0", 
       ",", "1", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kPcAmber", ",", "0.6", ",", "\"\<kPcAmber\>\""}], "}"}], ",",
        "0", ",", "1", ",", "0.1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"kCyan", ",", "0.3", ",", "\"\<kCyan\>\""}], "}"}], ",", "0", 
       ",", "1", ",", "0.1"}], "}"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "FrameLabel", "\[Rule]", 
        "\"\<multiLedSpdModel(x,kRed,kGreen,kBlue,kAmber)\>\""}], ","}], 
      "*)"}], " ", 
     RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"tmpLEDs", "=", 
      RowBox[{"multiLedSpdModel", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], "*", 
         RowBox[{"10", "^", 
          RowBox[{"-", "9"}]}]}], ",", "0.2", ",", "0.2", ",", "0.3", ",", 
        "0.4", ",", "0.2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"maxTmpLEDs", "=", 
      RowBox[{"Max", "[", "tmpLEDs", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmpLEDs", "=", 
      RowBox[{"tmpLEDs", "/", "maxTmpLEDs"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tmpLEDs", "=", 
     RowBox[{"multiLedSpdModel", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ",", "0.45", ",", "0.2", ",", "0.35", ",", 
       "0.4", ",", "0.3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"maxTmpLEDs", "=", 
     RowBox[{"Max", "[", "tmpLEDs", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"tmpLEDs", "=", "tmpLEDs", 
    RowBox[{"(*", 
     RowBox[{"/", "maxTmpLEDs"}], "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.654578254626792*^9, 3.654578485181529*^9}, {
   3.6545786302258873`*^9, 3.654578727148246*^9}, {3.6545787680499134`*^9, 
   3.6545790682937503`*^9}, {3.6545790995224733`*^9, 3.654579100556156*^9}, {
   3.6545791429082975`*^9, 3.6545791432605295`*^9}, {3.654579191173193*^9, 
   3.6545792131547756`*^9}, 3.654579271032577*^9, {3.654579413264002*^9, 
   3.654579438403205*^9}, {3.6545796363979187`*^9, 3.654579699827993*^9}, {
   3.6545806196689577`*^9, 3.6545806235262814`*^9}, {3.6545958348257775`*^9, 
   3.6545958437336893`*^9}, {3.654595901939277*^9, 3.6545960382280183`*^9}, {
   3.654596099730996*^9, 3.654596105908923*^9}, {3.6545986296819487`*^9, 
   3.6545986327519827`*^9}, {3.654599294139838*^9, 3.65459936604128*^9}, {
   3.6545993986439114`*^9, 3.654599451101042*^9}, {3.6548097801785088`*^9, 
   3.6548098455534525`*^9}, {3.6548100858253183`*^9, 3.654810161189749*^9}, {
   3.6548114020421515`*^9, 3.6548114279483585`*^9}, {3.6548114707131357`*^9, 
   3.654811620854746*^9}, {3.65481180031598*^9, 3.6548118889629283`*^9}, {
   3.654811921708807*^9, 3.6548119341460676`*^9}, {3.6548120222593503`*^9, 
   3.654812113165456*^9}, {3.654812148989251*^9, 3.654812153070961*^9}, {
   3.654812204356511*^9, 3.65481220839419*^9}, 3.6548122525615444`*^9, {
   3.6549899840254707`*^9, 3.654990047908193*^9}, 3.654990087386961*^9, {
   3.6549901333522744`*^9, 3.654990163177987*^9}, {3.6549901951905837`*^9, 
   3.6549902233377867`*^9}, {3.654990261921316*^9, 3.654990268609132*^9}, {
   3.654990411551407*^9, 3.6549904129969544`*^9}, {3.654990463644514*^9, 
   3.6549904670227757`*^9}, {3.6549906377160845`*^9, 
   3.6549906608867188`*^9}, {3.6549908106798806`*^9, 3.654990822965191*^9}, {
   3.65499085660874*^9, 3.654990883785367*^9}, 3.654990938716631*^9, {
   3.654991091087997*^9, 3.654991132403174*^9}, {3.6549911721096296`*^9, 
   3.6549911949839897`*^9}, {3.655010375628297*^9, 3.655010376878372*^9}, 
   3.655010462366213*^9, {3.655010497848279*^9, 3.6550105042364216`*^9}, 
   3.655010587005001*^9, 3.65501063148048*^9, {3.6550106655320296`*^9, 
   3.655010668883732*^9}, {3.655183452525365*^9, 3.655183454629764*^9}, {
   3.6557929351034517`*^9, 3.6557929476517725`*^9}, {3.656025197155098*^9, 
   3.656025200916597*^9}, {3.6560252409151683`*^9, 3.6560252458674583`*^9}, {
   3.6560254004183464`*^9, 3.656025401550098*^9}, {3.6560255105799437`*^9, 
   3.6560256399767265`*^9}, {3.656025786307418*^9, 3.6560258148203354`*^9}, {
   3.656026130423701*^9, 3.6560261687780433`*^9}, 3.656026251586294*^9, {
   3.656026326717709*^9, 3.6560263296536617`*^9}, 3.6560263844010897`*^9, 
   3.6560286580992002`*^9, {3.656040224875064*^9, 3.6560402252913404`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`kBlue$$ = 0.2, $CellContext`kCyan$$ = 
    0.3, $CellContext`kLime$$ = 0.6, $CellContext`kPcAmber$$ = 
    0.6, $CellContext`kRed$$ = 0.6, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"\:65e0\:6807\:9898\"", Typeset`specs$$ = {{{
       Hold[$CellContext`kRed$$], 0.6, "kRed"}, 0, 1, 0.1}, {{
       Hold[$CellContext`kBlue$$], 0.2, "kBlue"}, 0, 1, 0.1}, {{
       Hold[$CellContext`kLime$$], 0.6, "kLime"}, 0, 1, 0.1}, {{
       Hold[$CellContext`kPcAmber$$], 0.6, "kPcAmber"}, 0, 1, 0.1}, {{
       Hold[$CellContext`kCyan$$], 0.3, "kCyan"}, 0, 1, 0.1}}, 
    Typeset`size$$ = {360., {117., 122.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`kRed$37937$$ = 0, $CellContext`kBlue$37938$$ = 
    0, $CellContext`kLime$37939$$ = 0, $CellContext`kPcAmber$37940$$ = 
    0, $CellContext`kCyan$37941$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`kBlue$$ = 0.2, $CellContext`kCyan$$ = 
        0.3, $CellContext`kLime$$ = 0.6, $CellContext`kPcAmber$$ = 
        0.6, $CellContext`kRed$$ = 0.6}, "ControllerVariables" :> {
        Hold[$CellContext`kRed$$, $CellContext`kRed$37937$$, 0], 
        Hold[$CellContext`kBlue$$, $CellContext`kBlue$37938$$, 0], 
        Hold[$CellContext`kLime$$, $CellContext`kLime$37939$$, 0], 
        Hold[$CellContext`kPcAmber$$, $CellContext`kPcAmber$37940$$, 0], 
        Hold[$CellContext`kCyan$$, $CellContext`kCyan$37941$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Plot[
        $CellContext`multiLedSpdModel[$CellContext`x, $CellContext`kRed$$, \
$CellContext`kBlue$$, $CellContext`kLime$$, $CellContext`kPcAmber$$, \
$CellContext`kCyan$$], {$CellContext`x, 380 10^(-9), 780 10^(-9)}, 
        PlotRange -> {{380 10^(-9), 780 10^(-9)}, {0, 1.5}}, 
        PlotStyle -> {Green, 
          Thickness[0.004]}, GridLines -> Automatic, GridLinesStyle -> 
        Directive[Orange, Dashed]], 
      "Specifications" :> {{{$CellContext`kRed$$, 0.6, "kRed"}, 0, 1, 
         0.1}, {{$CellContext`kBlue$$, 0.2, "kBlue"}, 0, 1, 
         0.1}, {{$CellContext`kLime$$, 0.6, "kLime"}, 0, 1, 
         0.1}, {{$CellContext`kPcAmber$$, 0.6, "kPcAmber"}, 0, 1, 
         0.1}, {{$CellContext`kCyan$$, 0.3, "kCyan"}, 0, 1, 0.1}}, 
      "Options" :> {ControlPlacement -> Right}, "DefaultOptions" :> {}],
     ImageSizeCache->{687., {149., 154.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.6557828181690063`*^9, 3.655792386444145*^9, 3.655792950934951*^9, 
   3.655794873069741*^9, 3.656017629595749*^9, 3.6560229008669415`*^9, 
   3.65602520154801*^9, 3.6560252468891315`*^9, {3.6560256278216577`*^9, 
   3.6560256406421633`*^9}, {3.656025789530554*^9, 3.6560258154297347`*^9}, 
   3.656025894962742*^9, 3.656026134836624*^9, 3.656026201286193*^9, {
   3.6560262534955573`*^9, 3.65602625636546*^9}, 3.656026350138251*^9, {
   3.656040226226961*^9, 3.6560402289137444`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0.11717738898889322`", "}"}], ",", 
   RowBox[{"{", "0.17827602096516967`", "}"}], ",", 
   RowBox[{"{", "0.21804978222247115`", "}"}], ",", 
   RowBox[{"{", "0.2131470945186851`", "}"}], ",", 
   RowBox[{"{", "0.18069788893015265`", "}"}], ",", 
   RowBox[{"{", "0.15811123400877364`", "}"}], ",", 
   RowBox[{"{", "0.1734860435217388`", "}"}], ",", 
   RowBox[{"{", "0.23151524755610065`", "}"}], ",", 
   RowBox[{"{", "0.3053361110243033`", "}"}], ",", 
   RowBox[{"{", "0.3442509526047886`", "}"}], ",", 
   RowBox[{"{", "0.3333745919651554`", "}"}], ",", 
   RowBox[{"{", "0.29884532602936803`", "}"}], ",", 
   RowBox[{"{", "0.26891724604681155`", "}"}], ",", 
   RowBox[{"{", "0.2656596405680955`", "}"}], ",", 
   RowBox[{"{", "0.29249178567019074`", "}"}], ",", 
   RowBox[{"{", "0.3356375771941125`", "}"}], ",", 
   RowBox[{"{", "0.3734311608981475`", "}"}], ",", 
   RowBox[{"{", "0.3871853831439392`", "}"}], ",", 
   RowBox[{"{", "0.38521239107624694`", "}"}], ",", 
   RowBox[{"{", "0.38366745622455145`", "}"}], ",", 
   RowBox[{"{", "0.384239428798553`", "}"}], ",", 
   RowBox[{"{", "0.3901559894783754`", "}"}], ",", 
   RowBox[{"{", "0.406360624313007`", "}"}], ",", 
   RowBox[{"{", "0.4373627087308226`", "}"}], ",", 
   RowBox[{"{", "0.4824960094317531`", "}"}], ",", 
   RowBox[{"{", "0.5318001334251671`", "}"}], ",", 
   RowBox[{"{", "0.5673705084347236`", "}"}], ",", 
   RowBox[{"{", "0.5716971173123211`", "}"}], ",", 
   RowBox[{"{", "0.5555482658130111`", "}"}], ",", 
   RowBox[{"{", "0.5379596521569866`", "}"}], ",", 
   RowBox[{"{", "0.5214757975353604`", "}"}], ",", 
   RowBox[{"{", "0.5112780138543078`", "}"}], ",", 
   RowBox[{"{", "0.5235840959281254`", "}"}], ",", 
   RowBox[{"{", "0.5893673360173837`", "}"}], ",", 
   RowBox[{"{", "0.6984200337880592`", "}"}], ",", 
   RowBox[{"{", "0.7347165926797994`", "}"}], ",", 
   RowBox[{"{", "0.5550366400607045`", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6557828181690063`*^9, 3.655792386444145*^9, 3.655792950934951*^9, 
   3.655794873069741*^9, 3.656017629595749*^9, 3.6560229008669415`*^9, 
   3.65602520154801*^9, 3.6560252468891315`*^9, {3.6560256278216577`*^9, 
   3.6560256406421633`*^9}, {3.656025789530554*^9, 3.6560258154297347`*^9}, 
   3.656025894962742*^9, 3.656026134836624*^9, 3.656026201286193*^9, {
   3.6560262534955573`*^9, 3.65602625636546*^9}, 3.656026350138251*^9, {
   3.656040226226961*^9, 3.656040229053835*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.655723415640912*^9, 3.6557234156719317`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cie1931Table", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
     "Import", "[", "\"\<D:\\\\smartLighting\\\\cie1931_obersever.xls\>\"", 
      "]"}], "//", 
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"#", ",", "1"}], "]"}], "&"}]}], 
    RowBox[{"(*", 
     RowBox[{"//", "MatrixForm"}], "*)"}], "//", "Compress"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cie1931Data", "=", 
   RowBox[{"Uncompress", "[", "cie1931Table", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cie1931Length", "=", 
    RowBox[{
     RowBox[{"cie1931Data", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "*", 
     RowBox[{"10", "^", 
      RowBox[{"-", "9"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"deltaWaveLength", "="}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cie1931xBar", "=", 
   RowBox[{"cie1931Data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cie1931yBar", "=", 
   RowBox[{"cie1931Data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cie1931zBar", "=", 
    RowBox[{"cie1931Data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cie1964uBar", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "/", "3"}], ")"}], "*", "cie1931xBar"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cie1964vBar", "=", "cie1931yBar"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"cie1964wBar", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.5"}], "*", "cie1931xBar"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "/", "2"}], ")"}], "*", "cie1931yBar"}], "+", 
     RowBox[{"0.5", "*", "cie1931zBar"}]}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "%", " ", "2002", " ", "CODATA", " ", "recommended", " ", "values"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"6.6260693", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "34"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c", "=", "299792458"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"k", "=", 
   RowBox[{"1.3806505", "*", 
    RowBox[{"10", "^", 
     RowBox[{"-", "23"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"2", "*", "Pi", "*", "h", "*", 
    RowBox[{"c", "^", "2"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"c2", "=", 
    RowBox[{"h", "*", 
     RowBox[{"c", "/", "k"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "xxxxxxxxxxxxxx", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MrecpK", "=", 
    RowBox[{
     RowBox[{"Range", "[", "600", "]"}], "//", 
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{"#", ",", "0.01"}], "]"}], "&"}]}]}], " ", ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      RowBox[{"0.01", " ", "1"}], ":", "600"}], "]"}], ";", "            ", 
    RowBox[{
    "%", " ", "mega", " ", "reciprical", " ", "Kelvin", " ", "values", " ", 
     "of", " ", "isotemperature", " ", "lines"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", 
    RowBox[{"1.", "/", 
     RowBox[{"(", 
      RowBox[{"MrecpK", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "6"}]}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dwave", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "=", 
    RowBox[{"v", "=", 
     RowBox[{"sl", "=", 
      RowBox[{"m", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}]}]}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"(*", "2", "*)"}], 
     RowBox[{"Length", "[", "T", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"spdref", "=", 
      RowBox[{"c1", "*", 
       RowBox[{
        RowBox[{"cie1931Length", "^", 
         RowBox[{"-", "5"}]}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"c2", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"T", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", "cie1931Length"}], 
             ")"}]}], "]"}], "-", "1"}], ")"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"spdref", "=", 
      RowBox[{"spdref", "/", 
       RowBox[{"Max", "[", "spdref", "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "%", " ", "Equations", " ", "from", " ", "Wyszecki", " ", "and", " ", 
        "Sitles"}], ",", 
       RowBox[{"Color", " ", "Science"}], ",", 
       RowBox[{"2", "nd", " ", 
        RowBox[{"ed", ".", "1982"}]}], ",", 
       RowBox[{"page", " ", "%", " ", "226", " ", "and", " ", "227"}]}], 
      "*)"}], "\n", 
     RowBox[{"U", "=", 
      RowBox[{
       RowBox[{"spdref", "*", "cie1964uBar"}], "//", "Total"}]}], ";", "\n", 
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{"spdref", "*", "cie1964vBar"}], "//", "Total"}]}], ";", "\n", 
     RowBox[{"W", "=", 
      RowBox[{
       RowBox[{"spdref", "*", "cie1964wBar"}], "//", "Total"}]}], ";", "\n", 
     RowBox[{"R", "=", 
      RowBox[{"U", "+", "V", "+", "W"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"U", "/", "R"}]}], ";", "\n", 
     RowBox[{
      RowBox[{"v", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"V", "/", "R"}]}], ";", "\[IndentingNewLine]", "\n", 
     RowBox[{"Uprime", "=", 
      RowBox[{"c1", "*", "c2", "*", 
       RowBox[{
        RowBox[{"T", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "^", 
        RowBox[{"-", "2"}]}], "*", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"cie1931Length", "^", 
          RowBox[{"-", "6"}]}], "*", "cie1964uBar", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"c2", "/", 
           RowBox[{"(", 
            RowBox[{"cie1931Length", "*", 
             RowBox[{"T", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"c2", "/", 
              RowBox[{"(", 
               RowBox[{"cie1931Length", "*", 
                RowBox[{"T", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "-", "1"}],
            ")"}], "^", 
          RowBox[{"-", "2"}]}]}], "]"}], "*", "dwave"}]}], ";", "      ", 
     RowBox[{"(*", 
      RowBox[{"%", " ", 
       RowBox[{"dU", "/", "dT"}]}], "*)"}], "\n", 
     RowBox[{"Vprime", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"c1", "*", "c2", "*", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", 
          RowBox[{"-", "2"}]}], "*", 
         RowBox[{"cie1931Length", "^", 
          RowBox[{"-", "6"}]}], "*", "cie1964vBar", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"c2", "/", 
           RowBox[{"(", 
            RowBox[{"cie1931Length", "*", 
             RowBox[{"T", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"c2", "/", 
              RowBox[{"(", 
               RowBox[{"cie1931Length", "*", 
                RowBox[{"T", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "-", "1"}],
            ")"}], "^", 
          RowBox[{"-", "2"}]}]}], "]"}], "*", "dwave"}]}], ";", "           ", 
     RowBox[{"(*", 
      RowBox[{"%", " ", 
       RowBox[{"dV", "/", "dT"}]}], "*)"}], "\n", 
     RowBox[{"Wprime", "=", 
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"c1", "*", "c2", "*", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", 
          RowBox[{"-", "2"}]}], "*", 
         RowBox[{"cie1931Length", "^", 
          RowBox[{"-", "6"}]}], "*", "cie1964wBar", "*", 
         RowBox[{"Exp", "[", 
          RowBox[{"c2", "/", 
           RowBox[{"(", 
            RowBox[{"cie1931Length", "*", 
             RowBox[{"T", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"c2", "/", 
              RowBox[{"(", 
               RowBox[{"cie1931Length", "*", 
                RowBox[{"T", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "-", "1"}],
            ")"}], "^", 
          RowBox[{"-", "2"}]}]}], "]"}], "*", "dwave"}]}], ";", "           ", 
     RowBox[{"(*", 
      RowBox[{"%", " ", 
       RowBox[{"dW", "/", "dT"}]}], "*)"}], "\n", 
     RowBox[{"Rprime", "=", 
      RowBox[{"Uprime", "+", "Vprime", "+", "Wprime"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"sl", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Vprime", "*", "R"}], "-", 
         RowBox[{"V", "*", "Rprime"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Uprime", "*", "R"}], "-", 
         RowBox[{"U", "*", "Rprime"}]}], ")"}]}]}], ";", 
     "                               ", 
     RowBox[{"(*", 
      RowBox[{
      "%", "\:666e\:6717\:514b\:8f68\:8ff9\:7ebf\:4e0a\:5782\:8db3\:5904\:7684\
\:5207\:7ebf\:659c\:7387"}], "*)"}], "\n", 
     RowBox[{
      RowBox[{"m", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"-", "1"}], "/", 
       RowBox[{"sl", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}]}], 
   "                                                                          \
                                                ", 
   RowBox[{"(*", " ", 
    RowBox[{"%", "\:7b49\:6e29\:7ebf\:659c\:7387"}], "*)"}], "\n", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ut", "=", "u"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vt", "=", "v"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"tt", "=", "m"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"isoTempLinesTable", "=", 
   RowBox[{"Transpose", "@@", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"T", ",", "u", ",", "v", ",", "m"}], "}"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6549888416300707`*^9, 3.6549888775059023`*^9}, {
   3.654988961272445*^9, 3.654989040882818*^9}, {3.654989128155348*^9, 
   3.6549893817666516`*^9}, {3.6549895636558104`*^9, 3.654989564249591*^9}, {
   3.654989731413975*^9, 3.6549897522246103`*^9}, {3.654989807071609*^9, 
   3.6549898111014504`*^9}, {3.654989852958127*^9, 3.6549898751692734`*^9}, 
   3.654991234867243*^9, {3.6549912765495167`*^9, 3.654991290488451*^9}, {
   3.6549915276466684`*^9, 3.654991623582254*^9}, {3.6550052761999764`*^9, 
   3.6550052912944417`*^9}, {3.6550053254236374`*^9, 
   3.6550053914006014`*^9}, {3.655007611723417*^9, 3.6550076446607513`*^9}, {
   3.655007879014489*^9, 3.655008026111041*^9}, {3.6550092789199576`*^9, 
   3.6550093379897733`*^9}, {3.6550093703642406`*^9, 
   3.6550093948149443`*^9}, {3.6550101446029463`*^9, 
   3.6550101531631727`*^9}, {3.6550102015107064`*^9, 
   3.6550102048767786`*^9}, {3.655010235844157*^9, 3.655010249504058*^9}, 
   3.6550105130251265`*^9, 3.655010646012504*^9, {3.6550696119908376`*^9, 
   3.6550696758015394`*^9}, {3.6550697093808384`*^9, 3.655069849612464*^9}, {
   3.655070043649847*^9, 3.6550700590850844`*^9}, {3.6550701069931154`*^9, 
   3.6550701425526924`*^9}, {3.6550736227761087`*^9, 
   3.6550736286990366`*^9}, {3.6550746701646705`*^9, 
   3.6550747304962544`*^9}, {3.6550747805260153`*^9, 
   3.6550747877417994`*^9}, {3.6550748183631053`*^9, 3.655074854911905*^9}, {
   3.6550755084735255`*^9, 3.6550755167870393`*^9}, {3.655075709275633*^9, 
   3.6550757244236784`*^9}, {3.655075936334709*^9, 3.655075977392934*^9}, {
   3.655076956171324*^9, 3.6550769826248627`*^9}, 3.6550770240223317`*^9, {
   3.655110752104637*^9, 3.655110874107111*^9}, {3.6551109086578712`*^9, 
   3.6551109279066324`*^9}, {3.6551109667097545`*^9, 3.655110983504891*^9}, {
   3.6551111276945534`*^9, 3.655111157571493*^9}, {3.655111241963822*^9, 
   3.655111262025138*^9}, {3.655111305138732*^9, 3.655111391904213*^9}, {
   3.6551114409030976`*^9, 3.6551114622432504`*^9}, {3.655111525790538*^9, 
   3.655111570785739*^9}, {3.6551127234911723`*^9, 3.655112745959072*^9}, {
   3.655112780121277*^9, 3.6551128404133296`*^9}, {3.655112911377078*^9, 
   3.6551129377225475`*^9}, {3.655113037552865*^9, 3.655113061050415*^9}, {
   3.655113158495561*^9, 3.6551132973685474`*^9}, {3.6551135410969534`*^9, 
   3.655113636430129*^9}, {3.655113689390766*^9, 3.6551138189927406`*^9}, {
   3.655114136413211*^9, 3.6551142267221346`*^9}, {3.6551142613946447`*^9, 
   3.6551144149984074`*^9}, {3.6551144499711065`*^9, 
   3.6551144879923205`*^9}, {3.6551146284801245`*^9, 3.655114661902285*^9}, {
   3.6551146927632647`*^9, 3.6551147707415204`*^9}, {3.655114838118211*^9, 
   3.655114884218313*^9}, 3.655114920688599*^9, {3.6551149864333515`*^9, 
   3.655115100137415*^9}, {3.6551151789181757`*^9, 3.6551152432056646`*^9}, {
   3.655115292269219*^9, 3.6551153070630283`*^9}, {3.6551154492260785`*^9, 
   3.6551154964958982`*^9}, 3.655115694259676*^9, {3.655116829158615*^9, 
   3.655116844281044*^9}, {3.6551168782585764`*^9, 3.655116891106092*^9}, {
   3.655116924489261*^9, 3.6551169706964545`*^9}, {3.6554582655264482`*^9, 
   3.6554582681662025`*^9}, 3.6556970379997396`*^9, 3.6556975469926777`*^9, {
   3.655697668849616*^9, 3.65569767670082*^9}, 3.6557061249160647`*^9, 
   3.655713301348179*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"%", " ", "Calculate", " ", "Chromaticity", " ", "Coordinates"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xBarData", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], "//", 
      "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yBarData", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}], "//", 
      "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zBarData", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "4"}], "]"}], "]"}]}], "}"}], "//", 
      "Transpose"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xBarInterFunc", "=", 
     RowBox[{"Interpolation", "[", "xBarData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xBarInterFunc", "[", 
     RowBox[{"Range", "[", 
      RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yBarInterFunc", "=", 
     RowBox[{"Interpolation", "[", "yBarData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zBarInterFunc", "=", 
     RowBox[{"Interpolation", "[", "zBarData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Attributes", "[", "multiLedSpdModel", "]"}], "=", 
     RowBox[{"{", "Listable", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"multiLedSpdModel", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"460", ",", "640", ",", "5"}], "]"}], "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "9"}]}]}], ",", "0.6", ",", "0.2", ",", "0.6", ",", 
      "0.6", ",", "0.3"}], "]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lampX", "=", 
     RowBox[{
      RowBox[{"tmpLEDs", "*", 
       RowBox[{"xBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], "//",
       "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lampY", "=", 
     RowBox[{
      RowBox[{"tmpLEDs", "*", 
       RowBox[{"yBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], "//",
       "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lampZ", "=", 
     RowBox[{
      RowBox[{"tmpLEDs", "*", 
       RowBox[{"zBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], "//",
       "Total"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"xLamp", "=", 
    RowBox[{"lampX", "/", 
     RowBox[{"(", 
      RowBox[{"lampX", "+", "lampY", "+", "lampZ"}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"yLamp", "=", 
    RowBox[{"lampY", "/", 
     RowBox[{"(", 
      RowBox[{"lampX", "+", "lampY", "+", "lampZ"}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zLamp", "=", 
     RowBox[{"lampZ", "/", 
      RowBox[{"(", 
       RowBox[{"lampX", "+", "lampY", "+", "lampZ"}], ")"}]}]}], ";"}], "\n", 
   RowBox[{"uLamp", "=", 
    RowBox[{"4", "*", 
     RowBox[{"xLamp", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "*", "xLamp"}], "+", 
        RowBox[{"12", "*", "yLamp"}], "+", "3"}], ")"}]}]}]}], "\n", 
   RowBox[{"vLamp", "=", 
    RowBox[{"6", "*", 
     RowBox[{"yLamp", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], "*", "xLamp"}], "+", 
        RowBox[{"12", "*", "yLamp"}], "+", "3"}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6549888416300707`*^9, 3.6549888775059023`*^9}, {
   3.654988961272445*^9, 3.654989040882818*^9}, {3.654989128155348*^9, 
   3.6549893817666516`*^9}, {3.6549895636558104`*^9, 3.654989564249591*^9}, {
   3.654989731413975*^9, 3.6549897522246103`*^9}, {3.654989807071609*^9, 
   3.6549898111014504`*^9}, {3.654989852958127*^9, 3.6549898751692734`*^9}, 
   3.654991234867243*^9, {3.6549912765495167`*^9, 3.654991290488451*^9}, {
   3.6549915276466684`*^9, 3.654991623582254*^9}, {3.6550052761999764`*^9, 
   3.6550052912944417`*^9}, {3.6550053254236374`*^9, 
   3.6550053914006014`*^9}, {3.655007611723417*^9, 3.6550076446607513`*^9}, {
   3.655007879014489*^9, 3.655008026111041*^9}, {3.6550092789199576`*^9, 
   3.6550093379897733`*^9}, {3.6550093703642406`*^9, 
   3.6550093948149443`*^9}, {3.6550101446029463`*^9, 
   3.6550101531631727`*^9}, {3.6550102015107064`*^9, 
   3.6550102048767786`*^9}, {3.655010235844157*^9, 3.655010249504058*^9}, 
   3.6550105130251265`*^9, 3.655010646012504*^9, {3.6550696119908376`*^9, 
   3.6550696758015394`*^9}, {3.6550697093808384`*^9, 3.655069849612464*^9}, {
   3.655070043649847*^9, 3.6550700590850844`*^9}, {3.6550701069931154`*^9, 
   3.6550701425526924`*^9}, {3.6550736227761087`*^9, 
   3.6550736286990366`*^9}, {3.6550746701646705`*^9, 
   3.6550747304962544`*^9}, {3.6550747805260153`*^9, 
   3.6550747877417994`*^9}, {3.6550748183631053`*^9, 3.655074854911905*^9}, {
   3.6550755084735255`*^9, 3.6550755167870393`*^9}, {3.655075709275633*^9, 
   3.6550757244236784`*^9}, {3.655075936334709*^9, 3.655075977392934*^9}, {
   3.655076956171324*^9, 3.6550769826248627`*^9}, 3.6550770240223317`*^9, {
   3.655110752104637*^9, 3.655110874107111*^9}, {3.6551109086578712`*^9, 
   3.6551109279066324`*^9}, {3.6551109667097545`*^9, 3.655110983504891*^9}, {
   3.6551111276945534`*^9, 3.655111157571493*^9}, {3.655111241963822*^9, 
   3.655111262025138*^9}, {3.655111305138732*^9, 3.655111391904213*^9}, {
   3.6551114409030976`*^9, 3.6551114622432504`*^9}, {3.655111525790538*^9, 
   3.655111570785739*^9}, {3.6551127234911723`*^9, 3.655112745959072*^9}, {
   3.655112780121277*^9, 3.6551128404133296`*^9}, {3.655112911377078*^9, 
   3.6551129377225475`*^9}, {3.655113037552865*^9, 3.655113061050415*^9}, {
   3.655113158495561*^9, 3.6551132973685474`*^9}, {3.6551135410969534`*^9, 
   3.655113636430129*^9}, {3.655113689390766*^9, 3.6551138189927406`*^9}, {
   3.655114136413211*^9, 3.6551142267221346`*^9}, {3.6551142613946447`*^9, 
   3.6551144149984074`*^9}, {3.6551144499711065`*^9, 
   3.6551144879923205`*^9}, {3.6551146284801245`*^9, 3.655114661902285*^9}, {
   3.6551146927632647`*^9, 3.6551147707415204`*^9}, {3.655114838118211*^9, 
   3.655114884218313*^9}, 3.655114920688599*^9, {3.6551149864333515`*^9, 
   3.655115100137415*^9}, {3.655115145510502*^9, 3.655115146300028*^9}, {
   3.6551178837410383`*^9, 3.655117888438153*^9}, 3.6551181875352445`*^9, {
   3.6551192343437815`*^9, 3.6551192445730762`*^9}, {3.6551193686310005`*^9, 
   3.6551193769625235`*^9}, {3.6551194105728116`*^9, 
   3.6551194330986385`*^9}, {3.655119502113424*^9, 3.6551195126313963`*^9}, {
   3.655119617899086*^9, 3.65511973125749*^9}, {3.655182337731392*^9, 
   3.655182394918091*^9}, {3.6551824689782767`*^9, 3.6551824796343517`*^9}, {
   3.6551825304290967`*^9, 3.6551825487774715`*^9}, {3.655182741224361*^9, 
   3.655182768266316*^9}, {3.6551837069084306`*^9, 3.6551837265844913`*^9}, 
   3.655700048143815*^9, {3.6557022413079834`*^9, 3.6557022421095147`*^9}, {
   3.6557133883238754`*^9, 3.655713392528661*^9}, {3.6557911852458363`*^9, 
   3.6557911873882627`*^9}, {3.6557912508738594`*^9, 
   3.6557912743073974`*^9}, {3.6557913208737383`*^9, 3.655791351816258*^9}, {
   3.6557913887292223`*^9, 3.655791396103112*^9}, {3.6557914307147875`*^9, 
   3.6557914383798714`*^9}, {3.6557915077814913`*^9, 3.6557915959237585`*^9}, 
   3.655791662811006*^9, {3.6557917707295637`*^9, 3.6557917804295115`*^9}, {
   3.6557919667548323`*^9, 3.655791971259819*^9}, {3.6557923119035788`*^9, 
   3.655792324027137*^9}, {3.656019120878503*^9, 3.656019123071971*^9}, {
   3.656025872045538*^9, 3.6560258851312213`*^9}, {3.6560286604741807`*^9, 
   3.656028665640607*^9}, {3.6560287226873116`*^9, 3.6560287238150597`*^9}}],

Cell[BoxData[
 RowBox[{"{", "0.45351913472046174`", "}"}]], "Output",
 CellChangeTimes->{
  3.6551825508288307`*^9, 3.655182770156565*^9, 3.6551834727557945`*^9, 
   3.655183732537444*^9, 3.65518820123456*^9, 3.6554581765695033`*^9, 
   3.6556966015668507`*^9, 3.6557022433943663`*^9, 3.655705506912485*^9, {
   3.6557085251676884`*^9, 3.655708536944499*^9}, 3.655713069584141*^9, 
   3.655713314694028*^9, 3.655713445093047*^9, 3.6557135087453375`*^9, 
   3.655722110053555*^9, 3.655722323056847*^9, 3.655722539592946*^9, 
   3.6557233149136095`*^9, 3.6557829056376653`*^9, 3.6557911894196043`*^9, 
   3.655791354946333*^9, 3.655791397572085*^9, 3.6557916166790333`*^9, 
   3.6557917837367053`*^9, 3.6557919765853505`*^9, 3.6557923273333282`*^9, 
   3.6557923869204597`*^9, 3.655794873707163*^9, 3.6560176301761384`*^9, 
   3.6560229015954247`*^9, 3.6560258953540025`*^9, 3.656026135209874*^9, 
   3.656026201654431*^9, 3.6560262567387075`*^9, 3.65602635052951*^9, 
   3.6560401904772396`*^9, 3.656040229340027*^9}],

Cell[BoxData[
 RowBox[{"{", "0.4548973116338037`", "}"}]], "Output",
 CellChangeTimes->{
  3.6551825508288307`*^9, 3.655182770156565*^9, 3.6551834727557945`*^9, 
   3.655183732537444*^9, 3.65518820123456*^9, 3.6554581765695033`*^9, 
   3.6556966015668507`*^9, 3.6557022433943663`*^9, 3.655705506912485*^9, {
   3.6557085251676884`*^9, 3.655708536944499*^9}, 3.655713069584141*^9, 
   3.655713314694028*^9, 3.655713445093047*^9, 3.6557135087453375`*^9, 
   3.655722110053555*^9, 3.655722323056847*^9, 3.655722539592946*^9, 
   3.6557233149136095`*^9, 3.6557829056376653`*^9, 3.6557911894196043`*^9, 
   3.655791354946333*^9, 3.655791397572085*^9, 3.6557916166790333`*^9, 
   3.6557917837367053`*^9, 3.6557919765853505`*^9, 3.6557923273333282`*^9, 
   3.6557923869204597`*^9, 3.655794873707163*^9, 3.6560176301761384`*^9, 
   3.6560229015954247`*^9, 3.6560258953540025`*^9, 3.656026135209874*^9, 
   3.656026201654431*^9, 3.6560262567387075`*^9, 3.65602635052951*^9, 
   3.6560401904772396`*^9, 3.6560402293420277`*^9}],

Cell[BoxData[
 RowBox[{"{", "0.24022001132970644`", "}"}]], "Output",
 CellChangeTimes->{
  3.6551825508288307`*^9, 3.655182770156565*^9, 3.6551834727557945`*^9, 
   3.655183732537444*^9, 3.65518820123456*^9, 3.6554581765695033`*^9, 
   3.6556966015668507`*^9, 3.6557022433943663`*^9, 3.655705506912485*^9, {
   3.6557085251676884`*^9, 3.655708536944499*^9}, 3.655713069584141*^9, 
   3.655713314694028*^9, 3.655713445093047*^9, 3.6557135087453375`*^9, 
   3.655722110053555*^9, 3.655722323056847*^9, 3.655722539592946*^9, 
   3.6557233149136095`*^9, 3.6557829056376653`*^9, 3.6557911894196043`*^9, 
   3.655791354946333*^9, 3.655791397572085*^9, 3.6557916166790333`*^9, 
   3.6557917837367053`*^9, 3.6557919765853505`*^9, 3.6557923273333282`*^9, 
   3.6557923869204597`*^9, 3.655794873707163*^9, 3.6560176301761384`*^9, 
   3.6560229015954247`*^9, 3.6560258953540025`*^9, 3.656026135209874*^9, 
   3.656026201654431*^9, 3.6560262567387075`*^9, 3.65602635052951*^9, 
   3.6560401904772396`*^9, 3.656040229343028*^9}],

Cell[BoxData[
 RowBox[{"{", "0.36142500609774736`", "}"}]], "Output",
 CellChangeTimes->{
  3.6551825508288307`*^9, 3.655182770156565*^9, 3.6551834727557945`*^9, 
   3.655183732537444*^9, 3.65518820123456*^9, 3.6554581765695033`*^9, 
   3.6556966015668507`*^9, 3.6557022433943663`*^9, 3.655705506912485*^9, {
   3.6557085251676884`*^9, 3.655708536944499*^9}, 3.655713069584141*^9, 
   3.655713314694028*^9, 3.655713445093047*^9, 3.6557135087453375`*^9, 
   3.655722110053555*^9, 3.655722323056847*^9, 3.655722539592946*^9, 
   3.6557233149136095`*^9, 3.6557829056376653`*^9, 3.6557911894196043`*^9, 
   3.655791354946333*^9, 3.655791397572085*^9, 3.6557916166790333`*^9, 
   3.6557917837367053`*^9, 3.6557919765853505`*^9, 3.6557923273333282`*^9, 
   3.6557923869204597`*^9, 3.655794873707163*^9, 3.6560176301761384`*^9, 
   3.6560229015954247`*^9, 3.6560258953540025`*^9, 3.656026135209874*^9, 
   3.656026201654431*^9, 3.6560262567387075`*^9, 3.65602635052951*^9, 
   3.6560401904772396`*^9, 3.6560402293440294`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"%", " ", "Find", " ", "adjacent", " ", "lines", " ", "to", " ", 
    RowBox[{"(", 
     RowBox[{"us", ",", "vs"}], ")"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", 
     RowBox[{"Length", " ", "[", "T", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"index", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"d1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vLamp", "-", 
          RowBox[{"vt", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
        RowBox[{
         RowBox[{"tt", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"uLamp", "-", 
           RowBox[{"ut", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"tt", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"tt", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"d1", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "2"}], ",", 
     RowBox[{"i", "\[LessEqual]", "n"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vLamp", "-", 
            RowBox[{"vt", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "-", 
          RowBox[{
           RowBox[{"tt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"uLamp", "-", 
             RowBox[{"ut", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"tt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"tt", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"d1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "/", 
          RowBox[{"d2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "<", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"index", "=", "i"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "}"}], ",", 
        RowBox[{"index", "=", "111"}], ",", 
        RowBox[{"index", "=", 
         RowBox[{"-", "1"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"d1", "=", "d2"}], "*)"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Tc", "=", 
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"T", "[", 
         RowBox[{"[", 
          RowBox[{"index", "-", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"d1", "/", 
         RowBox[{"(", 
          RowBox[{"d1", "-", "d2"}], ")"}]}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1", "/", 
           RowBox[{"T", "[", 
            RowBox[{"[", "index", "]"}], "]"}]}], "-", 
          RowBox[{"1", "/", 
           RowBox[{"T", "[", 
            RowBox[{"[", 
             RowBox[{"index", "-", "1"}], "]"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6549888416300707`*^9, 3.6549888775059023`*^9}, {
   3.654988961272445*^9, 3.654989040882818*^9}, {3.654989128155348*^9, 
   3.6549893817666516`*^9}, {3.6549895636558104`*^9, 3.654989564249591*^9}, {
   3.654989731413975*^9, 3.6549897522246103`*^9}, {3.654989807071609*^9, 
   3.6549898111014504`*^9}, {3.654989852958127*^9, 3.6549898751692734`*^9}, 
   3.654991234867243*^9, {3.6549912765495167`*^9, 3.654991290488451*^9}, {
   3.6549915276466684`*^9, 3.654991623582254*^9}, {3.6550052761999764`*^9, 
   3.6550052912944417`*^9}, {3.6550053254236374`*^9, 
   3.6550053914006014`*^9}, {3.655007611723417*^9, 3.6550076446607513`*^9}, {
   3.655007879014489*^9, 3.655008026111041*^9}, {3.6550092789199576`*^9, 
   3.6550093379897733`*^9}, {3.6550093703642406`*^9, 
   3.6550093948149443`*^9}, {3.6550101446029463`*^9, 
   3.6550101531631727`*^9}, {3.6550102015107064`*^9, 
   3.6550102048767786`*^9}, {3.655010235844157*^9, 3.655010249504058*^9}, 
   3.6550105130251265`*^9, 3.655010646012504*^9, {3.6550696119908376`*^9, 
   3.6550696758015394`*^9}, {3.6550697093808384`*^9, 3.655069849612464*^9}, {
   3.655070043649847*^9, 3.6550700590850844`*^9}, {3.6550701069931154`*^9, 
   3.6550701425526924`*^9}, {3.6550736227761087`*^9, 
   3.6550736286990366`*^9}, {3.6550746701646705`*^9, 
   3.6550747304962544`*^9}, {3.6550747805260153`*^9, 
   3.6550747877417994`*^9}, {3.6550748183631053`*^9, 3.655074854911905*^9}, {
   3.6550755084735255`*^9, 3.6550755167870393`*^9}, {3.655075709275633*^9, 
   3.6550757244236784`*^9}, {3.655075936334709*^9, 3.655075977392934*^9}, {
   3.655076956171324*^9, 3.6550769826248627`*^9}, 3.6550770240223317`*^9, {
   3.655110752104637*^9, 3.655110874107111*^9}, {3.6551109086578712`*^9, 
   3.6551109279066324`*^9}, {3.6551109667097545`*^9, 3.655110983504891*^9}, {
   3.6551111276945534`*^9, 3.655111157571493*^9}, {3.655111241963822*^9, 
   3.655111262025138*^9}, {3.655111305138732*^9, 3.655111391904213*^9}, {
   3.6551114409030976`*^9, 3.6551114622432504`*^9}, {3.655111525790538*^9, 
   3.655111570785739*^9}, {3.6551127234911723`*^9, 3.655112745959072*^9}, {
   3.655112780121277*^9, 3.6551128404133296`*^9}, {3.655112911377078*^9, 
   3.6551129377225475`*^9}, {3.655113037552865*^9, 3.655113061050415*^9}, {
   3.655113158495561*^9, 3.6551132973685474`*^9}, {3.6551135410969534`*^9, 
   3.655113636430129*^9}, {3.655113689390766*^9, 3.6551138189927406`*^9}, {
   3.655114136413211*^9, 3.6551142267221346`*^9}, {3.6551142613946447`*^9, 
   3.6551144149984074`*^9}, {3.6551144499711065`*^9, 
   3.6551144879923205`*^9}, {3.6551146284801245`*^9, 3.655114661902285*^9}, {
   3.6551146927632647`*^9, 3.6551147707415204`*^9}, {3.655114838118211*^9, 
   3.655114884218313*^9}, 3.655114920688599*^9, {3.6551149864333515`*^9, 
   3.655115100137415*^9}, {3.6551179005581903`*^9, 3.6551179423084*^9}, {
   3.655118003831555*^9, 3.6551180455030017`*^9}, {3.6551181412601514`*^9, 
   3.6551181505843363`*^9}, {3.655118198802719*^9, 3.6551182890225754`*^9}, {
   3.6551183621748977`*^9, 3.6551183861708097`*^9}, {3.6551184221652412`*^9, 
   3.655118439217553*^9}, {3.6551185922089753`*^9, 3.6551185950308523`*^9}, {
   3.6551186337935514`*^9, 3.6551186828060675`*^9}, {3.655118741621581*^9, 
   3.655118744668599*^9}, {3.655118805467428*^9, 3.6551188390192327`*^9}, 
   3.6551188747289143`*^9, {3.6551198092367115`*^9, 3.6551199950905075`*^9}, {
   3.6551788522972183`*^9, 3.655178867807515*^9}, {3.6551789087072387`*^9, 
   3.6551789259446807`*^9}, {3.6551790748241463`*^9, 3.6551791202573395`*^9}, 
   3.6551792604134283`*^9, {3.6551792975720987`*^9, 3.655179377829918*^9}, {
   3.655179471672756*^9, 3.655179559688686*^9}, {3.6551797615839376`*^9, 
   3.6551797884038916`*^9}, {3.6551798590479*^9, 3.655179919479224*^9}, {
   3.6551799680635257`*^9, 3.655180000459033*^9}, 3.65518006623072*^9, 
   3.65518011677932*^9, {3.655180164331423*^9, 3.655180185998808*^9}, {
   3.655180217061008*^9, 3.655180272572878*^9}, {3.65518048612774*^9, 
   3.655180497355197*^9}, {3.655180530991543*^9, 3.655180542919464*^9}, 
   3.6551806043903017`*^9, {3.6551807179717646`*^9, 3.6551807413819127`*^9}, {
   3.6551818754936476`*^9, 3.6551819121819296`*^9}, {3.6551819433387146`*^9, 
   3.6551819942565184`*^9}, {3.655182030591158*^9, 3.6551821350303726`*^9}}],

Cell[BoxData[
 RowBox[{"{", "3115.2662544124555`", "}"}]], "Output",
 CellChangeTimes->{
  3.655179455461993*^9, {3.655179488637499*^9, 3.655179512871581*^9}, {
   3.655179543819151*^9, 3.6551795619551907`*^9}, 3.6551797925966787`*^9, {
   3.6551798866192036`*^9, 3.6551799212063756`*^9}, {3.655179973688259*^9, 
   3.6551800234683285`*^9}, 3.655180072160653*^9, 3.655180118350361*^9, {
   3.6551801734304667`*^9, 3.6551801864511075`*^9}, 3.655180217527315*^9, {
   3.6551802577059913`*^9, 3.6551802766185646`*^9}, 3.6551804912861643`*^9, {
   3.655180534409814*^9, 3.655180544449477*^9}, 3.6551806102952204`*^9, 
   3.6551807478331976`*^9, 3.6551818479833794`*^9, 3.655181901307708*^9, {
   3.6551819755020666`*^9, 3.655181995037034*^9}, {3.655182033965395*^9, 
   3.6551821369246287`*^9}, 3.6551824068900404`*^9, 3.6551824851380277`*^9, {
   3.655182540979294*^9, 3.6551825527821283`*^9}, 3.655182772592183*^9, 
   3.6551834728228393`*^9, 3.655183732562461*^9, 3.6551882012565746`*^9, 
   3.6554581765935183`*^9, 3.6556966015908666`*^9, 3.655705506945508*^9, {
   3.6557085251947064`*^9, 3.6557085370265536`*^9}, 3.65571306966019*^9, 
   3.6557133189728694`*^9, 3.6557134451730995`*^9, 3.65571350882139*^9, 
   3.655715233279967*^9, 3.655722110079573*^9, 3.655722323086867*^9, 
   3.655722596951029*^9, 3.655723314952636*^9, 3.655782918192991*^9, 
   3.6557923869534845`*^9, 3.6557948737371836`*^9, 3.6560176302031546`*^9, 
   3.6560229016204424`*^9, 3.656025895380018*^9, 3.6560261352378902`*^9, 
   3.6560262016824536`*^9, 3.6560262567667274`*^9, 3.65602635055853*^9, 
   3.6560402293700523`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"%", " ", "Third"}], ",", 
    RowBox[{
    "calculate", " ", "the", " ", "Color", " ", "Rendering", " ", "Indices", 
     " ", 
     RowBox[{"(", 
      RowBox[{"CRI", " ", "and", " ", "its", " ", "14", " ", "indices"}], 
      ")"}]}], ",", 
    RowBox[{"Calculate", " ", "Reference", " ", "Source", " ", "Spectrum"}], 
    ",", 
    RowBox[{"spdref", "."}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "=", 
     RowBox[{"3.7418", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "16"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"c2", "=", 
     RowBox[{"1.4388", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tc", "=", 
     RowBox[{"{", "2856.3", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"spdLength", "=", 
     RowBox[{"Range", "[", 
      RowBox[{"460", ",", "640", ",", "5"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"spdref", "=", 
     RowBox[{"c1", "*", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"10", "^", 
           RowBox[{"-", "9"}]}], "*", "spdLength"}], ")"}], "^", 
        RowBox[{"-", "5"}]}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"c2", "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tc", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"10", "^", 
                RowBox[{"-", "9"}]}], "*", "spdLength"}], ")"}]}], ")"}]}], 
          "]"}], "-", "1"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6551853709048605`*^9, 3.6551854054768167`*^9}, {
   3.6551860147791166`*^9, 3.6551860277842665`*^9}, {3.6551861051046195`*^9, 
   3.655186176605375*^9}, {3.655186833467799*^9, 3.6551868541855574`*^9}, {
   3.6551869176881666`*^9, 3.655186923376522*^9}, 3.6551876201812267`*^9, 
   3.655188188740264*^9, 3.655188323605739*^9, {3.655188355228732*^9, 
   3.6551884533440275`*^9}, 3.6554581636689405`*^9, 3.65570306187988*^9, 
   3.65571300673682*^9, {3.6557143514127936`*^9, 3.6557143533981094`*^9}, {
   3.6557147580022783`*^9, 3.6557147982669764`*^9}, {3.655715058771611*^9, 
   3.6557150767975664`*^9}, {3.6557151259216785`*^9, 3.655715132314917*^9}, {
   3.6557151623153667`*^9, 3.6557151829400425`*^9}, {3.655715495978142*^9, 
   3.6557155406257353`*^9}, {3.6557158121909013`*^9, 3.6557158505441713`*^9}, 
   3.655715881183024*^9, {3.6557159609823494`*^9, 3.6557160563821197`*^9}, {
   3.655716185861494*^9, 3.6557161987620497`*^9}, {3.6557226417006845`*^9, 
   3.655722646936161*^9}, 3.6560286688967695`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TCS", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "360", ",", "116", ",", "53", ",", "58", ",", "57", ",", "143", ",", 
        "79", ",", "150", ",", "75", ",", "69", ",", "42", ",", "74", ",", 
        "189", ",", "71", ",", "36"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "365", ",", "136", ",", "55", ",", "59", ",", "59", ",", "187", ",", 
        "81", ",", "177", ",", "78", ",", "72", ",", "43", ",", "79", ",", 
        "175", ",", "76", ",", "36"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "370", ",", "159", ",", "59", ",", "61", ",", "62", ",", "233", ",", 
        "89", ",", "218", ",", "84", ",", "73", ",", "45", ",", "86", ",", 
        "158", ",", "82", ",", "36"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "375", ",", "190", ",", "64", ",", "63", ",", "67", ",", "269", ",", 
        "113", ",", "293", ",", "90", ",", "70", ",", "47", ",", "98", ",", 
        "139", ",", "90", ",", "36"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "380", ",", "219", ",", "70", ",", "65", ",", "74", ",", "295", ",", 
        "151", ",", "378", ",", "104", ",", "66", ",", "50", ",", "111", ",", 
        "120", ",", "104", ",", "36"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "385", ",", "239", ",", "79", ",", "68", ",", "83", ",", "306", ",", 
        "203", ",", "459", ",", "129", ",", "62", ",", "54", ",", "121", ",", 
        "103", ",", "127", ",", "36"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "390", ",", "252", ",", "89", ",", "70", ",", "93", ",", "310", ",", 
        "265", ",", "524", ",", "170", ",", "58", ",", "59", ",", "127", ",", 
        "90", ",", "161", ",", "37"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "395", ",", "256", ",", "101", ",", "72", ",", "105", ",", "312", ",", 
        "339", ",", "546", ",", "240", ",", "55", ",", "63", ",", "129", ",", 
        "82", ",", "211", ",", "38"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "400", ",", "256", ",", "111", ",", "73", ",", "116", ",", "313", ",", 
        "410", ",", "551", ",", "319", ",", "52", ",", "66", ",", "127", ",", 
        "76", ",", "264", ",", "39"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "405", ",", "254", ",", "116", ",", "73", ",", "121", ",", "315", ",", 
        "464", ",", "555", ",", "416", ",", "52", ",", "67", ",", "121", ",", 
        "68", ",", "313", ",", "39"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "410", ",", "252", ",", "118", ",", "74", ",", "124", ",", "319", ",", 
        "492", ",", "559", ",", "462", ",", "51", ",", "68", ",", "116", ",", 
        "64", ",", "341", ",", "40"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "415", ",", "248", ",", "120", ",", "74", ",", "126", ",", "322", ",", 
        "508", ",", "560", ",", "482", ",", "50", ",", "69", ",", "112", ",", 
        "65", ",", "352", ",", "41"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "420", ",", "244", ",", "121", ",", "74", ",", "128", ",", "326", ",", 
        "517", ",", "561", ",", "490", ",", "50", ",", "69", ",", "108", ",", 
        "75", ",", "359", ",", "42"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "425", ",", "240", ",", "122", ",", "73", ",", "131", ",", "330", ",", 
        "524", ",", "558", ",", "488", ",", "49", ",", "70", ",", "105", ",", 
        "93", ",", "361", ",", "42"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "430", ",", "237", ",", "122", ",", "73", ",", "135", ",", "334", ",", 
        "531", ",", "556", ",", "482", ",", "48", ",", "72", ",", "104", ",", 
        "123", ",", "364", ",", "43"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "435", ",", "232", ",", "122", ",", "73", ",", "139", ",", "339", ",", 
        "538", ",", "551", ",", "473", ",", "47", ",", "73", ",", "104", ",", 
        "160", ",", "365", ",", "44"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "440", ",", "230", ",", "123", ",", "73", ",", "144", ",", "346", ",", 
        "544", ",", "544", ",", "462", ",", "46", ",", "76", ",", "105", ",", 
        "207", ",", "367", ",", "44"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "445", ",", "226", ",", "124", ",", "73", ",", "151", ",", "352", ",", 
        "551", ",", "535", ",", "450", ",", "44", ",", "78", ",", "106", ",", 
        "256", ",", "369", ",", "45"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "450", ",", "225", ",", "127", ",", "74", ",", "161", ",", "360", ",", 
        "556", ",", "522", ",", "439", ",", "42", ",", "83", ",", "110", ",", 
        "300", ",", "372", ",", "45"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "455", ",", "222", ",", "128", ",", "75", ",", "172", ",", "369", ",", 
        "556", ",", "506", ",", "426", ",", "41", ",", "88", ",", "115", ",", 
        "331", ",", "374", ",", "46"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "460", ",", "220", ",", "131", ",", "77", ",", "186", ",", "381", ",", 
        "554", ",", "488", ",", "413", ",", "38", ",", "95", ",", "123", ",", 
        "346", ",", "376", ",", "47"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "465", ",", "218", ",", "134", ",", "80", ",", "205", ",", "394", ",", 
        "549", ",", "469", ",", "397", ",", "35", ",", "103", ",", "134", ",",
         "347", ",", "379", ",", "48"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "470", ",", "216", ",", "138", ",", "85", ",", "229", ",", "403", ",", 
        "541", ",", "448", ",", "382", ",", "33", ",", "113", ",", "148", ",",
         "341", ",", "384", ",", "50"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "475", ",", "214", ",", "143", ",", "94", ",", "254", ",", "410", ",", 
        "531", ",", "429", ",", "366", ",", "31", ",", "125", ",", "167", ",",
         "328", ",", "389", ",", "52"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "480", ",", "214", ",", "150", ",", "109", ",", "281", ",", "415", ",",
         "519", ",", "408", ",", "352", ",", "30", ",", "142", ",", "192", 
        ",", "307", ",", "397", ",", "55"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "485", ",", "214", ",", "159", ",", "126", ",", "308", ",", "418", ",",
         "504", ",", "385", ",", "337", ",", "29", ",", "162", ",", "219", 
        ",", "282", ",", "405", ",", "57"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "490", ",", "216", ",", "174", ",", "148", ",", "332", ",", "419", ",",
         "488", ",", "363", ",", "325", ",", "28", ",", "189", ",", "252", 
        ",", "257", ",", "416", ",", "62"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "495", ",", "218", ",", "190", ",", "172", ",", "352", ",", "417", ",",
         "469", ",", "341", ",", "310", ",", "28", ",", "219", ",", "291", 
        ",", "230", ",", "429", ",", "67"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "500", ",", "223", ",", "207", ",", "198", ",", "370", ",", "413", ",",
         "450", ",", "324", ",", "299", ",", "28", ",", "262", ",", "325", 
        ",", "204", ",", "443", ",", "75"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "505", ",", "225", ",", "225", ",", "221", ",", "383", ",", "409", ",",
         "431", ",", "311", ",", "289", ",", "29", ",", "305", ",", "347", 
        ",", "178", ",", "454", ",", "83"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "510", ",", "226", ",", "242", ",", "241", ",", "390", ",", "403", ",",
         "414", ",", "301", ",", "283", ",", "30", ",", "365", ",", "356", 
        ",", "154", ",", "461", ",", "92"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "515", ",", "226", ",", "253", ",", "260", ",", "394", ",", "396", ",",
         "395", ",", "291", ",", "276", ",", "30", ",", "416", ",", "353", 
        ",", "129", ",", "466", ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "520", ",", "225", ",", "260", ",", "278", ",", "395", ",", "389", ",",
         "377", ",", "283", ",", "270", ",", "31", ",", "465", ",", "346", 
        ",", "109", ",", "469", ",", "108"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "525", ",", "225", ",", "264", ",", "302", ",", "392", ",", "381", ",",
         "358", ",", "273", ",", "262", ",", "31", ",", "509", ",", "333", 
        ",", "90", ",", "471", ",", "121"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "530", ",", "227", ",", "267", ",", "339", ",", "385", ",", "372", ",",
         "341", ",", "265", ",", "256", ",", "32", ",", "546", ",", "314", 
        ",", "75", ",", "474", ",", "133"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "535", ",", "230", ",", "269", ",", "370", ",", "377", ",", "363", ",",
         "325", ",", "260", ",", "251", ",", "32", ",", "581", ",", "294", 
        ",", "62", ",", "476", ",", "142"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "540", ",", "236", ",", "272", ",", "392", ",", "367", ",", "353", ",",
         "309", ",", "257", ",", "250", ",", "33", ",", "610", ",", "271", 
        ",", "51", ",", "483", ",", "150"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "545", ",", "245", ",", "276", ",", "399", ",", "354", ",", "342", ",",
         "293", ",", "257", ",", "251", ",", "34", ",", "634", ",", "248", 
        ",", "41", ",", "490", ",", "154"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "550", ",", "253", ",", "282", ",", "400", ",", "341", ",", "331", ",",
         "279", ",", "259", ",", "254", ",", "35", ",", "653", ",", "227", 
        ",", "35", ",", "506", ",", "155"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "555", ",", "262", ",", "289", ",", "393", ",", "327", ",", "320", ",",
         "265", ",", "260", ",", "258", ",", "37", ",", "666", ",", "206", 
        ",", "29", ",", "526", ",", "152"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "560", ",", "272", ",", "299", ",", "380", ",", "312", ",", "308", ",",
         "253", ",", "260", ",", "264", ",", "41", ",", "678", ",", "188", 
        ",", "25", ",", "553", ",", "147"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "565", ",", "283", ",", "309", ",", "365", ",", "296", ",", "296", ",",
         "241", ",", "258", ",", "269", ",", "44", ",", "687", ",", "170", 
        ",", "22", ",", "582", ",", "140"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "570", ",", "298", ",", "322", ",", "349", ",", "280", ",", "284", ",",
         "234", ",", "256", ",", "272", ",", "48", ",", "693", ",", "153", 
        ",", "19", ",", "618", ",", "133"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "575", ",", "318", ",", "329", ",", "332", ",", "263", ",", "271", ",",
         "227", ",", "254", ",", "274", ",", "52", ",", "698", ",", "138", 
        ",", "17", ",", "651", ",", "125"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "580", ",", "341", ",", "335", ",", "315", ",", "247", ",", "260", ",",
         "225", ",", "254", ",", "278", ",", "60", ",", "701", ",", "125", 
        ",", "17", ",", "680", ",", "118"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "585", ",", "367", ",", "339", ",", "299", ",", "229", ",", "247", ",",
         "222", ",", "259", ",", "284", ",", "76", ",", "704", ",", "114", 
        ",", "17", ",", "701", ",", "112"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "590", ",", "390", ",", "341", ",", "285", ",", "214", ",", "232", ",",
         "221", ",", "270", ",", "295", ",", "102", ",", "705", ",", "106", 
        ",", "16", ",", "717", ",", "106"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "595", ",", "409", ",", "341", ",", "272", ",", "198", ",", "220", ",",
         "220", ",", "284", ",", "316", ",", "136", ",", "705", ",", "100", 
        ",", "16", ",", "729", ",", "101"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "600", ",", "424", ",", "342", ",", "264", ",", "185", ",", "210", ",",
         "220", ",", "302", ",", "348", ",", "190", ",", "706", ",", "96", 
        ",", "16", ",", "736", ",", "98"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "605", ",", "435", ",", "342", ",", "257", ",", "175", ",", "200", ",",
         "220", ",", "324", ",", "384", ",", "256", ",", "707", ",", "92", 
        ",", "16", ",", "742", ",", "95"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "610", ",", "442", ",", "342", ",", "252", ",", "169", ",", "194", ",",
         "220", ",", "344", ",", "434", ",", "336", ",", "707", ",", "90", 
        ",", "16", ",", "745", ",", "93"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "615", ",", "448", ",", "341", ",", "247", ",", "164", ",", "189", ",",
         "220", ",", "362", ",", "482", ",", "418", ",", "707", ",", "87", 
        ",", "16", ",", "747", ",", "90"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "620", ",", "450", ",", "341", ",", "241", ",", "160", ",", "185", ",",
         "223", ",", "377", ",", "528", ",", "505", ",", "708", ",", "85", 
        ",", "16", ",", "748", ",", "89"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "625", ",", "451", ",", "339", ",", "235", ",", "156", ",", "183", ",",
         "227", ",", "389", ",", "568", ",", "581", ",", "708", ",", "82", 
        ",", "16", ",", "748", ",", "87"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "630", ",", "451", ",", "339", ",", "229", ",", "154", ",", "180", ",",
         "233", ",", "400", ",", "604", ",", "641", ",", "710", ",", "80", 
        ",", "18", ",", "748", ",", "86"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "635", ",", "451", ",", "338", ",", "224", ",", "152", ",", "177", ",",
         "239", ",", "410", ",", "629", ",", "682", ",", "711", ",", "79", 
        ",", "18", ",", "748", ",", "85"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "640", ",", "451", ",", "338", ",", "220", ",", "151", ",", "176", ",",
         "244", ",", "420", ",", "648", ",", "717", ",", "712", ",", "78", 
        ",", "18", ",", "748", ",", "84"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "645", ",", "451", ",", "337", ",", "217", ",", "149", ",", "175", ",",
         "251", ",", "429", ",", "663", ",", "740", ",", "714", ",", "78", 
        ",", "18", ",", "748", ",", "84"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "650", ",", "450", ",", "336", ",", "216", ",", "148", ",", "175", ",",
         "258", ",", "438", ",", "676", ",", "758", ",", "716", ",", "78", 
        ",", "19", ",", "748", ",", "84"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "655", ",", "450", ",", "335", ",", "216", ",", "148", ",", "175", ",",
         "263", ",", "445", ",", "685", ",", "770", ",", "718", ",", "78", 
        ",", "20", ",", "748", ",", "84"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "660", ",", "451", ",", "334", ",", "219", ",", "148", ",", "175", ",",
         "268", ",", "452", ",", "693", ",", "781", ",", "720", ",", "81", 
        ",", "23", ",", "747", ",", "85"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "665", ",", "451", ",", "332", ",", "224", ",", "149", ",", "177", ",",
         "273", ",", "457", ",", "700", ",", "790", ",", "722", ",", "83", 
        ",", "24", ",", "747", ",", "87"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "670", ",", "453", ",", "332", ",", "230", ",", "151", ",", "180", ",",
         "278", ",", "462", ",", "705", ",", "797", ",", "725", ",", "88", 
        ",", "26", ",", "747", ",", "92"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "675", ",", "454", ",", "331", ",", "238", ",", "154", ",", "183", ",",
         "281", ",", "466", ",", "709", ",", "803", ",", "729", ",", "93", 
        ",", "30", ",", "747", ",", "96"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "680", ",", "455", ",", "331", ",", "251", ",", "158", ",", "186", ",",
         "283", ",", "468", ",", "712", ",", "809", ",", "731", ",", "102", 
        ",", "35", ",", "747", ",", "102"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "685", ",", "457", ",", "330", ",", "269", ",", "162", ",", "189", ",",
         "286", ",", "470", ",", "715", ",", "814", ",", "735", ",", "112", 
        ",", "43", ",", "747", ",", "110"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "690", ",", "458", ",", "329", ",", "288", ",", "165", ",", "192", ",",
         "291", ",", "473", ",", "717", ",", "819", ",", "739", ",", "125", 
        ",", "56", ",", "747", ",", "123"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "695", ",", "460", ",", "328", ",", "312", ",", "168", ",", "195", ",",
         "296", ",", "477", ",", "719", ",", "824", ",", "742", ",", "141", 
        ",", "74", ",", "746", ",", "137"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "700", ",", "462", ",", "328", ",", "340", ",", "170", ",", "199", ",",
         "302", ",", "483", ",", "721", ",", "828", ",", "746", ",", "161", 
        ",", "97", ",", "746", ",", "152"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "705", ",", "463", ",", "327", ",", "366", ",", "171", ",", "200", ",",
         "313", ",", "489", ",", "720", ",", "830", ",", "748", ",", "182", 
        ",", "128", ",", "746", ",", "169"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "710", ",", "464", ",", "326", ",", "390", ",", "170", ",", "199", ",",
         "325", ",", "496", ",", "719", ",", "831", ",", "749", ",", "203", 
        ",", "166", ",", "745", ",", "188"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "715", ",", "465", ",", "325", ",", "412", ",", "168", ",", "198", ",",
         "338", ",", "503", ",", "722", ",", "833", ",", "751", ",", "223", 
        ",", "210", ",", "744", ",", "207"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "720", ",", "466", ",", "324", ",", "431", ",", "166", ",", "196", ",",
         "351", ",", "511", ",", "725", ",", "835", ",", "753", ",", "242", 
        ",", "257", ",", "743", ",", "226"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "725", ",", "466", ",", "324", ",", "447", ",", "164", ",", "195", ",",
         "364", ",", "518", ",", "727", ",", "836", ",", "754", ",", "257", 
        ",", "305", ",", "744", ",", "243"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "730", ",", "466", ",", "324", ",", "460", ",", "164", ",", "195", ",",
         "376", ",", "525", ",", "729", ",", "836", ",", "755", ",", "270", 
        ",", "354", ",", "745", ",", "260"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "735", ",", "466", ",", "323", ",", "472", ",", "165", ",", "196", ",",
         "389", ",", "532", ",", "730", ",", "837", ",", "755", ",", "282", 
        ",", "401", ",", "748", ",", "277"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "740", ",", "467", ",", "322", ",", "481", ",", "168", ",", "197", ",",
         "401", ",", "539", ",", "730", ",", "838", ",", "755", ",", "292", 
        ",", "446", ",", "750", ",", "294"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "745", ",", "467", ",", "321", ",", "488", ",", "172", ",", "200", ",",
         "413", ",", "546", ",", "730", ",", "839", ",", "755", ",", "302", 
        ",", "485", ",", "750", ",", "310"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "750", ",", "467", ",", "320", ",", "493", ",", "177", ",", "203", ",",
         "425", ",", "553", ",", "730", ",", "839", ",", "756", ",", "310", 
        ",", "520", ",", "749", ",", "325"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "755", ",", "467", ",", "318", ",", "497", ",", "181", ",", "205", ",",
         "436", ",", "559", ",", "730", ",", "839", ",", "757", ",", "314", 
        ",", "551", ",", "748", ",", "339"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "760", ",", "467", ",", "316", ",", "500", ",", "185", ",", "208", ",",
         "447", ",", "565", ",", "730", ",", "839", ",", "758", ",", "317", 
        ",", "577", ",", "748", ",", "353"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "765", ",", "467", ",", "315", ",", "502", ",", "189", ",", "212", ",",
         "458", ",", "570", ",", "730", ",", "839", ",", "759", ",", "323", 
        ",", "599", ",", "747", ",", "366"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "770", ",", "467", ",", "315", ",", "505", ",", "192", ",", "215", ",",
         "469", ",", "575", ",", "730", ",", "839", ",", "759", ",", "330", 
        ",", "618", ",", "747", ",", "379"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "775", ",", "467", ",", "314", ",", "510", ",", "194", ",", "217", ",",
         "477", ",", "578", ",", "730", ",", "839", ",", "759", ",", "334", 
        ",", "633", ",", "747", ",", "390"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "780", ",", "467", ",", "314", ",", "516", ",", "197", ",", "219", ",",
         "485", ",", "581", ",", "730", ",", "839", ",", "759", ",", "338", 
        ",", "645", ",", "747", ",", "399"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "785", ",", "467", ",", "313", ",", "520", ",", "200", ",", "222", ",",
         "493", ",", "583", ",", "730", ",", "839", ",", "759", ",", "343", 
        ",", "656", ",", "746", ",", "408"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "790", ",", "467", ",", "313", ",", "524", ",", "204", ",", "226", ",",
         "500", ",", "585", ",", "731", ",", "839", ",", "759", ",", "348", 
        ",", "666", ",", "746", ",", "416"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "795", ",", "466", ",", "312", ",", "527", ",", "210", ",", "231", ",",
         "506", ",", "587", ",", "731", ",", "839", ",", "759", ",", "353", 
        ",", "674", ",", "746", ",", "422"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "800", ",", "466", ",", "312", ",", "531", ",", "218", ",", "237", ",",
         "512", ",", "588", ",", "731", ",", "839", ",", "759", ",", "359", 
        ",", "680", ",", "746", ",", "428"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "805", ",", "466", ",", "311", ",", "535", ",", "225", ",", "243", ",",
         "517", ",", "589", ",", "731", ",", "839", ",", "759", ",", "365", 
        ",", "686", ",", "745", ",", "434"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "810", ",", "466", ",", "311", ",", "539", ",", "233", ",", "249", ",",
         "521", ",", "590", ",", "731", ",", "838", ",", "758", ",", "372", 
        ",", "691", ",", "745", ",", "439"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "815", ",", "466", ",", "311", ",", "544", ",", "243", ",", "257", ",",
         "525", ",", "590", ",", "731", ",", "837", ",", "757", ",", "380", 
        ",", "694", ",", "745", ",", "444"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "820", ",", "465", ",", "311", ",", "548", ",", "254", ",", "265", ",",
         "529", ",", "590", ",", "731", ",", "837", ",", "757", ",", "388", 
        ",", "697", ",", "745", ",", "448"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "825", ",", "464", ",", "311", ",", "552", ",", "264", ",", "273", ",",
         "532", ",", "591", ",", "731", ",", "836", ",", "756", ",", "396", 
        ",", "700", ",", "745", ",", "451"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "830", ",", "464", ",", "310", ",", "555", ",", "274", ",", "280", ",",
         "535", ",", "592", ",", "731", ",", "836", ",", "756", ",", "403", 
        ",", "702", ",", "745", ",", "454"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TCS1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "14"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "15"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"TCS1", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "i"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TCS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"TCS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], "]"}], "]"}],
         "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}]}], "//", 
       RowBox[{
        RowBox[{"N", "[", "#", "]"}], "&"}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"TCS1", ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.6554581676025534`*^9, {3.6554585286681614`*^9, 3.6554585545508566`*^9}, {
   3.6554587717915974`*^9, 3.655458796164322*^9}, {3.6554592254434066`*^9, 
   3.655459256832245*^9}, {3.6554593039251165`*^9, 3.655459317210935*^9}, {
   3.6554593472694187`*^9, 3.655459417917452*^9}, {3.6554596266826677`*^9, 
   3.655459656552495*^9}, {3.655459946388235*^9, 3.655459997829745*^9}, {
   3.655460053796756*^9, 3.6554600642086678`*^9}, {3.6554622108989553`*^9, 
   3.6554622620253944`*^9}, {3.65546238746297*^9, 3.6554624565049744`*^9}, {
   3.6554631106186514`*^9, 3.6554631286146*^9}, {3.6556965746409984`*^9, 
   3.6556966175054207`*^9}, 3.6556968383971167`*^9, {3.6556968863004026`*^9, 
   3.6556969584543962`*^9}, {3.655697075515136*^9, 3.655697237049828*^9}, {
   3.655697284360781*^9, 3.655697286958501*^9}, {3.6556973409468946`*^9, 
   3.6556973412100687`*^9}, 3.6556976830920553`*^9, {3.655697746219908*^9, 
   3.655697800902129*^9}, {3.6556981781529655`*^9, 3.6556981921427794`*^9}, {
   3.6556982948038945`*^9, 3.655698557481321*^9}, {3.655699678315644*^9, 
   3.655699736026801*^9}, {3.6557043423835497`*^9, 3.6557043438134985`*^9}, 
   3.6557061087573504`*^9, 3.65571304015698*^9, {3.655714019058317*^9, 
   3.6557140348391933`*^9}, {3.6557163365902987`*^9, 3.655716343494875*^9}, {
   3.65571637997715*^9, 3.655716392347353*^9}, {3.6557235430703754`*^9, 
   3.6557235493215237`*^9}, 3.655723588394456*^9, {3.6557237829460897`*^9, 
   3.655723801173303*^9}, {3.6557238610958815`*^9, 3.6557238941117873`*^9}, {
   3.6557239403328676`*^9, 3.655723951235103*^9}, {3.655723986922615*^9, 
   3.655724029462844*^9}, {3.6557241312475934`*^9, 3.655724137274592*^9}, 
   3.6557243004251246`*^9, 3.6557243336791897`*^9, {3.6557917045947137`*^9, 
   3.6557917258407993`*^9}, {3.6560286704798203`*^9, 3.65602867147648*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Calculate", " ", "u"}], ",", 
    RowBox[{
    "v", " ", "chromaticity", " ", "coordinates", " ", "of", " ", "samples", 
     " ", "under", " ", "test", " ", "illuminant"}], ",", "uk", ",", 
    RowBox[{"vk", " ", "and", "  ", "reference", " ", "illuminant"}], ",", 
    "ur", ",", 
    RowBox[{"vr", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"uki", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vki", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yki", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uri", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vri", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Range", "[", 
           RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}]}], "}"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yri", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ukip", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vkip", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Wstarr", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ustarr", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstarr", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Wstark", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ustark", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstark", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.6554581676025534`*^9, {3.6554585286681614`*^9, 3.6554585545508566`*^9}, {
   3.6554587717915974`*^9, 3.655458796164322*^9}, {3.6554592254434066`*^9, 
   3.655459256832245*^9}, {3.6554593039251165`*^9, 3.655459317210935*^9}, {
   3.6554593472694187`*^9, 3.655459417917452*^9}, {3.6554596266826677`*^9, 
   3.655459656552495*^9}, {3.655459946388235*^9, 3.655459997829745*^9}, {
   3.655460053796756*^9, 3.6554600642086678`*^9}, {3.6554622108989553`*^9, 
   3.6554622620253944`*^9}, {3.65546238746297*^9, 3.6554624565049744`*^9}, {
   3.6554631106186514`*^9, 3.6554631286146*^9}, {3.6556965746409984`*^9, 
   3.6556966175054207`*^9}, 3.6556968383971167`*^9, {3.6556968863004026`*^9, 
   3.6556969584543962`*^9}, {3.655697075515136*^9, 3.655697237049828*^9}, {
   3.655697284360781*^9, 3.655697286958501*^9}, {3.6556973409468946`*^9, 
   3.6556973412100687`*^9}, 3.6556976830920553`*^9, {3.655697746219908*^9, 
   3.655697800902129*^9}, {3.6556981781529655`*^9, 3.6556981921427794`*^9}, {
   3.6556982948038945`*^9, 3.655698557481321*^9}, {3.655699678315644*^9, 
   3.655699738897706*^9}, {3.6556998344635935`*^9, 3.6556999230391273`*^9}, 
   3.6557000626544347`*^9, {3.6557003217076793`*^9, 3.655700321894802*^9}, {
   3.655700363109418*^9, 3.655700387351497*^9}, {3.655700553977483*^9, 
   3.6557006400529833`*^9}, {3.6557019405156116`*^9, 3.65570198225179*^9}, {
   3.655702026611681*^9, 3.6557020774604*^9}, {3.655702109317037*^9, 
   3.655702207435523*^9}, {3.6557029317795043`*^9, 3.655702945233424*^9}, 
   3.655703025090808*^9, {3.6557032274897337`*^9, 3.6557032374783583`*^9}, {
   3.6557033087490997`*^9, 3.6557033506643324`*^9}, {3.655703600551304*^9, 
   3.6557036088227887`*^9}, {3.655703724416805*^9, 3.6557037270275345`*^9}, {
   3.655703987611121*^9, 3.655704020881421*^9}, 3.6557040775944233`*^9, {
   3.6557041770796576`*^9, 3.655704222019523*^9}, {3.6557043018566823`*^9, 
   3.655704310533431*^9}, {3.655704512586339*^9, 3.6557045602052736`*^9}, {
   3.655704599922609*^9, 3.655704787200497*^9}, 3.6557048408321543`*^9, {
   3.6557054229290195`*^9, 3.655705449310876*^9}, {3.655705572968727*^9, 
   3.655705641482052*^9}, {3.655705784805237*^9, 3.655705820506428*^9}, {
   3.6557059294562163`*^9, 3.655705963054497*^9}, {3.655706053313754*^9, 
   3.6557060703300376`*^9}, {3.655706169563487*^9, 3.6557062591294684`*^9}, {
   3.65570643408171*^9, 3.655706479665057*^9}, {3.6557065391865406`*^9, 
   3.655706613407891*^9}, 3.655706698723071*^9, {3.6557068241745653`*^9, 
   3.6557069324151163`*^9}, {3.6557069658923283`*^9, 3.65570698357405*^9}, {
   3.6557070159185185`*^9, 3.6557070599497166`*^9}, {3.6557074593541746`*^9, 
   3.6557074790282173`*^9}, {3.6557075132029033`*^9, 
   3.6557077182293415`*^9}, {3.655707751560758*^9, 3.6557078263912954`*^9}, {
   3.6557078657549734`*^9, 3.6557078866158056`*^9}, {3.655707928641674*^9, 
   3.6557079531729403`*^9}, {3.655707996113932*^9, 3.6557082438392076`*^9}, {
   3.6557082763963175`*^9, 3.6557083452097244`*^9}, {3.6557083991935344`*^9, 
   3.655708415258187*^9}, 3.6557130638903646`*^9, {3.6557134045946617`*^9, 
   3.655713422096797*^9}, 3.655713502906468*^9, 3.6557136937942843`*^9, {
   3.6557138712056756`*^9, 3.6557139071715612`*^9}, {3.655714146493576*^9, 
   3.655714148777092*^9}, {3.6557142405953417`*^9, 3.6557142612921658`*^9}, {
   3.655723481138032*^9, 3.6557234913137856`*^9}, {3.6557243957512074`*^9, 
   3.6557244495939455`*^9}, 3.6557829557579*^9, 3.6557879268128376`*^9, {
   3.656028672352061*^9, 3.6560286740631967`*^9}},
 NumberMarks->False],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"testAspd", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"380", ",", "0.00132948037347175"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"390", ",", "0.00164023432576807"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"400", ",", "0.00199607408541092"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"410", ",", "0.00239863299576014"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"420", ",", "0.00284898784428011"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"430", ",", "0.00334764547822949"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"440", ",", "0.00389454498476917"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"450", ",", "0.0044890736644276"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"460", ",", "0.00513009474369056"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"470", ",", "0.00581598464137424"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"480", ",", "0.00654467759688934"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"490", ",", "0.00731371555834619"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"500", ",", "0.00812030138807687"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"510", ",", "0.00896135364886274"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"520", ",", "0.00983356146587939"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"530", ",", "0.0107334382008557"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"540", ",", "0.0116573729136429"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"550", ",", "0.0126016788131223"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"560", ",", "0.0135626381078808"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"570", ",", "0.0145365428535139"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"580", ",", "0.0155197315558729"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"590", ",", "0.0165086214276558"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"600", ",", "0.0174997363101301"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"610", ",", "0.0184897303639286"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"620", ",", "0.0194754077047119"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"630", ",", "0.0204537382132532"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"640", ",", "0.0214218697874947"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"650", ",", "0.022377137328638"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"660", ",", "0.0233170687665763"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"670", ",", "0.0242393884339735"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"680", ",", "0.0251420180949075"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"690", ",", "0.0260230759248419"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"700", ",", "0.026880873725211"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"710", ",", "0.0277139126393038"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"720", ",", "0.0285208776174515"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"730", ",", "0.0293006308595934"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"740", ",", "0.0300522044428256"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"750", ",", "0.0307747923210527"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"760", ",", "0.0314677418638086"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"770", ",", "0.0321305450820022"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"780", ",", "0.0327628296700076"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"460", ",", "640", ",", "5"}], "]"}], ",", 
      RowBox[{"spdref", "/", 
       RowBox[{"Max", "[", "spdref", "]"}]}]}], "}"}], "//", "Transpose"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gRefSpd", "=", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], ",", 
         RowBox[{"spdref", "/", 
          RowBox[{"Max", "[", "spdref", "]"}]}]}], "}"}], "//", "Transpose"}],
       ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Green", ",", "Thick"}], "}"}]}], ",", 
      RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"testAspd", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "2"}], "]"}], "]"}], "=", 
  RowBox[{
   RowBox[{"testAspd", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", 
   RowBox[{"Max", "[", 
    RowBox[{"testAspd", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ga", "=", 
    RowBox[{"ListPlot", "[", "testAspd", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"tmpLEDs", "=", 
     RowBox[{"multiLedSpdModel", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}], ",", "0.45", ",", "0.2", ",", "0.35", ",", 
       "0.4", ",", "0.3"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"maxTmpLEDs", "=", 
     RowBox[{"Max", "[", "tmpLEDs", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tmpLEDs", "=", "tmpLEDs"}]}], 
   RowBox[{"(*", 
    RowBox[{"/", "maxTmpLEDs"}], "*)"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"gmData", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", 
      RowBox[{"460", ",", "640", ",", "5"}], "]"}], ",", 
     RowBox[{"tmpLEDs", "//", "Flatten"}]}], "}"}], "//", 
   "Transpose"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gm", "=", 
    RowBox[{"ListLinePlot", "[", 
     RowBox[{"gmData", ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Dashed", ",", "Thick"}], "}"}]}]}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"380", ",", "780"}], "}"}]}]}], "*)"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Show", "[", 
   RowBox[{"gRefSpd", ",", "ga", ",", "gm"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.6554581676025534`*^9, {3.6554585286681614`*^9, 3.6554585545508566`*^9}, {
   3.6554587717915974`*^9, 3.655458796164322*^9}, {3.6554592254434066`*^9, 
   3.655459256832245*^9}, {3.6554593039251165`*^9, 3.655459317210935*^9}, {
   3.6554593472694187`*^9, 3.655459417917452*^9}, {3.6554596266826677`*^9, 
   3.655459656552495*^9}, {3.655459946388235*^9, 3.655459997829745*^9}, {
   3.655460053796756*^9, 3.6554600642086678`*^9}, {3.6554622108989553`*^9, 
   3.6554622620253944`*^9}, {3.65546238746297*^9, 3.6554624565049744`*^9}, {
   3.6554631106186514`*^9, 3.6554631286146*^9}, {3.6556965746409984`*^9, 
   3.6556966175054207`*^9}, 3.6556968383971167`*^9, {3.6556968863004026`*^9, 
   3.6556969584543962`*^9}, {3.655697075515136*^9, 3.655697237049828*^9}, {
   3.655697284360781*^9, 3.655697286958501*^9}, {3.6556973409468946`*^9, 
   3.6556973412100687`*^9}, 3.6556976830920553`*^9, {3.655697746219908*^9, 
   3.655697800902129*^9}, {3.6556981781529655`*^9, 3.6556981921427794`*^9}, {
   3.6556982948038945`*^9, 3.655698557481321*^9}, {3.655699678315644*^9, 
   3.655699738897706*^9}, {3.6556998344635935`*^9, 3.6556999230391273`*^9}, 
   3.6557000626544347`*^9, {3.6557003217076793`*^9, 3.655700321894802*^9}, {
   3.655700363109418*^9, 3.655700387351497*^9}, {3.655700553977483*^9, 
   3.6557006400529833`*^9}, {3.6557019405156116`*^9, 3.65570198225179*^9}, {
   3.655702026611681*^9, 3.6557020774604*^9}, {3.655702109317037*^9, 
   3.655702207435523*^9}, {3.6557029317795043`*^9, 3.655702945233424*^9}, 
   3.655703025090808*^9, {3.6557032274897337`*^9, 3.6557032374783583`*^9}, {
   3.6557033087490997`*^9, 3.6557033506643324`*^9}, {3.655703600551304*^9, 
   3.6557036088227887`*^9}, {3.655703724416805*^9, 3.6557037270275345`*^9}, {
   3.655703987611121*^9, 3.655704020881421*^9}, 3.6557040775944233`*^9, {
   3.6557041770796576`*^9, 3.655704222019523*^9}, {3.6557043018566823`*^9, 
   3.655704310533431*^9}, {3.655704512586339*^9, 3.6557045602052736`*^9}, {
   3.655704599922609*^9, 3.655704787200497*^9}, 3.6557048408321543`*^9, {
   3.6557054229290195`*^9, 3.655705449310876*^9}, {3.655705572968727*^9, 
   3.655705641482052*^9}, {3.655705784805237*^9, 3.655705820506428*^9}, {
   3.6557059294562163`*^9, 3.655705963054497*^9}, {3.655706053313754*^9, 
   3.6557060703300376`*^9}, {3.655706169563487*^9, 3.6557062591294684`*^9}, {
   3.65570643408171*^9, 3.655706479665057*^9}, {3.6557065391865406`*^9, 
   3.655706613407891*^9}, 3.655706698723071*^9, {3.6557068241745653`*^9, 
   3.6557069324151163`*^9}, {3.6557069658923283`*^9, 3.65570698357405*^9}, {
   3.6557070159185185`*^9, 3.6557070599497166`*^9}, {3.6557074593541746`*^9, 
   3.6557074790282173`*^9}, {3.6557075132029033`*^9, 
   3.6557077182293415`*^9}, {3.655707751560758*^9, 3.6557078263912954`*^9}, {
   3.6557078657549734`*^9, 3.6557078866158056`*^9}, {3.655707928641674*^9, 
   3.6557079531729403`*^9}, {3.655707996113932*^9, 3.6557082438392076`*^9}, {
   3.6557082763963175`*^9, 3.6557083452097244`*^9}, {3.6557083991935344`*^9, 
   3.655708415258187*^9}, 3.6557130638903646`*^9, {3.6557134045946617`*^9, 
   3.655713422096797*^9}, 3.655713502906468*^9, 3.6557136937942843`*^9, {
   3.6557138712056756`*^9, 3.6557139071715612`*^9}, {3.655714146493576*^9, 
   3.655714148777092*^9}, {3.6557142405953417`*^9, 3.6557142612921658`*^9}, {
   3.655723481138032*^9, 3.6557234913137856`*^9}, {3.6557243957512074`*^9, 
   3.6557244495939455`*^9}, {3.6557829557579*^9, 3.655782977812488*^9}, {
   3.655783229603535*^9, 3.6557832824465227`*^9}, {3.6557833146428704`*^9, 
   3.6557833320370226`*^9}, 3.6557863725975466`*^9, {3.655792539378567*^9, 
   3.6557928283676414`*^9}, 3.655792861565674*^9, {3.6557930078626533`*^9, 
   3.6557930551768603`*^9}, {3.655793102259598*^9, 3.6557931629299684`*^9}, {
   3.6557933508851585`*^9, 3.6557933713717384`*^9}, {3.6557934092363625`*^9, 
   3.655793412251361*^9}, {3.6557934541711583`*^9, 3.6557934865350637`*^9}, 
   3.655793551626753*^9, {3.6557949148487616`*^9, 3.6557949553846416`*^9}, {
   3.655794991811226*^9, 3.6557950157000656`*^9}, {3.6557950463093753`*^9, 
   3.6557952641593103`*^9}, {3.655795294993759*^9, 3.655795373190171*^9}, {
   3.6557954373106475`*^9, 3.6557954532727947`*^9}, 3.6557955089805946`*^9, {
   3.6557955870779166`*^9, 3.6557955985835495`*^9}, {3.65579569073625*^9, 
   3.6557957390723*^9}, {3.6557957874860168`*^9, 3.6557958015566587`*^9}, {
   3.655795962523471*^9, 3.655795984651099*^9}, 3.655800887000678*^9, 
   3.655800923005571*^9, 3.655802180612537*^9, 3.6560243098435*^9, {
   3.656026031343935*^9, 3.6560260691450195`*^9}, {3.65602639400146*^9, 
   3.6560264848057365`*^9}, {3.656026519015581*^9, 3.6560266080639906`*^9}, {
   3.6560266428964953`*^9, 3.6560266675348434`*^9}, {3.656026731991165*^9, 
   3.656026800200192*^9}, {3.6560268345850077`*^9, 3.656026872864921*^9}, {
   3.6560269055175853`*^9, 3.656026963818671*^9}, {3.656027050777737*^9, 
   3.6560271795702753`*^9}, {3.6560275763888607`*^9, 
   3.6560278143381753`*^9}, {3.6560286382650404`*^9, 3.656028639697991*^9}, {
   3.6560286752059546`*^9, 3.6560286758233647`*^9}, 3.6560402097680397`*^9},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.04057892394712198`", ",", "0.05006387855654623`", ",", 
   "0.06092495994746772`", ",", "0.073212021669665`", ",", 
   "0.08695792985452008`", ",", "0.10217815469382543`", ",", 
   "0.11887083698189818`", ",", "0.13701727566398447`", ",", 
   "0.15658277369084678`", ",", "0.17751777547769093`", ",", 
   "0.19975922906563223`", ",", "0.2232321088261023`", ",", 
   "0.2478510394207652`", ",", "0.273521968008347`", ",", 
   "0.3001438387625421`", ",", "0.3276102311358508`", ",", 
   "0.35581093058987284`", ",", "0.3846334074330087`", ",", 
   "0.41396418577045496`", ",", "0.4436900902616855`", ",", 
   "0.47369936333918927`", ",", "0.5038826497568508`", ",", 
   "0.5341338488277787`", ",", "0.5643508375241115`", ",", 
   "0.5944360698044487`", ",", "0.6242970591754889`", ",", 
   "0.6538467526541254`", ",", "0.683003805044438`", ",", 
   "0.7116927628483102`", ",", "0.7398441672504009`", ",", 
   "0.7673945855148009`", ",", "0.7942865798513266`", ",", 
   "0.820468622397986`", ",", "0.8458949644595022`", ",", 
   "0.8705254675715831`", ",", "0.8943254033523352`", ",", 
   "0.9172652284773982`", ",", "0.9393203404901614`", ",", 
   "0.9604708195463174`", ",", "0.9807011606026137`", ",", "1.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.655792561941464*^9, 3.655792645066329*^9, {3.655792746219827*^9, 
   3.6557928299847145`*^9}, 3.6557928623201747`*^9, {3.655793019495369*^9, 
   3.65579305570221*^9}, {3.655793158350792*^9, 3.6557931634423094`*^9}, {
   3.6557933526373158`*^9, 3.6557933721052275`*^9}, 3.655793413094922*^9, {
   3.6557934574391613`*^9, 3.655793487005375*^9}, 3.655793552120081*^9, 
   3.655794873841254*^9, 3.6557949560861087`*^9, {3.655795057932084*^9, 
   3.655795078278574*^9}, {3.6557951205111876`*^9, 3.655795148482235*^9}, {
   3.6557952193020363`*^9, 3.655795264606608*^9}, {3.6557952990224295`*^9, 
   3.6557953736794953`*^9}, 3.6557954553651795`*^9, 3.655795509605007*^9, 
   3.6557956008550525`*^9, {3.6557956928336377`*^9, 3.655795739585643*^9}, {
   3.6557957769630404`*^9, 3.655795790063726*^9}, 3.655795836724981*^9, {
   3.655795963235943*^9, 3.6557959894532814`*^9}, 3.6558008893902636`*^9, 
   3.6558009236039686`*^9, 3.655802183014129*^9, 3.6560176303282404`*^9, 
   3.6560229017255125`*^9, 3.6560243130556297`*^9, 3.656025895451065*^9, {
   3.656026045899596*^9, 3.6560260703268003`*^9}, 3.6560261353079376`*^9, 
   3.6560262017565007`*^9, 3.6560262568407755`*^9, 3.656026350656594*^9, {
   3.6560264178682985`*^9, 3.6560264851489596`*^9}, {3.6560265192747517`*^9, 
   3.656026608407217*^9}, {3.6560266432557287`*^9, 3.656026667998148*^9}, {
   3.6560267323854218`*^9, 3.6560268014530196`*^9}, {3.6560268349742613`*^9, 
   3.6560268733422337`*^9}, {3.6560269058958354`*^9, 
   3.6560269642179317`*^9}, {3.6560270516303015`*^9, 
   3.6560271799615345`*^9}, {3.6560275787764444`*^9, 3.656027814985606*^9}, 
   3.6560402294410925`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"460", ",", "0.11717738898889322`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"465", ",", "0.17827602096516967`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"470", ",", "0.21804978222247115`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"475", ",", "0.2131470945186851`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"480", ",", "0.18069788893015265`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"485", ",", "0.15811123400877364`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"490", ",", "0.1734860435217388`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"495", ",", "0.23151524755610065`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"500", ",", "0.3053361110243033`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"505", ",", "0.3442509526047886`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"510", ",", "0.3333745919651554`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"515", ",", "0.29884532602936803`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"520", ",", "0.26891724604681155`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"525", ",", "0.2656596405680955`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"530", ",", "0.29249178567019074`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"535", ",", "0.3356375771941125`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"540", ",", "0.3734311608981475`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"545", ",", "0.3871853831439392`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"550", ",", "0.38521239107624694`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"555", ",", "0.38366745622455145`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"560", ",", "0.384239428798553`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"565", ",", "0.3901559894783754`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"570", ",", "0.406360624313007`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"575", ",", "0.4373627087308226`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"580", ",", "0.4824960094317531`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"585", ",", "0.5318001334251671`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"590", ",", "0.5673705084347236`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"595", ",", "0.5716971173123211`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"600", ",", "0.5555482658130111`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"605", ",", "0.5379596521569866`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"610", ",", "0.5214757975353604`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"615", ",", "0.5112780138543078`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"620", ",", "0.5235840959281254`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"625", ",", "0.5893673360173837`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"630", ",", "0.6984200337880592`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"635", ",", "0.7347165926797994`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"640", ",", "0.5550366400607045`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.655792561941464*^9, 3.655792645066329*^9, {3.655792746219827*^9, 
   3.6557928299847145`*^9}, 3.6557928623201747`*^9, {3.655793019495369*^9, 
   3.65579305570221*^9}, {3.655793158350792*^9, 3.6557931634423094`*^9}, {
   3.6557933526373158`*^9, 3.6557933721052275`*^9}, 3.655793413094922*^9, {
   3.6557934574391613`*^9, 3.655793487005375*^9}, 3.655793552120081*^9, 
   3.655794873841254*^9, 3.6557949560861087`*^9, {3.655795057932084*^9, 
   3.655795078278574*^9}, {3.6557951205111876`*^9, 3.655795148482235*^9}, {
   3.6557952193020363`*^9, 3.655795264606608*^9}, {3.6557952990224295`*^9, 
   3.6557953736794953`*^9}, 3.6557954553651795`*^9, 3.655795509605007*^9, 
   3.6557956008550525`*^9, {3.6557956928336377`*^9, 3.655795739585643*^9}, {
   3.6557957769630404`*^9, 3.655795790063726*^9}, 3.655795836724981*^9, {
   3.655795963235943*^9, 3.6557959894532814`*^9}, 3.6558008893902636`*^9, 
   3.6558009236039686`*^9, 3.655802183014129*^9, 3.6560176303282404`*^9, 
   3.6560229017255125`*^9, 3.6560243130556297`*^9, 3.656025895451065*^9, {
   3.656026045899596*^9, 3.6560260703268003`*^9}, 3.6560261353079376`*^9, 
   3.6560262017565007`*^9, 3.6560262568407755`*^9, 3.656026350656594*^9, {
   3.6560264178682985`*^9, 3.6560264851489596`*^9}, {3.6560265192747517`*^9, 
   3.656026608407217*^9}, {3.6560266432557287`*^9, 3.656026667998148*^9}, {
   3.6560267323854218`*^9, 3.6560268014530196`*^9}, {3.6560268349742613`*^9, 
   3.6560268733422337`*^9}, {3.6560269058958354`*^9, 
   3.6560269642179317`*^9}, {3.6560270516303015`*^9, 
   3.6560271799615345`*^9}, {3.6560275787764444`*^9, 3.656027814985606*^9}, 
   3.656040229449098*^9}],

Cell[BoxData[
 GraphicsBox[{{{}, 
    {RGBColor[0, 1, 0], Thickness[Large], PointBox[CompressedData["
1:eJxTTMoPSmViYGBQBWIQDQYHahz6HCyXJKw8Zw/mC9Q62InsjT8fdgHCT6h1
WNCwIj048SKEv6HWYTtrpy57ySUIn6HOwXNz9PINfZch/IA6h5W7LAIEN16B
8BfUOUwL/l7z7NZVCP9DnYNUPsuml9zXIXyHegcL7fM/LzjfgPAn1DtYSVhZ
+zfdhPAf1DuwrOjpFzl+C8KXaHBgisuZfk7wDlR/g0NvWuE5jaS7EH5Gg4O/
0Lc7Z7bfg5rX4HCc71mxIecDCH9Hg0P7jWPvTuyA8h80OAg7LX1Qn/UQwudo
dAjfr/tTQ+4RhG/Q6LDOa8aOaZeh/IhGh7Z1VRNmdz2G8BsaHabV/GDicn4C
4a9odGA/5nZgyx8o/0Kjwye52kN5259C+D8aHZ7M2pDOXfwMwldocpD0j+iK
038O4Xs0OZwp+Tvd5g2UX9DksHSq9bKqlS8g/BlNDpxG4m3v0l5C+AeaHBZK
bb6ap/IKwn/R5LDHNU/g8kMoX6DZodeidO7nea8hfItmB0eXy3dWRr+Bxm+z
Q9I+AeML4m8h/I5mh/+qOcJOl6H8Dc0O+rv2cNzpfQfh32h2mF7Pu7fa/T00
/lscIPQHewC+NMG6
      "]]}, {}}, {{}, 
    {RGBColor[0.24720000000000014`, 0.24, 0.6], PointBox[CompressedData["
1:eJxTTMoPSmViYGDQBGIQDQYHyh08/rfsO3RsiT2Yn1Dh8OanBdPPhSshfIZK
B0e+Hzl9hush/AWVDgwn9z1j3bcJwneocngWf+vHfadtEP6DKoegvmM/IjR2
QfgN1Q6/+D23Bubtg/AVahxOxP02O9F5EMI/UOPQ5MDf9JzrCNT+WgenYEGO
5zuOQe2vc9g+98vdrRNPQu2vc3i8IHP5vUlnoPbXOzza7202ded5qP31DhPD
rnokNV6Eyjc4ROs/begzvQzhT2hw4BdQeT7h+xWo+gaH4PA5prOPXoPwDRod
Zr4pL7g69wbU/Y0O8jHPFifX3YLwLzQ6GL09J5edegfqnyaHHYnZSuKB9yD8
giaH5e7bG8/JP4D6r8mh6U7PvfniDyF8gWaHgJgrNZr8j6D+bXZY/O71qXms
jyH8Dc0OP3e2XLb9BeUztDg43ExnC3jzBMIPaHGYsnnbaa3bT6Hh0eJwsXz5
M/1jzyD8Dy0Omk7n15xd8xzq/1aHw9Z/xer7XkD93+pwY17zhtNZL6H+b3VQ
+Tcp093xFdT/bQ5FPWyBkwRfQ/3f5sB5eKNlxG0o/0KbQ7D2G7+AeW+g/m93
cDc4NNsm6i3U/+0Opu9ut7/kewf1f7sDz/VrPrp7oHyBDocD/2vTnie+h/q/
wwHizw/2AKu53wo=
      "]]}, {}}, {{}, {{}, {}, 
     {RGBColor[1, 0, 0], Thickness[Large], Dashing[{Small, Small}], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGBQBWIQDQYHahyMd3TGhv3faw/mC9Q6HM++tXz/xWMQfkKt
w/ULR1X5Xp6G8DfUOhT+lshJ94DyGeocti3eclBa8TiEH1DnEBQyU/OvzREI
f0Gdw5KGeZmnTKDmfahzmLE+eYXXorMQvkO9A/OJExULui5D+BPqHRqrD6ua
clyD8B/UO6hsLE5iCrsK4Us0OBh+LlP1UICqd2hwYKpzW/fB9CKEn9HgUH2L
zXsiA5Q/ocHhRGhxuf6OSxD+jgaH0vthHGLVUPMeNDhcjrx+3vvZdQifo9Fh
7atW46XHb0D4Bo0O695l3w9cDuVHNDpM6HD8xNgH5Tc0Osg1Kv5MmA7lr2h0
0Ko+eTngB5R/odHh0tzPf88z3oLwfzQ65HnO1zjw9zaEr9DkcCrP9qPZw3sQ
vkeTw1TLRdsaWR5C+AVNDjKqfkbP1B9B+DOaHCJiDx0I94byDzQ5hLQpaPAe
h6p/0eTAO09I87sZlC/Q7NBtw8T8bv0DCN+i2eFHwtStyTFQfkKzw/2PYvnG
B6H8jmYHv/MGjyXuQM3f0OywcWv9j5LIZxD+jWaHRzk68WeankPjv8XhU5+K
8Z1DD+0BI8XGAQ==
       "]]}}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{460., 0.23954399126751408`},
  ImageSize->{581., Automatic},
  Method->{},
  PlotRange->{{460., 640.}, {0.23954399126751408`, 1.}},
  PlotRangeClipping->True,
  PlotRangePadding->{{3.6, 3.6}, {0.015209120174649718`, 
   0.015209120174649718`}}]], "Output",
 CellChangeTimes->{
  3.655792561941464*^9, 3.655792645066329*^9, {3.655792746219827*^9, 
   3.6557928299847145`*^9}, 3.6557928623201747`*^9, {3.655793019495369*^9, 
   3.65579305570221*^9}, {3.655793158350792*^9, 3.6557931634423094`*^9}, {
   3.6557933526373158`*^9, 3.6557933721052275`*^9}, 3.655793413094922*^9, {
   3.6557934574391613`*^9, 3.655793487005375*^9}, 3.655793552120081*^9, 
   3.655794873841254*^9, 3.6557949560861087`*^9, {3.655795057932084*^9, 
   3.655795078278574*^9}, {3.6557951205111876`*^9, 3.655795148482235*^9}, {
   3.6557952193020363`*^9, 3.655795264606608*^9}, {3.6557952990224295`*^9, 
   3.6557953736794953`*^9}, 3.6557954553651795`*^9, 3.655795509605007*^9, 
   3.6557956008550525`*^9, {3.6557956928336377`*^9, 3.655795739585643*^9}, {
   3.6557957769630404`*^9, 3.655795790063726*^9}, 3.655795836724981*^9, {
   3.655795963235943*^9, 3.6557959894532814`*^9}, 3.6558008893902636`*^9, 
   3.6558009236039686`*^9, 3.655802183014129*^9, 3.6560176303282404`*^9, 
   3.6560229017255125`*^9, 3.6560243130556297`*^9, 3.656025895451065*^9, {
   3.656026045899596*^9, 3.6560260703268003`*^9}, 3.6560261353079376`*^9, 
   3.6560262017565007`*^9, 3.6560262568407755`*^9, 3.656026350656594*^9, {
   3.6560264178682985`*^9, 3.6560264851489596`*^9}, {3.6560265192747517`*^9, 
   3.656026608407217*^9}, {3.6560266432557287`*^9, 3.656026667998148*^9}, {
   3.6560267323854218`*^9, 3.6560268014530196`*^9}, {3.6560268349742613`*^9, 
   3.6560268733422337`*^9}, {3.6560269058958354`*^9, 
   3.6560269642179317`*^9}, {3.6560270516303015`*^9, 
   3.6560271799615345`*^9}, {3.6560275787764444`*^9, 3.656027814985606*^9}, 
   3.6560402294641113`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"multiLedSpdModel", "[", 
        RowBox[{
        "cie1931Length", ",", "0.6", ",", "0.2", ",", "0.6", ",", "0.6", ",", 
         "0.3"}], "]"}], "*", "cie1931xBar"}], "//", "Total"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Y", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"multiLedSpdModel", "[", 
        RowBox[{
        "cie1931Length", ",", "0.6", ",", "0.2", ",", "0.6", ",", "0.6", ",", 
         "0.3"}], "]"}], "*", "cie1931yBar"}], "//", "Total"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Z", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"multiLedSpdModel", "[", 
        RowBox[{
        "cie1931Length", ",", "0.6", ",", "0.2", ",", "0.6", ",", "0.6", ",", 
         "0.3"}], "]"}], "*", "cie1931zBar"}], "//", "Total"}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xBarData", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], "}"}], "//", 
      "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yBarData", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}]}], "}"}], "//", 
      "Transpose"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zBarData", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"cie1931Data", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "4"}], "]"}], "]"}]}], "}"}], "//", 
      "Transpose"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xBarInterFunc", "=", 
     RowBox[{"Interpolation", "[", "xBarData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xBarInterFunc", "[", 
     RowBox[{"Range", "[", 
      RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yBarInterFunc", "=", 
     RowBox[{"Interpolation", "[", "yBarData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"zBarInterFunc", "=", 
     RowBox[{"Interpolation", "[", "zBarData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{
      RowBox[{"tmpLEDs", "*", 
       RowBox[{"xBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], 
      RowBox[{"(*", 
       RowBox[{"\:6a2a\:8f74\:5355\:4f4d", "\:ff1a", "nm"}], "*)"}], "//", 
      "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y", "=", 
     RowBox[{
      RowBox[{"tmpLEDs", "*", 
       RowBox[{"yBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], 
      RowBox[{"(*", 
       RowBox[{"\:6a2a\:8f74\:5355\:4f4d", "\:ff1a", "nm"}], "*)"}], "//", 
      "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", "=", 
     RowBox[{
      RowBox[{"tmpLEDs", "*", 
       RowBox[{"zBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], 
      RowBox[{"(*", 
       RowBox[{"\:6a2a\:8f74\:5355\:4f4d", "\:ff1a", "nm"}], "*)"}], "//", 
      "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"x", "=", 
    RowBox[{"X", "/", 
     RowBox[{"(", 
      RowBox[{"X", "+", "Y", "+", "Z"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"y", "=", 
    RowBox[{"Y", "/", 
     RowBox[{"(", 
      RowBox[{"X", "+", "Y", "+", "Z"}], ")"}]}]}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"Yknormal", "=", 
     RowBox[{"100", "/", "Y"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Yk", "=", 
    RowBox[{"Y", "*", "Yknormal"}]}], "\[IndentingNewLine]", 
   RowBox[{"uk", "=", 
    RowBox[{"4", "*", 
     RowBox[{"X", "/", 
      RowBox[{"(", 
       RowBox[{"X", "+", 
        RowBox[{"15", "*", "Y"}], "+", 
        RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], "\n", 
   RowBox[{"vk", "=", 
    RowBox[{"6", "*", 
     RowBox[{"Y", "/", 
      RowBox[{"(", 
       RowBox[{"X", "+", 
        RowBox[{"15", "*", "Y"}], "+", 
        RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{
  3.6554581676025534`*^9, {3.6554585286681614`*^9, 3.6554585545508566`*^9}, {
   3.6554587717915974`*^9, 3.655458796164322*^9}, {3.6554592254434066`*^9, 
   3.655459256832245*^9}, {3.6554593039251165`*^9, 3.655459317210935*^9}, {
   3.6554593472694187`*^9, 3.655459417917452*^9}, {3.6554596266826677`*^9, 
   3.655459656552495*^9}, {3.655459946388235*^9, 3.655459997829745*^9}, {
   3.655460053796756*^9, 3.6554600642086678`*^9}, {3.6554622108989553`*^9, 
   3.6554622620253944`*^9}, {3.65546238746297*^9, 3.6554624565049744`*^9}, {
   3.6554631106186514`*^9, 3.6554631286146*^9}, {3.6556965746409984`*^9, 
   3.6556966175054207`*^9}, 3.6556968383971167`*^9, {3.6556968863004026`*^9, 
   3.6556969584543962`*^9}, {3.655697075515136*^9, 3.655697237049828*^9}, {
   3.655697284360781*^9, 3.655697286958501*^9}, {3.6556973409468946`*^9, 
   3.6556973412100687`*^9}, 3.6556976830920553`*^9, {3.655697746219908*^9, 
   3.655697800902129*^9}, {3.6556981781529655`*^9, 3.6556981921427794`*^9}, {
   3.6556982948038945`*^9, 3.655698557481321*^9}, {3.655699678315644*^9, 
   3.655699738897706*^9}, {3.6556998344635935`*^9, 3.6556999230391273`*^9}, 
   3.6557000626544347`*^9, {3.6557003217076793`*^9, 3.655700321894802*^9}, {
   3.655700363109418*^9, 3.655700387351497*^9}, {3.655700553977483*^9, 
   3.6557006400529833`*^9}, {3.6557019405156116`*^9, 3.65570198225179*^9}, {
   3.655702026611681*^9, 3.6557020774604*^9}, {3.655702109317037*^9, 
   3.655702207435523*^9}, {3.6557029317795043`*^9, 3.655702945233424*^9}, 
   3.655703025090808*^9, {3.6557032274897337`*^9, 3.6557032374783583`*^9}, {
   3.6557033087490997`*^9, 3.6557033506643324`*^9}, {3.655703600551304*^9, 
   3.6557036088227887`*^9}, {3.655703724416805*^9, 3.6557037270275345`*^9}, {
   3.655703987611121*^9, 3.655704020881421*^9}, 3.6557040775944233`*^9, {
   3.6557041770796576`*^9, 3.655704222019523*^9}, {3.6557043018566823`*^9, 
   3.655704310533431*^9}, {3.655704512586339*^9, 3.6557045602052736`*^9}, {
   3.655704599922609*^9, 3.655704787200497*^9}, 3.6557048408321543`*^9, {
   3.6557054229290195`*^9, 3.655705449310876*^9}, {3.655705572968727*^9, 
   3.655705641482052*^9}, {3.655705784805237*^9, 3.655705820506428*^9}, {
   3.6557059294562163`*^9, 3.655705963054497*^9}, {3.655706053313754*^9, 
   3.6557060703300376`*^9}, {3.655706169563487*^9, 3.6557062591294684`*^9}, {
   3.65570643408171*^9, 3.655706479665057*^9}, {3.6557065391865406`*^9, 
   3.655706613407891*^9}, 3.655706698723071*^9, {3.6557068241745653`*^9, 
   3.6557069324151163`*^9}, {3.6557069658923283`*^9, 3.65570698357405*^9}, {
   3.6557070159185185`*^9, 3.6557070599497166`*^9}, {3.6557074593541746`*^9, 
   3.6557074790282173`*^9}, {3.6557075132029033`*^9, 
   3.6557077182293415`*^9}, {3.655707751560758*^9, 3.6557078263912954`*^9}, {
   3.6557078657549734`*^9, 3.6557078866158056`*^9}, {3.655707928641674*^9, 
   3.6557079531729403`*^9}, {3.655707996113932*^9, 3.6557082438392076`*^9}, {
   3.6557082763963175`*^9, 3.6557083452097244`*^9}, {3.6557083991935344`*^9, 
   3.655708415258187*^9}, 3.6557130638903646`*^9, {3.6557134045946617`*^9, 
   3.655713422096797*^9}, 3.655713502906468*^9, 3.6557136937942843`*^9, {
   3.6557138712056756`*^9, 3.6557139071715612`*^9}, {3.655714146493576*^9, 
   3.655714148777092*^9}, {3.6557142405953417`*^9, 3.6557142612921658`*^9}, {
   3.655723481138032*^9, 3.6557234913137856`*^9}, {3.6557243957512074`*^9, 
   3.6557244495939455`*^9}, {3.6557829557579*^9, 3.655782977812488*^9}, {
   3.655783229603535*^9, 3.6557832824465227`*^9}, 3.6557833146428704`*^9, {
   3.6557833563281326`*^9, 3.6557833600956287`*^9}, {3.6557834176678066`*^9, 
   3.655783464743125*^9}, {3.6557835075240116`*^9, 3.655783531054614*^9}, {
   3.655783562753996*^9, 3.6557836239455976`*^9}, {3.6557838886794333`*^9, 
   3.655784015198513*^9}, {3.655784106754703*^9, 3.6557842229192495`*^9}, 
   3.6557843088533196`*^9, {3.655784478028822*^9, 3.655784772514727*^9}, {
   3.6557848499373136`*^9, 3.6557848592985215`*^9}, {3.6557849756977367`*^9, 
   3.655785020474043*^9}, {3.6557850550961933`*^9, 3.655785078728364*^9}, {
   3.655785138224947*^9, 3.655785142681903*^9}, {3.6557856751024017`*^9, 
   3.655785685680417*^9}, 3.6557858753204727`*^9, {3.65579204973027*^9, 
   3.6557920575124316`*^9}, {3.6557921289008718`*^9, 3.655792141346426*^9}, {
   3.655792343161824*^9, 3.6557923555380335`*^9}, {3.6560191260149403`*^9, 
   3.656019127581985*^9}, {3.65602587533672*^9, 3.6560258763744087`*^9}, {
   3.6560286415892463`*^9, 3.6560286456079135`*^9}, {3.6560286964610577`*^9, 
   3.6560286974497156`*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", "0.45351913472046174`", "}"}]], "Output",
 CellChangeTimes->{3.655792146582897*^9, 3.6557923870885725`*^9, 
  3.655794873904296*^9, 3.656017630426304*^9, 3.656022901822575*^9, 
  3.6560258955191097`*^9, 3.6560261353559694`*^9, 3.656026201806533*^9, 
  3.656026256894812*^9, 3.6560263507156324`*^9, 3.656040229491125*^9}],

Cell[BoxData[
 RowBox[{"{", "0.4548973116338037`", "}"}]], "Output",
 CellChangeTimes->{3.655792146582897*^9, 3.6557923870885725`*^9, 
  3.655794873904296*^9, 3.656017630426304*^9, 3.656022901822575*^9, 
  3.6560258955191097`*^9, 3.6560261353559694`*^9, 3.656026201806533*^9, 
  3.656026256894812*^9, 3.6560263507156324`*^9, 3.656040229493127*^9}],

Cell[BoxData[
 RowBox[{"{", "100.`", "}"}]], "Output",
 CellChangeTimes->{3.655792146582897*^9, 3.6557923870885725`*^9, 
  3.655794873904296*^9, 3.656017630426304*^9, 3.656022901822575*^9, 
  3.6560258955191097`*^9, 3.6560261353559694`*^9, 3.656026201806533*^9, 
  3.656026256894812*^9, 3.6560263507156324`*^9, 3.6560402294951277`*^9}],

Cell[BoxData[
 RowBox[{"{", "0.24022001132970636`", "}"}]], "Output",
 CellChangeTimes->{3.655792146582897*^9, 3.6557923870885725`*^9, 
  3.655794873904296*^9, 3.656017630426304*^9, 3.656022901822575*^9, 
  3.6560258955191097`*^9, 3.6560261353559694`*^9, 3.656026201806533*^9, 
  3.656026256894812*^9, 3.6560263507156324`*^9, 3.6560402294971294`*^9}],

Cell[BoxData[
 RowBox[{"{", "0.36142500609774725`", "}"}]], "Output",
 CellChangeTimes->{3.655792146582897*^9, 3.6557923870885725`*^9, 
  3.655794873904296*^9, 3.656017630426304*^9, 3.656022901822575*^9, 
  3.6560258955191097`*^9, 3.6560261353559694`*^9, 3.656026201806533*^9, 
  3.656026256894812*^9, 3.6560263507156324`*^9, 3.6560402294991307`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{
      RowBox[{"spdref", "*", 
       RowBox[{"xBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], "//",
       "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y", "=", 
     RowBox[{
      RowBox[{"spdref", "*", 
       RowBox[{"yBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], "//",
       "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", "=", 
     RowBox[{
      RowBox[{"spdref", "*", 
       RowBox[{"zBarInterFunc", "[", 
        RowBox[{"Range", "[", 
         RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5"}], "//",
       "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yrnormal", "=", 
     RowBox[{"100", "/", "Y"}]}], ";"}], "\n", 
   RowBox[{"Yr", "=", 
    RowBox[{"Y", "*", "Yrnormal"}]}], "\n", 
   RowBox[{"ur", "=", 
    RowBox[{"4", "*", 
     RowBox[{"X", "/", 
      RowBox[{"(", 
       RowBox[{"X", "+", 
        RowBox[{"15", "*", "Y"}], "+", 
        RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], "\n", 
   RowBox[{"vr", "=", 
    RowBox[{"6", "*", 
     RowBox[{"Y", "/", 
      RowBox[{"(", 
       RowBox[{"X", "+", 
        RowBox[{"15", "*", "Y"}], "+", 
        RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.6554581676025534`*^9, {3.6554585286681614`*^9, 3.6554585545508566`*^9}, {
   3.6554587717915974`*^9, 3.655458796164322*^9}, {3.6554592254434066`*^9, 
   3.655459256832245*^9}, {3.6554593039251165`*^9, 3.655459317210935*^9}, {
   3.6554593472694187`*^9, 3.655459417917452*^9}, {3.6554596266826677`*^9, 
   3.655459656552495*^9}, {3.655459946388235*^9, 3.655459997829745*^9}, {
   3.655460053796756*^9, 3.6554600642086678`*^9}, {3.6554622108989553`*^9, 
   3.6554622620253944`*^9}, {3.65546238746297*^9, 3.6554624565049744`*^9}, {
   3.6554631106186514`*^9, 3.6554631286146*^9}, {3.6556965746409984`*^9, 
   3.6556966175054207`*^9}, 3.6556968383971167`*^9, {3.6556968863004026`*^9, 
   3.6556969584543962`*^9}, {3.655697075515136*^9, 3.655697237049828*^9}, {
   3.655697284360781*^9, 3.655697286958501*^9}, {3.6556973409468946`*^9, 
   3.6556973412100687`*^9}, 3.6556976830920553`*^9, {3.655697746219908*^9, 
   3.655697800902129*^9}, {3.6556981781529655`*^9, 3.6556981921427794`*^9}, {
   3.6556982948038945`*^9, 3.655698557481321*^9}, {3.655699678315644*^9, 
   3.655699738897706*^9}, {3.6556998344635935`*^9, 3.6556999230391273`*^9}, 
   3.6557000626544347`*^9, {3.6557003217076793`*^9, 3.655700321894802*^9}, {
   3.655700363109418*^9, 3.655700387351497*^9}, {3.655700553977483*^9, 
   3.6557006400529833`*^9}, {3.6557019405156116`*^9, 3.65570198225179*^9}, {
   3.655702026611681*^9, 3.6557020774604*^9}, {3.655702109317037*^9, 
   3.655702207435523*^9}, {3.6557029317795043`*^9, 3.655702945233424*^9}, 
   3.655703025090808*^9, {3.6557032274897337`*^9, 3.6557032374783583`*^9}, {
   3.6557033087490997`*^9, 3.6557033506643324`*^9}, {3.655703600551304*^9, 
   3.6557036088227887`*^9}, {3.655703724416805*^9, 3.6557037270275345`*^9}, {
   3.655703987611121*^9, 3.655704020881421*^9}, 3.6557040775944233`*^9, {
   3.6557041770796576`*^9, 3.655704222019523*^9}, {3.6557043018566823`*^9, 
   3.655704310533431*^9}, {3.655704512586339*^9, 3.6557045602052736`*^9}, {
   3.655704599922609*^9, 3.655704787200497*^9}, 3.6557048408321543`*^9, {
   3.6557054229290195`*^9, 3.655705449310876*^9}, {3.655705572968727*^9, 
   3.655705641482052*^9}, {3.655705784805237*^9, 3.655705820506428*^9}, {
   3.6557059294562163`*^9, 3.655705963054497*^9}, {3.655706053313754*^9, 
   3.6557060703300376`*^9}, {3.655706169563487*^9, 3.6557062591294684`*^9}, {
   3.65570643408171*^9, 3.655706479665057*^9}, {3.6557065391865406`*^9, 
   3.655706613407891*^9}, 3.655706698723071*^9, {3.6557068241745653`*^9, 
   3.6557069324151163`*^9}, {3.6557069658923283`*^9, 3.65570698357405*^9}, {
   3.6557070159185185`*^9, 3.6557070599497166`*^9}, {3.6557074593541746`*^9, 
   3.6557074790282173`*^9}, {3.6557075132029033`*^9, 
   3.6557077182293415`*^9}, {3.655707751560758*^9, 3.6557078263912954`*^9}, {
   3.6557078657549734`*^9, 3.6557078866158056`*^9}, {3.655707928641674*^9, 
   3.6557079531729403`*^9}, {3.655707996113932*^9, 3.6557082438392076`*^9}, {
   3.6557082763963175`*^9, 3.6557083452097244`*^9}, {3.6557083991935344`*^9, 
   3.655708415258187*^9}, 3.6557130638903646`*^9, {3.6557134045946617`*^9, 
   3.655713422096797*^9}, 3.655713502906468*^9, 3.6557136937942843`*^9, {
   3.6557138712056756`*^9, 3.6557139071715612`*^9}, {3.655714146493576*^9, 
   3.655714148777092*^9}, {3.6557142405953417`*^9, 3.6557142612921658`*^9}, {
   3.655723481138032*^9, 3.6557234913137856`*^9}, {3.6557243957512074`*^9, 
   3.6557244495939455`*^9}, {3.6557829557579*^9, 3.655782977812488*^9}, {
   3.655783229603535*^9, 3.6557832824465227`*^9}, 3.6557833146428704`*^9, {
   3.6557833563281326`*^9, 3.6557833600956287`*^9}, {3.6557834176678066`*^9, 
   3.655783464743125*^9}, {3.6557835075240116`*^9, 3.655783531054614*^9}, 
   3.655783562753996*^9, 3.6557856638819623`*^9, {3.6557859055178785`*^9, 
   3.6557859630455427`*^9}, {3.655786076749511*^9, 3.655786148672621*^9}, {
   3.6557862251478386`*^9, 3.655786256938502*^9}, {3.6557879438671646`*^9, 
   3.6557879448338056`*^9}, {3.6560286464384637`*^9, 3.656028651055527*^9}, {
   3.656028698425362*^9, 3.6560286994100156`*^9}},
 NumberMarks->False],

Cell[BoxData["99.99999999999999`"], "Output",
 CellChangeTimes->{
  3.655786138188847*^9, {3.6557862446427712`*^9, 3.6557862574508424`*^9}, 
   3.6557923871165915`*^9, 3.6557948739333143`*^9, 3.656017630447318*^9, 
   3.6560229018435884`*^9, 3.656025895541128*^9, 3.6560261353789864`*^9, 
   3.6560262018335505`*^9, 3.6560262569248314`*^9, 3.656026350745652*^9, 
   3.656040229517144*^9}],

Cell[BoxData["0.24007380021096233`"], "Output",
 CellChangeTimes->{
  3.655786138188847*^9, {3.6557862446427712`*^9, 3.6557862574508424`*^9}, 
   3.6557923871165915`*^9, 3.6557948739333143`*^9, 3.656017630447318*^9, 
   3.6560229018435884`*^9, 3.656025895541128*^9, 3.6560261353789864`*^9, 
   3.6560262018335505`*^9, 3.6560262569248314`*^9, 3.656026350745652*^9, 
   3.656040229519145*^9}],

Cell[BoxData["0.3614823363278258`"], "Output",
 CellChangeTimes->{
  3.655786138188847*^9, {3.6557862446427712`*^9, 3.6557862574508424`*^9}, 
   3.6557923871165915`*^9, 3.6557948739333143`*^9, 3.656017630447318*^9, 
   3.6560229018435884`*^9, 3.656025895541128*^9, 3.6560261353789864`*^9, 
   3.6560262018335505`*^9, 3.6560262569248314`*^9, 3.656026350745652*^9, 
   3.656040229521147*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"deltaC", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"uk", "-", "ur"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vk", "-", "vr"}], ")"}], "^", "2"}]}], ")"}], "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"deltaC", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "<", 
      RowBox[{"5.4", "*", 
       RowBox[{"10", "^", 
        RowBox[{"-", "3"}]}]}]}], ",", 
     RowBox[{"Print", "[", "\"\<well done\>\"", "]"}], ",", 
     RowBox[{"Print", "[", "\"\<Oh Gosh,Wrong!\>\"", "]"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.656017677546976*^9, 3.6560177716698027`*^9}, {
  3.6560178116233897`*^9, 3.6560178279172883`*^9}, {3.6560178805979342`*^9, 
  3.6560179808107176`*^9}}],

Cell[BoxData[
 RowBox[{"{", "0.00015704918505116822`", "}"}]], "Output",
 CellChangeTimes->{
  3.6560177748619385`*^9, {3.6560179461051445`*^9, 3.656017962071825*^9}, 
   3.656022901862602*^9, 3.656025895559143*^9, 3.6560261354010005`*^9, 
   3.6560262018565664`*^9, 3.656026256947847*^9, 3.6560263507746725`*^9, 
   3.656040229538159*^9}],

Cell[BoxData["\<\"well done\"\>"], "Print",
 CellChangeTimes->{3.6560179620858283`*^9, 3.6560229018636036`*^9, 
  3.6560258955611396`*^9, 3.6560261354040017`*^9, 3.656026201858568*^9, 
  3.6560262569498477`*^9, 3.6560263507776737`*^9, 3.6560402295411596`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "<", "15"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X", "=", 
      RowBox[{
       RowBox[{"tmpLEDs", "*", 
        RowBox[{"xBarInterFunc", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5", "*", 
        RowBox[{"TCS1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "//", "Total"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Y", "=", 
      RowBox[{
       RowBox[{"tmpLEDs", "*", 
        RowBox[{"yBarInterFunc", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5", "*", 
        RowBox[{"TCS1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "//", "Total"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{
       RowBox[{"tmpLEDs", "*", 
        RowBox[{"zBarInterFunc", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5", "*", 
        RowBox[{"TCS1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "//", "Total"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Yki", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Y", "*", "Yknormal"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"uki", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"4", "*", 
       RowBox[{"X", "/", 
        RowBox[{"(", 
         RowBox[{"X", "+", 
          RowBox[{"15", "*", "Y"}], "+", 
          RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";", "\n", "  ", 
     RowBox[{
      RowBox[{"vki", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"6", "*", 
       RowBox[{"Y", "/", 
        RowBox[{"(", 
         RowBox[{"X", "+", 
          RowBox[{"15", "*", "Y"}], "+", 
          RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"X", "=", 
      RowBox[{
       RowBox[{"spdref", "*", 
        RowBox[{"xBarInterFunc", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5", "*", 
        RowBox[{"TCS1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "//", "Total"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Y", "=", 
      RowBox[{
       RowBox[{"spdref", "*", 
        RowBox[{"yBarInterFunc", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5", "*", 
        RowBox[{"TCS1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "//", "Total"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{
       RowBox[{"spdref", "*", 
        RowBox[{"zBarInterFunc", "[", 
         RowBox[{"Range", "[", 
          RowBox[{"460", ",", "640", ",", "5"}], "]"}], "]"}], "*", "5", "*", 
        RowBox[{"TCS1", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "i"}], "]"}], "]"}]}], "//", "Total"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Yri", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"Y", "*", "Yrnormal"}]}], ";", "\n", "   ", 
     RowBox[{
      RowBox[{"uri", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"4", "*", 
       RowBox[{"X", "/", 
        RowBox[{"(", 
         RowBox[{"X", "+", 
          RowBox[{"15", "*", "Y"}], "+", 
          RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";", "\n", "   ", 
     RowBox[{
      RowBox[{"vri", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "=", 
      RowBox[{"6", "*", 
       RowBox[{"Y", "/", 
        RowBox[{"(", 
         RowBox[{"X", "+", 
          RowBox[{"15", "*", "Y"}], "+", 
          RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", "Yki", \
"\[IndentingNewLine]", "Yri", "\[IndentingNewLine]", "uki", "\
\[IndentingNewLine]", "vki", "\[IndentingNewLine]", "uri", "\
\[IndentingNewLine]", "vri"}], "Input",
 CellChangeTimes->{
  3.6554581676025534`*^9, {3.6554585286681614`*^9, 3.6554585545508566`*^9}, {
   3.6554587717915974`*^9, 3.655458796164322*^9}, {3.6554592254434066`*^9, 
   3.655459256832245*^9}, {3.6554593039251165`*^9, 3.655459317210935*^9}, {
   3.6554593472694187`*^9, 3.655459417917452*^9}, {3.6554596266826677`*^9, 
   3.655459656552495*^9}, {3.655459946388235*^9, 3.655459997829745*^9}, {
   3.655460053796756*^9, 3.6554600642086678`*^9}, {3.6554622108989553`*^9, 
   3.6554622620253944`*^9}, {3.65546238746297*^9, 3.6554624565049744`*^9}, {
   3.6554631106186514`*^9, 3.6554631286146*^9}, {3.6556965746409984`*^9, 
   3.6556966175054207`*^9}, 3.6556968383971167`*^9, {3.6556968863004026`*^9, 
   3.6556969584543962`*^9}, {3.655697075515136*^9, 3.655697237049828*^9}, {
   3.655697284360781*^9, 3.655697286958501*^9}, {3.6556973409468946`*^9, 
   3.6556973412100687`*^9}, 3.6556976830920553`*^9, {3.655697746219908*^9, 
   3.655697800902129*^9}, {3.6556981781529655`*^9, 3.6556981921427794`*^9}, {
   3.6556982948038945`*^9, 3.655698557481321*^9}, {3.655699678315644*^9, 
   3.655699738897706*^9}, {3.6556998344635935`*^9, 3.6556999230391273`*^9}, 
   3.6557000626544347`*^9, {3.6557003217076793`*^9, 3.655700321894802*^9}, {
   3.655700363109418*^9, 3.655700387351497*^9}, {3.655700553977483*^9, 
   3.6557006400529833`*^9}, {3.6557019405156116`*^9, 3.65570198225179*^9}, {
   3.655702026611681*^9, 3.6557020774604*^9}, {3.655702109317037*^9, 
   3.655702207435523*^9}, {3.6557029317795043`*^9, 3.655702945233424*^9}, 
   3.655703025090808*^9, {3.6557032274897337`*^9, 3.6557032374783583`*^9}, {
   3.6557033087490997`*^9, 3.6557033506643324`*^9}, {3.655703600551304*^9, 
   3.6557036088227887`*^9}, {3.655703724416805*^9, 3.6557037270275345`*^9}, {
   3.655703987611121*^9, 3.655704020881421*^9}, 3.6557040775944233`*^9, {
   3.6557041770796576`*^9, 3.655704222019523*^9}, {3.6557043018566823`*^9, 
   3.655704310533431*^9}, {3.655704512586339*^9, 3.6557045602052736`*^9}, {
   3.655704599922609*^9, 3.655704787200497*^9}, 3.6557048408321543`*^9, {
   3.6557054229290195`*^9, 3.655705449310876*^9}, {3.655705572968727*^9, 
   3.655705641482052*^9}, {3.655705784805237*^9, 3.655705820506428*^9}, {
   3.6557059294562163`*^9, 3.655705963054497*^9}, {3.655706053313754*^9, 
   3.6557060703300376`*^9}, {3.655706169563487*^9, 3.6557062591294684`*^9}, {
   3.65570643408171*^9, 3.655706479665057*^9}, {3.6557065391865406`*^9, 
   3.655706613407891*^9}, 3.655706698723071*^9, {3.6557068241745653`*^9, 
   3.6557069324151163`*^9}, {3.6557069658923283`*^9, 3.65570698357405*^9}, {
   3.6557070159185185`*^9, 3.6557070599497166`*^9}, {3.6557074593541746`*^9, 
   3.6557074790282173`*^9}, {3.6557075132029033`*^9, 
   3.6557077182293415`*^9}, {3.655707751560758*^9, 3.6557078263912954`*^9}, {
   3.6557078657549734`*^9, 3.6557078866158056`*^9}, {3.655707928641674*^9, 
   3.6557079531729403`*^9}, {3.655707996113932*^9, 3.6557082438392076`*^9}, {
   3.6557082763963175`*^9, 3.6557083452097244`*^9}, {3.6557083991935344`*^9, 
   3.655708415258187*^9}, 3.6557130638903646`*^9, {3.6557134045946617`*^9, 
   3.655713422096797*^9}, 3.655713502906468*^9, 3.6557136937942843`*^9, {
   3.6557138712056756`*^9, 3.6557139071715612`*^9}, {3.655714146493576*^9, 
   3.655714148777092*^9}, {3.6557142405953417`*^9, 3.6557142612921658`*^9}, {
   3.655723481138032*^9, 3.6557234913137856`*^9}, {3.6557243957512074`*^9, 
   3.6557244495939455`*^9}, {3.6557829557579*^9, 3.655782977812488*^9}, {
   3.655783229603535*^9, 3.6557832824465227`*^9}, 3.6557833146428704`*^9, {
   3.6557833563281326`*^9, 3.6557833600956287`*^9}, {3.6557834176678066`*^9, 
   3.655783464743125*^9}, {3.6557835075240116`*^9, 3.655783531054614*^9}, 
   3.655783562753996*^9, 3.6557856638819623`*^9, {3.6557859055178785`*^9, 
   3.655785913404107*^9}, {3.6557864625325174`*^9, 3.655786790290553*^9}, {
   3.655792186798563*^9, 3.655792196334891*^9}, {3.6557923641687546`*^9, 
   3.6557923757214155`*^9}, {3.6557924832182226`*^9, 3.655792489844615*^9}, {
   3.6560191288368254`*^9, 3.656019130662046*^9}, {3.656025877056863*^9, 
   3.656025878296685*^9}, {3.6560286522633276`*^9, 3.6560286557386336`*^9}, {
   3.6560287010821247`*^9, 3.6560287042152033`*^9}},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "32242.13724096887`", "}"}], ",", 
   RowBox[{"{", "30457.64978799031`", "}"}], ",", 
   RowBox[{"{", "30772.443236816285`", "}"}], ",", 
   RowBox[{"{", "27513.966940729675`", "}"}], ",", 
   RowBox[{"{", "28583.65204112044`", "}"}], ",", 
   RowBox[{"{", "27193.392446696387`", "}"}], ",", 
   RowBox[{"{", "29047.45486484162`", "}"}], ",", 
   RowBox[{"{", "32228.390755253607`", "}"}], ",", 
   RowBox[{"{", "13801.53600743371`", "}"}], ",", 
   RowBox[{"{", "63348.84412688511`", "}"}], ",", 
   RowBox[{"{", "18000.636742023267`", "}"}], ",", 
   RowBox[{"{", "4517.547811079116`", "}"}], ",", 
   RowBox[{"{", "60849.86167011689`", "}"}], ",", 
   RowBox[{"{", "11720.726379672053`", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.65578677012318*^9, 3.655786791598426*^9}, 
   3.655792214963426*^9, 3.655792387711988*^9, 3.6557948745357127`*^9, 
   3.656017630906626*^9, 3.656022902320905*^9, 3.6560258955941615`*^9, 
   3.6560261354380245`*^9, 3.6560262018925915`*^9, 3.656026256986873*^9, 
   3.656026350821705*^9, 3.6560402295751824`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "32175.60310856184`", ",", "30456.783227681324`", ",", "30876.15454615231`",
    ",", "27554.995128137776`", ",", "28593.09004688157`", ",", 
   "27152.067638623732`", ",", "29059.675586841597`", ",", 
   "32270.277340327437`", ",", "13885.162829391158`", ",", 
   "63475.74795405029`", ",", "18006.823955252246`", ",", 
   "4463.104773259856`", ",", "60765.42777473053`", ",", 
   "11768.0323264117`"}], "}"}]], "Output",
 CellChangeTimes->{{3.65578677012318*^9, 3.655786791598426*^9}, 
   3.655792214963426*^9, 3.655792387711988*^9, 3.6557948745357127`*^9, 
   3.656017630906626*^9, 3.656022902320905*^9, 3.6560258955941615`*^9, 
   3.6560261354380245`*^9, 3.6560262018925915`*^9, 3.656026256986873*^9, 
   3.656026350821705*^9, 3.6560402295771837`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0.28550447638791754`", "}"}], ",", 
   RowBox[{"{", "0.2608156904141049`", "}"}], ",", 
   RowBox[{"{", "0.22496819202827412`", "}"}], ",", 
   RowBox[{"{", "0.1900633442782482`", "}"}], ",", 
   RowBox[{"{", "0.1965934976740439`", "}"}], ",", 
   RowBox[{"{", "0.20696172221397768`", "}"}], ",", 
   RowBox[{"{", "0.256286240239354`", "}"}], ",", 
   RowBox[{"{", "0.28446437457560836`", "}"}], ",", 
   RowBox[{"{", "0.433100845894146`", "}"}], ",", 
   RowBox[{"{", "0.26475886331222603`", "}"}], ",", 
   RowBox[{"{", "0.1623626533463886`", "}"}], ",", 
   RowBox[{"{", "0.1220310996891312`", "}"}], ",", 
   RowBox[{"{", "0.2718526180527376`", "}"}], ",", 
   RowBox[{"{", "0.22187209952935502`", "}"}], ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.65578677012318*^9, 3.655786791598426*^9}, 
   3.655792214963426*^9, 3.655792387711988*^9, 3.6557948745357127`*^9, 
   3.656017630906626*^9, 3.656022902320905*^9, 3.6560258955941615`*^9, 
   3.6560261354380245`*^9, 3.6560262018925915`*^9, 3.656026256986873*^9, 
   3.656026350821705*^9, 3.6560402295791855`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0.36156878753359445`", "}"}], ",", 
   RowBox[{"{", "0.3660340715121604`", "}"}], ",", 
   RowBox[{"{", "0.3712883920337978`", "}"}], ",", 
   RowBox[{"{", "0.3664143018103092`", "}"}], ",", 
   RowBox[{"{", "0.35997061178277046`", "}"}], ",", 
   RowBox[{"{", "0.35286400029575066`", "}"}], ",", 
   RowBox[{"{", "0.3542936510769916`", "}"}], ",", 
   RowBox[{"{", "0.3557540307786282`", "}"}], ",", 
   RowBox[{"{", "0.35335038274003683`", "}"}], ",", 
   RowBox[{"{", "0.36938611518909453`", "}"}], ",", 
   RowBox[{"{", "0.3673476502974793`", "}"}], ",", 
   RowBox[{"{", "0.3085370495521048`", "}"}], ",", 
   RowBox[{"{", "0.36310077530878393`", "}"}], ",", 
   RowBox[{"{", "0.37010030204576244`", "}"}], ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.65578677012318*^9, 3.655786791598426*^9}, 
   3.655792214963426*^9, 3.655792387711988*^9, 3.6557948745357127`*^9, 
   3.656017630906626*^9, 3.656022902320905*^9, 3.6560258955941615`*^9, 
   3.6560261354380245`*^9, 3.6560262018925915`*^9, 3.656026256986873*^9, 
   3.656026350821705*^9, 3.656040229582187*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.28558615592926445`", ",", "0.2604494181011336`", ",", 
   "0.22432354395535498`", ",", "0.18996596507685748`", ",", 
   "0.1965845260409261`", ",", "0.2073340675783363`", ",", 
   "0.2566645597601237`", ",", "0.2849137088375332`", ",", 
   "0.4339241447529599`", ",", "0.2639664068707827`", ",", 
   "0.16294967288203221`", ",", "0.12369784903433317`", ",", 
   "0.27167577371170304`", ",", "0.22112327394179881`", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.65578677012318*^9, 3.655786791598426*^9}, 
   3.655792214963426*^9, 3.655792387711988*^9, 3.6557948745357127`*^9, 
   3.656017630906626*^9, 3.656022902320905*^9, 3.6560258955941615`*^9, 
   3.6560261354380245`*^9, 3.6560262018925915`*^9, 3.656026256986873*^9, 
   3.656026350821705*^9, 3.6560402295841885`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.3615747058914076`", ",", "0.3661440840489517`", ",", 
   "0.3714499794032691`", ",", "0.3665770671676682`", ",", 
   "0.3600593390445129`", ",", "0.3528142880816996`", ",", 
   "0.3542425859373388`", ",", "0.3557217047215151`", ",", 
   "0.3532857028292162`", ",", "0.36953573001150025`", ",", 
   "0.36752437859243203`", ",", "0.3076046754422659`", ",", 
   "0.3631537066019719`", ",", "0.37027529740039716`", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.65578677012318*^9, 3.655786791598426*^9}, 
   3.655792214963426*^9, 3.655792387711988*^9, 3.6557948745357127`*^9, 
   3.656017630906626*^9, 3.656022902320905*^9, 3.6560258955941615`*^9, 
   3.6560261354380245`*^9, 3.6560262018925915`*^9, 3.656026256986873*^9, 
   3.656026350821705*^9, 3.6560402295861893`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "%", " ", "Check", " ", "tolorence", " ", "for", " ", "reference", " ", 
    "illuminant"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"DC", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"uk", "-", "ur"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vk", "-", "vr"}], ")"}], "^", "2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"%", " ", "Apply", " ", "adaptive", " ", 
     RowBox[{"(", "perceived", ")"}], " ", "color", " ", 
     RowBox[{"shift", "."}]}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"ck", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "-", "uk", "-", 
        RowBox[{"10", "*", "vk"}]}], ")"}], "/", "vk"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dk", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.708", "*", "vk"}], "+", "0.404", "-", 
        RowBox[{"1.481", "*", "uk"}]}], ")"}], "/", "vk"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cr", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "-", "ur", "-", 
        RowBox[{"10", "*", "vr"}]}], ")"}], "/", "vr"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dr", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.708", "*", "vr"}], "+", "0.404", "-", 
        RowBox[{"1.481", "*", "ur"}]}], ")"}], "/", "vr"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", "15"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cki", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "-", 
          RowBox[{"uki", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"10", "*", 
           RowBox[{"vki", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"vki", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\n", "   ", 
      RowBox[{"dki", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.708", "*", 
           RowBox[{"vki", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "+", "0.404", "-", 
          RowBox[{"1.481", "*", 
           RowBox[{"uki", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"vki", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"ukip", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"10.872", "+", 
          RowBox[{"0.404", "*", 
           RowBox[{"cr", "/", "ck"}], "*", "cki"}], "-", 
          RowBox[{"4", "*", 
           RowBox[{"dr", "/", "dk"}], "*", "dki"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"16.518", "+", 
          RowBox[{"1.481", "*", 
           RowBox[{"cr", "/", "ck"}], "*", "cki"}], "-", 
          RowBox[{
           RowBox[{"dr", "/", "dk"}], "*", "dki"}]}], ")"}]}]}], ";", "\n", 
      "   ", 
      RowBox[{
       RowBox[{"vkip", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"5.520", "/", 
        RowBox[{"(", 
         RowBox[{"16.518", "+", 
          RowBox[{"1.481", "*", 
           RowBox[{"cr", "/", "ck"}], "*", "cki"}], "-", 
          RowBox[{
           RowBox[{"dr", "/", "dk"}], "*", "dki"}]}], ")"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "%", " ", "Transformation", " ", "into", " ", "1964", " ", "Uniform", " ",
      "space", " ", 
     RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", "15"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Wstarr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"25", "*", 
         RowBox[{
          RowBox[{"Yri", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", "0.333333"}]}], "-", "17"}]}],
       ";", "\n", "   ", 
      RowBox[{
       RowBox[{"Ustarr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstarr", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uri", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "ur"}], ")"}]}]}], ";", "\n", 
      "   ", 
      RowBox[{
       RowBox[{"Vstarr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstarr", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vri", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "vr"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", "   ", 
      RowBox[{
       RowBox[{"Wstark", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"25", "*", 
         RowBox[{
          RowBox[{"Yki", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", "0.333333"}]}], "-", "17"}]}],
       ";", "\n", "   ", 
      RowBox[{
       RowBox[{"Ustark", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstark", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ukip", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "ur"}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "%", " ", "after", " ", "applying", " ", "the", " ", "adaptive", " ", 
         "color", " ", "shift"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "k"}], "=", "ur"}]}], "*)"}], "\n", "   ", 
      RowBox[{
       RowBox[{"Vstark", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstark", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vkip", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "vr"}], ")"}]}]}], ";"}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "%", " ", "after", " ", "applying", " ", "the", " ", "adaptive", " ", 
       "color", " ", "shift"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "'"}], "k"}], "=", "vr"}]}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "%", " ", "Determination", " ", "of", " ", "resultant", " ", "color", 
      " ", "shift"}], ",", 
     RowBox[{"delta", " ", 
      RowBox[{"E", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deltaE", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"R", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", "15"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"deltaE", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Ustarr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"Ustark", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Vstarr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"Vstark", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Wstarr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"Wstark", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}]}], "]"}]}], 
      ";", "\n", "   ", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"100", "-", 
        RowBox[{"4.6", "*", 
         RowBox[{"deltaE", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "R", "\[IndentingNewLine]", 
   RowBox[{"Ra", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"R", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "8"}], "]"}], "]"}], "]"}], "/", "8"}], "//", 
     "Total"}]}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.6554581676025534`*^9, {3.6554585286681614`*^9, 3.6554585545508566`*^9}, {
   3.6554587717915974`*^9, 3.655458796164322*^9}, {3.6554592254434066`*^9, 
   3.655459256832245*^9}, {3.6554593039251165`*^9, 3.655459317210935*^9}, {
   3.6554593472694187`*^9, 3.655459417917452*^9}, {3.6554596266826677`*^9, 
   3.655459656552495*^9}, {3.655459946388235*^9, 3.655459997829745*^9}, {
   3.655460053796756*^9, 3.6554600642086678`*^9}, {3.6554622108989553`*^9, 
   3.6554622620253944`*^9}, {3.65546238746297*^9, 3.6554624565049744`*^9}, {
   3.6554631106186514`*^9, 3.6554631286146*^9}, {3.6556965746409984`*^9, 
   3.6556966175054207`*^9}, 3.6556968383971167`*^9, {3.6556968863004026`*^9, 
   3.6556969584543962`*^9}, {3.655697075515136*^9, 3.655697237049828*^9}, {
   3.655697284360781*^9, 3.655697286958501*^9}, {3.6556973409468946`*^9, 
   3.6556973412100687`*^9}, 3.6556976830920553`*^9, {3.655697746219908*^9, 
   3.655697800902129*^9}, {3.6556981781529655`*^9, 3.6556981921427794`*^9}, {
   3.6556982948038945`*^9, 3.655698557481321*^9}, {3.655699678315644*^9, 
   3.655699738897706*^9}, {3.6556998344635935`*^9, 3.6556999230391273`*^9}, 
   3.6557000626544347`*^9, {3.6557003217076793`*^9, 3.655700321894802*^9}, {
   3.655700363109418*^9, 3.655700387351497*^9}, {3.655700553977483*^9, 
   3.6557006400529833`*^9}, {3.6557019405156116`*^9, 3.65570198225179*^9}, {
   3.655702026611681*^9, 3.6557020774604*^9}, {3.655702109317037*^9, 
   3.655702207435523*^9}, {3.6557029317795043`*^9, 3.655702945233424*^9}, 
   3.655703025090808*^9, {3.6557032274897337`*^9, 3.6557032374783583`*^9}, {
   3.6557033087490997`*^9, 3.6557033506643324`*^9}, {3.655703600551304*^9, 
   3.6557036088227887`*^9}, {3.655703724416805*^9, 3.6557037270275345`*^9}, {
   3.655703987611121*^9, 3.655704020881421*^9}, 3.6557040775944233`*^9, {
   3.6557041770796576`*^9, 3.655704222019523*^9}, {3.6557043018566823`*^9, 
   3.655704310533431*^9}, {3.655704512586339*^9, 3.6557045602052736`*^9}, {
   3.655704599922609*^9, 3.655704787200497*^9}, 3.6557048408321543`*^9, {
   3.6557054229290195`*^9, 3.655705449310876*^9}, {3.655705572968727*^9, 
   3.655705641482052*^9}, {3.655705784805237*^9, 3.655705820506428*^9}, {
   3.6557059294562163`*^9, 3.655705963054497*^9}, {3.655706053313754*^9, 
   3.6557060703300376`*^9}, {3.655706169563487*^9, 3.6557062591294684`*^9}, {
   3.65570643408171*^9, 3.655706479665057*^9}, {3.6557065391865406`*^9, 
   3.655706613407891*^9}, 3.655706698723071*^9, {3.6557068241745653`*^9, 
   3.6557069324151163`*^9}, {3.6557069658923283`*^9, 3.65570698357405*^9}, {
   3.6557070159185185`*^9, 3.6557070599497166`*^9}, {3.6557074593541746`*^9, 
   3.6557074790282173`*^9}, {3.6557075132029033`*^9, 
   3.6557077182293415`*^9}, {3.655707751560758*^9, 3.6557078263912954`*^9}, {
   3.6557078657549734`*^9, 3.6557078866158056`*^9}, {3.655707928641674*^9, 
   3.6557079531729403`*^9}, {3.655707996113932*^9, 3.6557082438392076`*^9}, {
   3.6557082763963175`*^9, 3.6557083452097244`*^9}, {3.6557083991935344`*^9, 
   3.655708415258187*^9}, 3.6557130638903646`*^9, {3.6557134045946617`*^9, 
   3.655713422096797*^9}, 3.655713502906468*^9, 3.6557136937942843`*^9, {
   3.6557138712056756`*^9, 3.6557139071715612`*^9}, {3.655714146493576*^9, 
   3.655714148777092*^9}, {3.6557142405953417`*^9, 3.6557142612921658`*^9}, {
   3.655723481138032*^9, 3.6557234913137856`*^9}, {3.6557243957512074`*^9, 
   3.6557244495939455`*^9}, {3.6557829557579*^9, 3.655782977812488*^9}, {
   3.655783229603535*^9, 3.6557832824465227`*^9}, 3.6557833146428704`*^9, {
   3.6557833563281326`*^9, 3.6557833600956287`*^9}, {3.6557834176678066`*^9, 
   3.655783464743125*^9}, {3.6557835075240116`*^9, 3.655783531054614*^9}, 
   3.655783562753996*^9, 3.6557856638819623`*^9, {3.6557859055178785`*^9, 
   3.655785913404107*^9}, {3.6557864625325174`*^9, 3.6557866716565027`*^9}, {
   3.6557868482549925`*^9, 3.655786857488115*^9}, 3.655787134505972*^9},
 NumberMarks->False],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "91.30317006465084`", "}"}], ",", 
   RowBox[{"{", "89.02734972187517`", "}"}], ",", 
   RowBox[{"{", "75.48443248577058`", "}"}], ",", 
   RowBox[{"{", "94.58400875849874`", "}"}], ",", 
   RowBox[{"{", "92.97641045206403`", "}"}], ",", 
   RowBox[{"{", "74.83227957913809`", "}"}], ",", 
   RowBox[{"{", "76.08370861275988`", "}"}], ",", 
   RowBox[{"{", "72.03409405437985`", "}"}], ",", 
   RowBox[{"{", "54.39755999559623`", "}"}], ",", 
   RowBox[{"{", "61.66528570887333`", "}"}], ",", 
   RowBox[{"{", "70.475407916676`", "}"}], ",", 
   RowBox[{"{", "38.13212541504869`", "}"}], ",", 
   RowBox[{"{", "95.91367237167054`", "}"}], ",", 
   RowBox[{"{", "78.71128537883295`", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.655783288700675*^9, 3.6557835350582714`*^9, 3.6557869103116713`*^9, {
   3.6557922220901537`*^9, 3.655792225905681*^9}, 3.655792387756016*^9, 
   3.6557948745777407`*^9, 3.656017630935644*^9, 3.656022902354928*^9, 
   3.656025895638191*^9, 3.6560261354710464`*^9, 3.656026201926611*^9, 
   3.656026257022896*^9, 3.656026350861729*^9, 3.656040229614207*^9}],

Cell[BoxData["83.29068171614213`"], "Output",
 CellChangeTimes->{
  3.655783288700675*^9, 3.6557835350582714`*^9, 3.6557869103116713`*^9, {
   3.6557922220901537`*^9, 3.655792225905681*^9}, 3.655792387756016*^9, 
   3.6557948745777407`*^9, 3.656017630935644*^9, 3.656022902354928*^9, 
   3.656025895638191*^9, 3.6560261354710464`*^9, 3.656026201926611*^9, 
   3.656026257022896*^9, 3.656026350861729*^9, 3.656040229616208*^9}]
}, Open  ]]
},
WindowSize->{1350, 631},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (2013\:5e742\:670813\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 12129, 315, 632, "Input"],
Cell[12689, 337, 12417, 319, 672, "Input"],
Cell[25109, 658, 12033, 326, 672, "Input"],
Cell[37145, 986, 11989, 301, 772, "Input"],
Cell[49137, 1289, 5486, 144, 272, "Input"],
Cell[54626, 1435, 5888, 149, 332, "Input"],
Cell[60517, 1586, 5743, 147, 312, "Input"],
Cell[CellGroupData[{
Cell[66285, 1737, 7854, 174, 352, "Input"],
Cell[74142, 1913, 3645, 64, 320, "Output"],
Cell[77790, 1979, 2493, 47, 72, "Output"]
}, Open  ]],
Cell[80298, 2029, 94, 1, 31, "Input"],
Cell[80395, 2032, 14175, 369, 1098, "Input"],
Cell[CellGroupData[{
Cell[94595, 2405, 8650, 186, 472, "Input"],
Cell[103248, 2593, 1016, 15, 31, "Output"],
Cell[104267, 2610, 1017, 15, 31, "Output"],
Cell[105287, 2627, 1016, 15, 31, "Output"],
Cell[106306, 2644, 1018, 15, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107361, 2664, 7858, 166, 272, "Input"],
Cell[115222, 2832, 1600, 23, 31, "Output"]
}, Open  ]],
Cell[116837, 2858, 2870, 72, 212, "Input"],
Cell[119710, 2932, 27096, 552, 1132, "Input"],
Cell[146809, 3486, 7289, 170, 332, "Input"],
Cell[CellGroupData[{
Cell[154123, 3660, 11723, 246, 532, "Input"],
Cell[165849, 3908, 2936, 47, 72, "Output"],
Cell[168788, 3957, 4643, 100, 112, "Output"],
Cell[173434, 4059, 4332, 76, 380, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177803, 4140, 9381, 202, 472, "Input"],
Cell[187187, 4344, 348, 5, 31, "Output"],
Cell[187538, 4351, 347, 5, 31, "Output"],
Cell[187888, 4358, 335, 5, 31, "Output"],
Cell[188226, 4365, 350, 5, 31, "Output"],
Cell[188579, 4372, 350, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188966, 4382, 5596, 102, 192, "Input"],
Cell[194565, 4486, 388, 6, 31, "Output"],
Cell[194956, 4494, 390, 6, 31, "Output"],
Cell[195349, 4502, 389, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195775, 4513, 1011, 28, 112, "Input"],
Cell[196789, 4543, 339, 6, 31, "Output"],
Cell[197131, 4551, 259, 3, 23, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197427, 4559, 8499, 175, 452, "Input"],
Cell[205929, 4736, 1106, 21, 31, "Output"],
Cell[207038, 4759, 797, 14, 31, "Output"],
Cell[207838, 4775, 1360, 24, 52, "Output"],
Cell[209201, 4801, 1361, 24, 52, "Output"],
Cell[210565, 4827, 1057, 18, 52, "Output"],
Cell[211625, 4847, 1053, 18, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212715, 4870, 13015, 321, 852, "Input"],
Cell[225733, 5193, 1146, 22, 31, "Output"],
Cell[226882, 5217, 426, 6, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
