(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     94394,       2200]
NotebookOptionsPosition[     93355,       2160]
NotebookOutlinePosition[     93709,       2176]
CellTagsIndexPosition[     93666,       2173]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"spdDataFromXls", "=", 
   RowBox[{
    RowBox[{
    "Import", "[", 
     "\"\<D:\\\\smartLighting\\\\smartLighting\\\\wLED3583Spd.xls\>\"", "]"}],
     "//", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spdDataWaveLength", "=", 
   RowBox[{"spdDataFromXls", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"spdData", "=", 
    RowBox[{"spdDataFromXls", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "cie1931Table", "=", 
    "\"\<1:eJyFmnk01N//\
xyWVLMUHrRSlUloQpWJeFy2K7JWK7CItlH2dYTC0WCrJTkJZI0Ipkp3sS0r2fRuUSPjp435+\
58z88fX+o3M6j05m3s/7uPf1el0C+rfUjBgZGBi4Fv5gYsBP7m3E8L+eqiV42xKcugRnuPO/\
OccSnH8JLrIER0twlSW47hLcfAlOXIL7LsEjluApS/DcJXjVErxtCU5dgjNY/m/\
OsQTnX4KLLMHRElxlCa67BDdfghOX4L5L8IgleMoSPHcJXrUEb1uCU5fgDFb/\
m3MswfmX4CJLcLQEV1mC6y7BzZfgxCW47xI8YgmesgTPXYJXLcHbluDUJTiD9f/mHEtw/\
iW4yBIcLcFVluC6S3DzJTjRGiXd6CZmrhQA7uixj003qggce8obzn2Tg3+\
5rzW69CxXpIpvOxxJMb3of6OG4K+fNx6hfHKRR1ijXSoS6qdtd0D2aMHRrYl1BGOBf16S/\
jm9yFOskdZFkw/btwhBdQx1kke8kcBmPuCrtF9xkedao+PRzoo664Uhx0XMkJ2lmbBa0/\
rYlQTlRV5ljXauC62eMdsPH73FwkMOtRBujVHDlpepLvI2a9RWlXzszDpRCBkmRafotxEeNQxJuc6r\
L3KqNXprp+\
w9I34Q7suxOw7rdxBSZdW8o53OL3IGG8RYwJZyKEACVPyefMuK6iK8Wp6lIX3m4iLnsEFc4ycp/\
ARJGBvRmy4R6iXY9Waabr2mtcj5bdBZpD3SInIM4qX3R9XN9BPG3vYH8HXoLHIRG6R/r/\
jWGTMCbFtlFiexdZjARSzcKtCot8iRDVr9qHbcb5kMMPZsEuRXoRKuqlfPy/\
4wWOQqNkiOeG5ijEMO2KQdeZTPjBPMDspsVNMzXuS6NihXpqSCZHsCLpBvs09TfhC4pdtXCh82XeTm\
NihJ+VHrrKI8FKSmto2v+0XYGF8xH//g+\
iIn2iCVPhKEpyiAzXLu3EbW34RtJZqt6vLmOH8b9NV4wnN1sDKUzTdkHL86S9h+\
xV3U6ultnL8NKg3Q8LpHVYULZ4flV1IYoChSaqaT3wrnb4OKlZ571wtrAGvnD2OSNSM8twj4U/\
LJBudvgy6zplV9Nj0P5KyWMqfbTKAR//Knipk9zt8GXVvL38ceognnK8V71lquhHfF/Kpnljvh/\
G2QZ9Uuuet9l0B0S5peQSAzxJReD3qb5YLzt0FCNxJG33lqQ+\
qGR0LSbKwwPXxXid2UhPO3RVu6rNuvXtQFa1GuHet+s4N//\
KvXI6fccP626FvE5OVjqvpwfzg94lchBxzTPpByLNgd52+LnCzYrNYVGMKNIAMO6uQ/\
MLZN28mDRMH52yKfEwKmR1OvQoXaWU/h+zwwtc+gKfjXXZy/LbIMvsh1gcUMbq/88uOI2wY4V/\
cyNmLIB+dvizgOTh/b/OEmvHqmpJJQsxlyv4Qcad7lj/O3RUxWpc8261mAKd+\
5sxxWWyFpI9Vw1vMRzt8WXWxfz5FNugMa4fxvlV8JQKH4j7LD7E9w/gvf76VXy886K/\
BJW6Vz9Ot2qC+wel78+SnO3xa5zYjKb3OyhVOjpwKOKe8E53mhjss/Q3D+tmhg79cq/\
xAH0LEu6TopuBuyT5xaW6kRgfO3RQrFq6SDz7lA1nXLz8oWeyHd6+\
EMn3cUzt8W8bJEG0sPkcBaPOKgyX4RaKj2rlE7/\
Bznb4syfIYcV3iToXmTWND1m2LAdizxgolaHM7fFpXnvgmXNfSEz22JM22t4jCfpF7/ND0e52+\
LArNi5Tkve4PIXEsp1fQwlH2lwrZjyTh/\
O9RTxprio3QfrM2eshVNHIGiNzMnwq68wvnbIVddRqsabl947Vdyx+O6FNgSjLm9ONNw/\
nbIUZtFcqOPH9Q+OhyykgEgeu6iDW/da5y/Hao7+ea8/\
rGH8IfYKi07heDQgy1tBTUZOH87VP8lQu8X4TGYT2w/uyVXFloiRgbGj2Th/\
O3QHaLugy0fnsCYSSclfeo4KAwwiXMeeofzt0O8YCW0qSEIKO9cc9nen4JZrx0orucDzt8OqazUNVZ\
0CYM8Ne3cMjYFOFAVvVx++0ecvx066PJmZaNmJAgQy9NXNCpBjENo3ZPnn3D+dqh5l+\
3Y5tRnEFDO3WvsqQoJrvpWPy2LcP526DTnxvNjJ2Pg4LRx8OZadVilE6jIc68U52+\
HpLIUPCd4XkBt6g6ularnYWfqNbPw/gqcvx1yGOVePyScAH63Ky3MuS+CaNQz1ojPVTh/\
O3Qif8Op4KfJQDRfzvXhgBZIySTIB7TU4Pzt0FCkU0Lbm1cgvpMI59J14M+\
hT7YVwvU4fzt0FImc8mlNA+1Yv4DSr3rwXAlx6eU34vzt0cvr/\
nMdshkg8nImYx2vIRSyHnQWftaM87dHVIFzNf5tmbCJYnTQM9oYmLX5Lu8pbcH52yODvfv73XLfgo3\
PNgGitykINErNno9sw/nbo+0TN4yfDryHqDUej406r4O5yit+t7sdOH979Pt4mKD2wTz482Ks5qy+\
OVDdSzTy4rpw/\
vYot0nUUHhLPjT5DizjDr8NPx5Pvque7cH52yN1roOvkoULYGdixjWqgBVIHZnuTHDux/\
nbI2ct605JhSI4Pad5y6LNBoKTh+VV1g/h/O0RO29VDc/1EnjuVmexo8oeOiWp17LSRnD+9qgsi/\
vCY6cyCJfaWxfU4wTsTsbz4+FUnL89OnzyT91H6wqwfFcXGOdDhB8WxXp3m8Zw/\
gt8p33lYc1KYP1sKPSO4AqdaI7CwzSB87dHIWG8Lz/7VAH/\
brlqrmVkCL6S031C4AfO3x5xN6lNKhpVg05ttO+xRneQPdtZUbX/J87fHlUa1/\
deE66BthDO5zl5nrD490mcvz3awFv683JbDUwwxylPfvCC06O5z5l5fuH8HdC2+\
ywh191qoSvIo1qm+i6ICu7iejOAOYcD6gv+or6epw4qtkmY7pm8D1nnzN5VJkzh/\
B2Q6R77gIbHdWB54FpD6HpfkPtj0hJ/eRrn74AiNh1oEVxZD6Wza06QCH5gaBXfG/0Lc+\
SADJdlzjEa10Og6E47d3N/SJz/rBpF/I3zd0C1cs6nwtLrwTqxYehnwkMgqZvWT01iruuASL1uLGk/\
68HRuOdc69gjKDnKq/388gzO3wEJa7N++\
rOzAXJVN19Tkg4AdIFT8Hky5kQHVG1pLSZ5pgEuGR5rVb7/\
BMyMPh74OYG5rwMarFOQbdJpgA6BxMTktkB4v6LYQ3D3H5y/AxLpGHtWZdIABK8pXv8jQWBQ7+\
Cuq4J5igPKEGEdDjFuAK3mP8tWBQdD9s7Tjg/NMM91QNkf7L+9udQA46MH9/\
Myh4KAYvDbWEfMqxzQ22HZO6EnG0CsJ2lHl1sYTD5peejpjnmbAzp+\
enjg954GCIvK5JteFQHk4fIXqz0xpzqgZ2Tl3UbMDaAhoCku0BABRVHHYxpJmDM4IjUWHSaxtnrwSG\
v0z02IBM4oAUqgDeYcjujwWoucN2n18LP99tZ996LALbE4bMIUc35H9Mz/\
6LKz5Hr4Ou187Z3lM2CJGlnuewlzEUe0+sHO27zq9WCoxKhXbBwNBoU7mkrOYI4cUY1z+\
mvDrfWg1b2aHKr/HB50a/8kHsFcxRGJi5y9/rS3DgSdLp1wMYkBNmZmmShBzHUdkU/TQ6N9L+\
vgUWBNboptLGjaaW/axIK5uSMisysnPzKqg99/P97DOBiX+WvIf/k7osvtsW//\
bKgDJbdvgt5ZL6Aos6Mj7t1/+\
TsiPydfo7xPtVDI0evcPPASpPqKiVEUzCMckYGE4nZe01qIOXHM2nRnAihExTmRFTBPcUSRfu/\
nT6ysBQnknXHULBF2hWkqcq7APNcRvVIxC7IJqYHMLe6DqplJIPJ211rWdLy+\
qxzRy8Rtw757a0AkuaogaWUKNHh/ZT+lhXmbI2IOLUyoSK8GfT1f9lUZKZD20DjQZRr7RXVEh/\
5wLZuQqIZAjksJ4mavIPtPR6KSF+YMTsj7dd9U/ssqOHbCLuHorlTgqtnkpsSMOYcTuvls2bsV/\
1SB/fO9cryDqbBeXuXPhjv/+e+Evhn0y62v+wwdZcc51d6kgcdV9Q+8RXj/EHFCwtvsQvPNKuBg5q/\
s8/deQ4nkydRTzJgjJ1Q2H6T/6UcZ8FV+nD5glg5KHTmvx6Xw/\
qXihAa7bYLKbUtBxWq7Z6dGBrh6K8dYm+H9T9cJtQvZWT1YVgKOa5/\
w2px5A9UXfI33BuH909wJsUvnJCo/KgJPRk5psmIm7LTSVncox/\
sv0QlZuBILAw4UglZj0B3Oy1kgrhTGrrEMc18nZG5olzpZ8wk4pm3FTltnQ5XyLh9tyXGcvxMaYgvt\
Y3LOB/PJHCn1sLewvNxxFVj8t/87IV5HPbFzIh/h+4K1l2rfAfNCNRgej8+PXCfk85DP+\
uhgLtR8Opb7cN17yNeRdLSpGsX5O6HrzQ6xmbofIM1iTV/\
A1Q9w2WNEPl4Fn09tTqg35rZL0Pw7qK1Ye4NTPxd4FqqJ1034fKM6IY0wb6PjadkwGFl0ZIY7Dz4P1\
LZdNx3E+TsjQRcR6jeHTEhLfy9vUpYHB34GDicvH8D5O6PcEHETuYsZUKSPgvPIH0H0H99urrg+\
nL8zKtzKu4Vy9jVcjjs5/VA2H6KfrAoPudCL83dGZmzvL27QSgXnyeK7Yys/QfDGqOQCLnx+\
I2fEe3rusB4lBfIcZudHaj/B40m9Dazf/zv/nZGfLSk+PD4Rv7cCOHV7em3/m06cvzOanEuLjr//\
Evqj1U5t8ymE0CrfgFtRuL4wd0buCmF8h1JjYZuUxHidcxFMM5+8xRjajvN3Rgw3g65mcz6H+\
td3TWMciqFO4Nvq4Bhcv/g6o13WjHVp0VFQMcB309OjBLi72K4ZOrbi/\
J3RwuFxJdQgAs7NWEoZR5RCjkTKOdcCXB+lOKPe0pmH6gEhMFPUm/\
24tAz27LvhmrXrG87fGbGnecgoZwXCltkDjVErKoBgVuyVG4XrrypnpC1RyTm9/\
zF8jNmtfU71Mzi5fE/WlviC81/gV26p8k76QdDvA4XWiZXwQnPQXvM7ru+ozmiHFWMQ8+\
YH0P8meXnvvSpY3G8acP4uiM/HseZUHwXetl4ITj9TDbqtEybKN3H9yLHAH0s6D6iQgWPt+\
lubOGvgdzwna6FaHc7fBcXJDHzhVyVCcxGL8+aOGqh918nNd7oW5++C3iy3dRUrtQPxX77UnA+\
1ILvBa1OACq5fkQveXyzBrn+nKHNCHYR84k+5bVKN83dB5Z0HVZTGbsIJy43yenH10KGy+\
qmVL66PdV1QTqJ5VDG/\
CWz82MC5N60B5sXnp4vuVeL8XdD5T85eF1oM4Nvy90N9JY1gNOH6lIH9M87fBbnEPHzRtNDf6lorb1\
k30AShVo3btwSV4/xd0F9797wwgHtn/jYezbDtuu3CVliG83dB31V3P5H9dRUyiveKukt/hRgxB5/+\
DyU4fxe0SeCczZcbt+AIvzrF79Y3CFv7d8BUjPN3QVSeOcohMSvY5H/6D4prgWVXP4d/pRbi/\
F3Q3Bx/nfRTR/j1KITLoe87FIa8sjN+WIDzd0GfKTXf21jdwOXv8bahDbq4+\
Uq6AfcvVBdUov96rK6dAsqcAVe589pgnWMXv9gk7n8YiEjnGx/5ZLUPrB9nvhl9vR3ErhZdUMzIW+\
TMRHTxZ4T0wNhD0H0oMSCwqQOa6w4Utbvm4vVBRCTJSS8fv0Do1R26Y1bcAa+\
0fTulc94v8g1EpMUvM2ZQHgoLDjfpWHfCyUeTK3UCcf/GT0S/7muQUW0kHJWQ0n+\
6vQt0Fspf0tPsRS5ERD1MVSFp7M8hNqtMXKWyCz5XHBA9+CETry8iKnsy99HZLw4CVK2PV9p0g0N/\
kOfm1W8WuSQRLduRWvH4UgJk8Jx319vcA+8cdNo6rNPx+iMiCYO/FWAKPn97gPPy5IwIM+\
5f5Yko5IvY6oTzqXCv/AabwtleiHlXs7o2JxWvTyI63Kult/\
fpazhiW2bf0NwL6bI71bse4f5Zk4gO7tJ8JTadAZwpr2LY9ftAe+\
Ffkz1T8PolIg81fs3fVllgzCjOwNLVB6ZRlg9ituL+3GTh+0N06/s17+DurNGvLr1+eP74jF+\
rciJe30TEE8J640z+e2hpsLjA8q0fNl7Larr4FPf/tkQUy/RJUKs4F/\
RTGe93qg7Aen7tJOuZF3j9ExFxJSLxHvkIJuQb9ivzF3jZn3dsd/B8gUJESusS/\
Z1f5YO0zCrG1QcGIcBZJ3n8Twz2g4hKrN+HbzpQAH+rfNLjQSD/\
Y9w89xjPLwKJ6NBwjrpWSiFMevJyyk4OwtugzRcUj0Zjf4gop3C/\
ao5EMRRzFr4MUR2Ci6kZZkf78XwkjojUtH5LDS74lNKaKdoROwQV+++lekRHYr+\
IiNDivcZfuQzenr/HZDg9BB7d1IKRG3j+\
kklE1lEl13S6y2FPnuebOyeHoefC34lCGPaPiM6syA5WJH2Gypfu8lI+w+DSFrPOURfPd4qJ6C1/\
kYM9ZxXcEv9qnlY7DIYFPxKjlYOwn0SU4X3RG7qrwCTJ1qeJawQC/1l7+\
sXlwEXeRETl4aWfmN9Vg7LSnGS88ggIK1gGXCQHYH+JKMIrpb3/cQ1kn2ZjFPYcgeOmtxZaYDy/\
6iMi9TR9rh+3ayF+024Gs+wReCSs90/tnofYbyIKyy9cyateB8ISDRcp/SNwdp/\
jtGWs3yKfIqKT34VMTh+qhyMBvLx+3KMwZDLz9QHBF/tPQmt21Xca8DYAM3+618Njo7Asovyw1/\
f72H8Sep+3fqf6ikb4e4qEXRkF9QCBB1YWeH7HQUJNt/mezlIbIfXDKc1kp1FwSa+/\
TRH3wv6T0Mv7MxG2rU3wTtyHfSRwFJjrW2LNd3hi/\
0noutnvqImqL8A5vNE2OmUUTJmXNTHJ4PmiEAl1BzE+DS1ohuhv2+p5C0bhDc9s+UYynk+\
KkBDrOumY6JyvEPzt0ZPIhlHYfFTrD3kQzzclSWjq7MqhtVnf4Jq0GNua7lF4zfru9EdLIvafhMo+\
BFxIetMC8fsDmsyoo7DG2m63sJQz9p+E1u+\
Zv3Ql6ztsUY3Mzpoahfwii7FlZQ7YfxK6raBiMpfTCszk3tHR2VGgcF9pYfO3w/6TUNSxfV0Z+\
rieYKBCtrhbkPJ9PP/VJSH9e88qynvbIOGXkX3t3Cjs2VMtfzQLz49NSAhm2bj5brbDjbxfz87+\
HoWfN3jZqjgtsf8ktCvG+NqNn+\
2ATONU5cdHQenJNVZLfzyftiUhlvBENzenDugLlN4U2DMKheyrd3sdssD+k3B/\
3gmNz8ylWRpH4buF94Ou8VvYfxIqPMS0batPJ6QUJ2/Vzx8FXxnJFOOkG9h/\
EhrPsXqtu6ELmOKUEqbiR2E21H/\
DixAz7D8J5RgFCrZFdkGkysumCd9RuPT1lvzcWzyfjyChyWIRyUfC3XAvo7LS7vYotJyNyc1kMcH+\
k1Dk1bSBO+ndMJ/qMJ6iMgp2A8G2ezzx/D+FhDrTtU4ZQw+Ib9N/9Ep4FK6xkZMe7DPC/\
pNQ6bvffAdKeqD64Cq1O8tHQb929Crfb3y/kEtC6xLKR33UemH4Ozo80DgCX8Z3JO8e1Mf+\
k5BnGifhzNdeaJx/5M7yYgSWf/jDtHIe319UkdB3xtXeWw36gEPzyOti6xHg+\
bdQwLyJhCZyqm7U9vcBe7KLmIDMCCgN9O5y9tTF/pPQzrzcDYdu9cNu5Wt2B5hHoGJIqebCIL4/\
6SMhpuqRwc0T/RC7Jm6Yp3wY1kx4KxpNXsH+k9CmVHP5i1YDUJLfOzF5bxjEJFvybu7GfGrh/Qpp+\
Xz8OQBVx5uoP84Mg3+Zi/wHJ228Hl3Rt9D0r/stB2HuqtBpsZXDcPgOR64sFd/\
vMLuikrjGGnnqIOz++KQ2+f0QlI0le3+\
zxZzDFUnFnCZHmg6BxamRcG3LIfCv1mJUWI35Blc01CgrUdo6BJODEznCu4ZA5bv4TYWHl7H/\
rijf8KWuhtowXn+DUNx5jieYGXMhVzRR4t0+kDsMFf+oN824DULe8jFBA71L2H9XZMvVeO+\
q8AiIOiULSO4fhDCv8HS/SHx/JemKzAjqGlF+I2AbOFkxWz8AI8oT4S7lmth/V/Tv9jqxsG/\
OyxfddRiA00nQ4dl9Afvviv5bd76iNvsEtg5AUXbm/ZVUfH+m4orOHjecZX2xsK9W+\
lS15fZDXpa0nEHPOey/K3IXbco/+2cU1jpEEod1+2FrVDXfp88a2H9X1Dd+\
983RHVT4kuqo7THfB6U837u3vcf3dyauaG+PKHfeaSpMcMqqDoT0wf6pQRXbEjXsvysSFHK+\
l2VGhdqz+gtLsA8O/FtQY27rih5y+\
VuI3qWC2Ez7vZX1vaC5bky21RXfHxJd0S3i09G2WCpcvPN14zLzXjBiuRdPFMWc4op6DyuKy+\
dRwecf3dnjLL1w1+Amc/gvFey/K/Ll8FbrbaCCxibRtMpnPbDsmP/\
OI28xD3RFBiOXZAl9VLj86sNQmFQPnvNiHuGKjr5fNT3wgwqKpHVaOXXdIEvy9fHOwfefca6I6/\
VNIYFZKrw+cue18vVumNa/M/fWVgn774puWM+nySwbA2Lzcmb75QuVr7+kYsras9h/\
V1QWv9slcYGHG0ya6AZ1gfzLezW9wQrYf1eU+\
FvrRsEcFebqbBc6kC7YJ8c72HHoDPbfFVVbbrYrmKLC7E8W1pGiTqj5vk3IaFQe+++Kbvpde6A/\
SoX1lOmz7650QtOM4a+XGaew/64I1s7/FutY+P9fpRv4/\
OyAT8nfZvrt8P1xmyv6k3CfraJqIZ90hmLDex2wiYPcdGHnCey/\
K9LZXcZRlE2F38ODuUe2d8BiP4Lvp6muSM6IXag7nAoJYlMRbNntEOHuU9QwIYP9d0VZK2L2WxKpkP\
aJe3JOpR1S7DdPNmxG2H83NPbk7bFGLSpIMQQKHO9rg9rqtx/\
LKVLYfzf0tzqykKAC0hJSXktsg95Kt1GiwBHsvxtycDugGMNC/f/+gxhu0Y7kD2H/\
3ZDQruZz8lmj8OXcguMGrZBcsKKteZs49t8NfTr+vSLp/CgYBYVXswV+h0QDd2rUAzHsvxt6bP+\
21GV4BO69DjN7UdECT7jst2gaiWL/3dCBOc72bKcROJox3fyAqQV+juh2ZhFFsP9uaGJrzS2dVSN4/\
X3D94QHsP9uSDjyreBn72H4h9L4k9X6K3AyeW1XXrcf+++GzuYm+\
wkyD8NpRZX8NynN0Ni2SfjO4F7svxviympjm3MeguALVudZh76A6X7wEisWxv67oWNFxKGfI4PwbLl\
/yq1dXyDGRM5TlrgH+++GFGT+UY29MIi9aIIwtgf+F3qFsP8L3+9QIjdj1gBsEcgavBzSCEQd/uaI+\
p3YfzckL4qiVnMPwM6UR7kyDQ0g4exsZmosiP13QwJ8Wz5OmfZDxJdNGTUcDaC9u5a0tkYA+++\
G2Of7V7K864PN/B0iHYr1UI10Tboit2D/3ZD2t5PLbVn7YMdCdS93tw77sQn774b8z2W8/qDZC8+\
Zs1eJldeCO6vLBeVH67D/Cz/fVfe4X3QPdN8s3DqzthZSrbKl1R5wYf/dUPVG/\
ZWW1AVv71Ym3btQA3IFki5cLJzYfzdkUteoNCrdDfcdr4zVPauGfxzeq1l/Ycf+\
u6FE038rFlg856ogVm7nw45DLNh/N3RI5sDhO52dwH55jTKLUhXsv/CNdc2uVdh/N/T+\
4QpGdalOGH3t+9VbsxJ2K5BtB1KZsP9uaPv2VyOmgQteNlWuMt/6GU435DbLZDNi/\
xfWf4Co8tRkO5x58VhdcbQc3icTvrXwLsP+uyEO+\
0PxhAvtsC81dDS2sAyvv3nCov9uyGd2b8C2rDa4fVSQg+V5Kby4v/nKtvk/i7zPDdU/\
YbjAztcGiTq/\
46q8S4DxiUKtRMXvRU51Q50uUitYVraC0dBRlkKbYmhZvf5mVcnUIp9yQ3ZrPahbGlpAIJ6B/\
NqsCBLSg8NtWycXOQMZpR+e+mj48hsY//sU4nvWH4ucmYy4j2pMNbl+hYXd3eDR1QKw/\
zM5HrF8YpFzkNHM5wNnqnSaYfUZa06FW59gyHjQPfYPdZFvICNmRsO+JpkvoNj/\
Y329Uz5Yqr3Y7lc0vMj5yejUi903SbubwOXfi5GPUOphtI/\
5dv8iFyKjvUYbOzTXN4KG2q6FVikPf76uRS5CRskJX275szbAdqafNgz1ueAr91G04nDbIpcko0oqq\
4bZyno4dCBwdRVDLnQf9EkVj2lY5IiMWE/nJZGY6+DSiMVCJf8e5JPfBY03li5yeTKyZYwXv/\
NPLTyrd7l36/s70NPZuj38SsYiVyGjv91vi2ANiDIn8F4yfIv3VfxoklHws4P1kqgaWt3/\
NvpZtFyXjMKbpm8QDKsg8Sfrk+\
rwTFpuQkZtG7SPNPBXAssVvsf16m9ouTkZ3dq4c7UtpQKkLt1dYcmTQcttyUhKqdpPa64MKH+\
nz52vaTmRjA5qlhsIuZZCp8fzqH3v02g5hYyeessNMXKXwLX6DPtX0am03JeMCs6sk0lMKwIVM1LzT\
MArWh5IRodMDSN7dQuhSHYK5T5KoeURZPRvO7m5AP59ff//\
ewn4iSOjnCevLqzpzIemu9lHVhsk0vIUMgptbNrx8s1HWCXtmjkXHk/LM8mIzTo/48TTPHgvO3Ksf+\
wFLc8lI5Y7FiztnrmQclnH5YZmHC0vJiPXO38nVh9gvSvvI5HaGFpeRUaj0yvLnNbnQAjPbQFjvee0\
vImM5oSFz56ReQtNqiORY4zRtLyNjNg3e7CquGeBkjxzh3NmFC3vIyPVGy8r3LregBvL4aQs10haTi\
Wj8/8O1jLw+RFBy6fI6ApTxgbrX6+hjfNQJjkpjJYzuKPXk6VzFi/SoMtd/drW3BBazuyOhIJFTJ/\
fSYX+py7mPJNBtJzDHfms26fXr/4KupNK93CefUrLN7ijrIVqeZ18Cr6ffkLL+\
d2RkXJsO0N4Eti1p/dR1QJouZA7qkvd0L+8OgGssrJaCXOPaLmIO7Is/C60Yms87Ffl1zV7/\
5CWS7oj15N/T7wXwKmYNXj0gT8tR+4of8/\
3YqnxWDx39qPl8gufDyUMf7sWA3F12ad4TvvSchV3pLW21jF0OBqcCIMBP/Qf0PnvjvRkNStlnJ/\
B43GH9YXy9+j8d0eZH3Y9us8fBTsfVjJuPe1N57872vOCa6F1iwChTE1VN1MKnf/\
uSE5ygFNSMRz8ogrNZl560Pnvjoj7hAXL1oZCl9l9jsMs7nT+u6OGJ63ygr+DwONZzoWDHm50/\
rujaSORk4IsT8FyDc+GUT5XOv/dkd/avwfcE+hUZ7h3tYpI5787+h60OnfLk8dwvINTgO+oC53/\
7ihkzfWkWc5HMOX3dkXwCic6/90Rf2dLbUWCP/idfdbyYt6ezn93VL3KJInHyA/0vu5cES9oR+f/\
wvvrbL2qJekLF0W1+BgsbOj8d0ePZl9teHDmATw8E2Mf1GFF5787Yh120AxUvwdME/\
OFttaWdP67o54KRtMGsjf0fOl45rvrDp3/\
7oj3V8hL0UYK1Dpz3GykWtD5746GBJOe28p5QqGov7RshTmd/+7oTPAKicZP7qDufCK/2uIWnf/\
uSMdYWqP6EhmiY22aO4xv0Pnvjn66F3R/XuEGXDe5QpXszej890C2uws5JAtJMMmw7Ep8gimd/\
x4oVSX5jWUIEa6IZPY8mLtK578Hch//VJS+xgVgLGy/wk1jOv890IaQ+vx1q53g0gmrydtThnT+\
e6DnDz1KpHc4wCXt/HXzQQZ0/nsgUY5h4cu6dhDLEvm9V12fzn8PRPCWFg57YwPXPqRz7RDQo/\
PfAx0ZnNgcKmQNr3rLmKcYdOn890Ck5iEzplRLeJZ052tjlzad/x6oKX+\
bY7zaHVA9kLHhXP9lOv89kE5no4np6tsQ+VziTDb7JTr/PRC3Z/okV705HI/tbdFU0aTz3wNVSFy/\
omhyCwrmY2Tnk87T+e+BArvn13WeuQHFFYJWU7vO0fnvgZ6YzR8NVzGD/TrZVPVsdTr/PVAzz/\
GRg7am0LgsT0TASI3Ofw9kLharoZF7FfcnqnT+eyCFlLHCG7uMIfiXyEY+BhU6/\
z1QmK8Bm1C8ITTe6oDR5rN0/nug9eGH1dhOG4Ci/akdt74q0PnvgQTlJaWezenBh3kx5z1zp+\
n8X1h/GRwk6xJdOD92sscP5On890CvPrAn7lDWgWBrA5X6kJN0/\
nsgvyuljl0HtCGjJfK1HfcJOv890PbiDd7LDl6GWo6rX0ej5ej890AMsCFd9fxFMDu65Xycoiyd/\
x5IXsZ7XeKTC7hvkaHz3wPJqu8TvPvjHBCmVq/LygA6/z3QCyb7JzJmGlDom7Emylmazn8PtInwLv/\
3bzUoWF478fLaMTr/F77/bp3+1ihV6GR4WxVid4TOfw/04FyU/np9FSg6XJqCXh6m898TbUkMHSu/\
qQRXny3fU/Fbgs5/T/QASkVDZRWhK0/o3CZTcTr/PRGpsHvvfukz8NX9fpnhhBid/\
54ox2hF3hoteSDp+2f2PRGl898T1X00cC1fyC1aIfpLu4YInf+eaPDqn0Lm2eNQKbtLVFx1P53/\
nqjmV6MXq4Mc/DrCLBe7fS+d/57o/WENcV0eWTAy2a3GuHUPnf+\
eKOXmj27fUgRj2e2Du2WE6Pz3ROknzQaUxQAitkbmLaPspPPfE+\
XencjZPi8Ffe8jbsiNCdL574mevOBTWDF1FN4ctOc6b7+dzn9PpBDqHqC18QiUrk9KjeTfRue/\
J9LWdZR8pHMY4pdH7/Rp56fz3xN1X9e5vK5I4v9//5mG23qiviHimk5FcTC2Tn+Yr8ZH5//\
Cz3f1fZ45Igbnnl488FNzM53/nighyKJvy0tReGD7p5WbvJHOf08kJ8gtGuooAqTVQbt9q9bT+b+Q/\
+b+Bsui/SAkI9hXd3Qdnf+eyOTs2H2h7L1g3Pv1lsUHbjr/PVGHpQ/hw+c9wP/4cJGHFhed/55Ip+\
ep6d3lu+HKr8strRz/0PnviVzHg7d3nN8Fhm9vW536ykHnvydyHjYb5inagd/fWjr/\
PRES93mcrSoIlrlcJh8vstP574nC07RevP6xDRKe5kw81WOl898TbeIOulyTJACbWRXsW71X0/\
nviUJ/593ucuaHEzbv932tXUXnvyca4WWcuVO0Bb+/lXT+L3w+\
Wy3ztje8UCfaPVOaw0TnvyeKY37oJVy+CYSEb7e8uLSczn8KenGWYW/Vso3Qk1YQGb6Wkc5/\
CtL5VP7jzPn1UKfWrN3czEDnPwUxDeudWFfEQzvX+O/\
ZQEErt9a0lqhyg0lUKHvTxVlazk9BRaRTfk0//\
oF9qhX7PuvN0HIhCjKrnK5fnswJPbF7xnfenablIhR0PXdWe40LB1Rs71NaX/eLlktS0O/\
NIy8ti9bg9zdJyxEF7XR66yT4hg3yhk8Hy+X8oOXyFMRu+8zyWikLWA2BmPHFCVquQkFyQtXmq+\
eZwdFRUDGMfZyWa1JQwwu7mXy1VcD7bZmkUhOVlutS0DRPQOKV/BVw0i+k/\
9WtUVpuQkFrbqyfS1ZiAnLzKn7tc8O03JyCesW7XvWMM8LsIS+d+SuDtNyWgu5V/\
lBTSFoGKzc5qvB699Ny4sL7i7yTJujCAL8mjwUfruul5ZT/\
3t8cYfH99dByXwqqmJNtDH39h3D7W2mA+dsuWh5IQcntTEFR+\
b8JZu5PQokanbQ8goIOvQ99t25iimDUki09y9RBy+MoqN0nPO6ezC9CWuajr9/\
L2mh5CgXtVQspCkj8SbgkbTJ7TKWVlmdS0KWAa+\
GXJX4Qos0rJYpEWmh5LgVZiVwMrm4YJ1R46DnePPSVlhdT0EmncbYTvmOErF6vzJwrX2h5FQW9ayCf\
Y9KlEs4XmV+RiW2k5U0UdPygxP03lBGC+67ta93ZG2h5GwU5TuQ7XrMZIjRIku9L+\
dTR8j4KMj5SMpfnNUBYlhvNmbanlpZTKYiTkToWkNNHgNdvJS5+r6blUwvrU+\
Uyz3uOXkJhTOTZ8LgqWs7ghVYLZJziIHUT7rtHVgysraTlzF4otqQnR4Gti5CquzzJ+mc5LefwQl+\
YhBnCUjoI5VkgheZL6fz3QvGZqqvI19sJ+vPKVzYIl9D574V2iIXo2xPaCCO15jcqrYvo/PdC/\
inN6b9Pfyd0sG87JNFWQOe/FxrZ+jOKKvWNwHnbXGOZ0Sc6/70QD7c5k6x6M8FZRDLw/PJ8Ov+\
9EOKXFyv1biKE33TY/yIrj85/L/QQGMwM2hsIlcMrwsw8cun890Jy4Ydy+\
zTqCZNrjq7ZXvWezn8vVC80A7ydtYR0H52yqax3dP57oas/T0uKetcQ0PRW+FCUTee/Fzq+\
MUc8Tr6acLtnvazir0w6/71QKTJpZuSrIihsa2y1OfmGzn8vNOMbzejN+pkwGtt2njctnc5/\
L1Tkfcohk7GcYFl1jffn0dd0/nshFoNnlcv4Sgncj94rCn1LpfPfC62ws+iS0SwmnNzwnXvP41d0/\
nuhMZ0kTo3UQsKrWRfTm4YpdP57oQ1yVcXcuwsIjlROmTrfJDr/vdB5SW8Whex8wvE9RZeXuyTQ+e+\
FfmlQuvYafiTcjH6hUe/7ks5/L3Q/dmgZ7Mgj1M4o/tjxKY7Ofy+\
k4ZS6mW3qA2Gk4eud6nWxdP57oeQs47Nsn3MIRWfDDNI8ntP574VaPO7HGJS8JVS/\
2pN5jzOazn8vJBzpJOjRm0WYUN3o5pkeRee/F7L/Ycd0cWcmIfKcQTufRSSd/17IQ6pG5YNbBsFNJ+\
NNiWwEnf9eiFWigStk9jWheVO/4Wq1sP/n/wfQyDsP\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cie1931Data", "=", 
   RowBox[{"Uncompress", "[", "cie1931Table", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cie1931WaveLength", "=", 
    RowBox[{"cie1931Data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xBar", "=", 
   RowBox[{"cie1931Data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yBar", "=", 
   RowBox[{"cie1931Data", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"zBar", "=", 
    RowBox[{"cie1931Data", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uBar", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", "/", "3"}], ")"}], "*", "xBar"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"vBar", "=", "yBar"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"wBar", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.5"}], "*", "xBar"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"3", "/", "2"}], ")"}], "*", "yBar"}], "+", 
     RowBox[{"0.5", "*", "zBar"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"cie", " ", "1931", " ", "data", " ", "interpolation"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xLamdaPair", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cie1931WaveLength", ",", "xBar"}], "}"}], "//", "Transpose"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yLamdaPair", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cie1931WaveLength", ",", "yBar"}], "}"}], "//", "Transpose"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zLamdaPair", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cie1931WaveLength", ",", "zBar"}], "}"}], "//", "Transpose"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fCie1931X", "=", 
   RowBox[{"Interpolation", "[", "xLamdaPair", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fCie1931Y", "=", 
   RowBox[{"Interpolation", "[", "yLamdaPair", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fCie1931Z", "=", 
    RowBox[{"Interpolation", "[", "zLamdaPair", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"calc", " ", "color", " ", "coordinate"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"deltaLamda", "=", 
   RowBox[{
    RowBox[{"spdDataWaveLength", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "-", 
    RowBox[{"spdDataWaveLength", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{
    RowBox[{"spdData", "*", 
     RowBox[{"fCie1931X", "[", "spdDataWaveLength", "]"}], "*", 
     "deltaLamda"}], "//", "Total"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{
    RowBox[{"spdData", "*", 
     RowBox[{"fCie1931Y", "[", "spdDataWaveLength", "]"}], "*", 
     "deltaLamda"}], "//", "Total"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "=", 
    RowBox[{
     RowBox[{"spdData", "*", 
      RowBox[{"fCie1931Z", "[", "spdDataWaveLength", "]"}], "*", 
      "deltaLamda"}], "//", "Total"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"X", "/", 
    RowBox[{"(", 
     RowBox[{"X", "+", "Y", "+", "Z"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y", "=", 
   RowBox[{"Y", "/", 
    RowBox[{"(", 
     RowBox[{"X", "+", "Y", "+", "Z"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<x=\>\"", ",", "x", ",", "\"\<;y=\>\"", ",", "y"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yknormal", "=", 
   RowBox[{"100", "/", "Y"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Yk", "=", 
   RowBox[{"Y", "*", "Yknormal"}]}], ";"}], "\n", 
 RowBox[{"u", "=", 
  RowBox[{"4", "*", 
   RowBox[{"X", "/", 
    RowBox[{"(", 
     RowBox[{"X", "+", 
      RowBox[{"15", "*", "Y"}], "+", 
      RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], "\n", 
 RowBox[{"v", "=", 
  RowBox[{"6", "*", 
   RowBox[{"Y", "/", 
    RowBox[{"(", 
     RowBox[{"X", "+", 
      RowBox[{"15", "*", "Y"}], "+", 
      RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.656044551662611*^9, 3.65604473133047*^9}, {
   3.6560449303750496`*^9, 3.656044931167576*^9}, {3.656044995891722*^9, 
   3.6560451201304193`*^9}, {3.6560451994227047`*^9, 
   3.6560452250672493`*^9}, {3.6560457789325304`*^9, 
   3.6560459533875256`*^9}, {3.6560603196329613`*^9, 
   3.6560603307953677`*^9}, {3.656060381852831*^9, 3.6560604529756174`*^9}, {
   3.656060525437869*^9, 3.6560606505815496`*^9}, {3.656060681825283*^9, 
   3.656060686620463*^9}, {3.6560607246016836`*^9, 3.6560608201826715`*^9}, {
   3.6560608590124345`*^9, 3.656060881349084*^9}, {3.656060958099415*^9, 
   3.656061212666354*^9}, {3.656061262645093*^9, 3.656061265150755*^9}, {
   3.6560613072497654`*^9, 3.6560613188704762`*^9}, {3.6560614857838707`*^9, 
   3.656061621489953*^9}, {3.656061665843615*^9, 3.6560618575190463`*^9}, {
   3.65606190424146*^9, 3.6560619781235228`*^9}, {3.6560620121150784`*^9, 
   3.6560620673655415`*^9}, {3.656062114920741*^9, 3.6560623475898485`*^9}, {
   3.656062411926323*^9, 3.6560624144479933`*^9}, {3.6561126963496637`*^9, 
   3.656112719056402*^9}, {3.656113212280444*^9, 3.6561132617151318`*^9}, 
   3.656113995053588*^9, {3.6561298144610114`*^9, 3.6561298683065524`*^9}, {
   3.656129930177919*^9, 3.6561300412492943`*^9}, {3.656131060376851*^9, 
   3.656131092022416*^9}, {3.6561467077397614`*^9, 3.6561467157580795`*^9}, {
   3.656217944373162*^9, 3.6562179477293935`*^9}, {3.6562180677851963`*^9, 
   3.6562180807748613`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"x=\"\>", "\[InvisibleSpace]", "0.39758898015538424`", 
   "\[InvisibleSpace]", "\<\";y=\"\>", "\[InvisibleSpace]", 
   "0.37949821607199075`"}],
  SequenceForm["x=", 0.39758898015538424`, ";y=", 0.37949821607199075`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.656130083955532*^9, 3.656131094335027*^9, 3.656146920376392*^9, 
   3.656147743143235*^9, 3.656149029605765*^9, 3.6562163441600547`*^9, 
   3.6562175507487464`*^9, {3.656218072714471*^9, 3.65621808174751*^9}, {
   3.6562209057154646`*^9, 3.656220933206738*^9}}],

Cell[BoxData["0.23530149905025147`"], "Output",
 CellChangeTimes->{
  3.656218081749507*^9, {3.6562209057174654`*^9, 3.656220933208739*^9}}],

Cell[BoxData["0.33689250803834075`"], "Output",
 CellChangeTimes->{
  3.656218081749507*^9, {3.6562209057174654`*^9, 3.6562209332097397`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"calc", " ", "CCT"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "%", " ", "2002", " ", "CODATA", " ", "recommended", " ", "values"}], 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"h", "=", 
     RowBox[{"6.6260693", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "34"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"c", "=", "299792458"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"k", "=", 
     RowBox[{"1.3806505", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "23"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"c1", "=", 
     RowBox[{"2", "*", "Pi", "*", "h", "*", 
      RowBox[{"c", "^", "2"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"c2", "=", 
     RowBox[{"h", "*", 
      RowBox[{"c", "/", "k"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MrecpK", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.01", ",", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "600"}], "]"}]}], "}"}], "//", "Flatten"}]}], 
    ";"}], "    ", 
   RowBox[{"(*", 
    RowBox[{
    "%", " ", "mega", " ", "reciprical", " ", "Kelvin", " ", "values", " ", 
     "of", " ", "isotemperature", " ", "lines"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{"1.", "/", 
      RowBox[{"(", 
       RowBox[{"MrecpK", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "6"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dwave", "=", 
     RowBox[{
      RowBox[{"cie1931WaveLength", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "-", 
      RowBox[{"cie1931WaveLength", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sl", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "T", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", 
      RowBox[{"Length", "[", "T", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"spdref", "=", 
       RowBox[{"c1", "*", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"10", "^", 
             RowBox[{"-", "9"}]}], "*", "cie1931WaveLength"}], ")"}], "^", 
          RowBox[{"-", "5"}]}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"c2", "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"T", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "*", 
               RowBox[{"10", "^", 
                RowBox[{"-", "9"}]}], "*", "cie1931WaveLength"}], ")"}]}], 
            "]"}], "-", "1"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"spdref", "=", 
       RowBox[{"spdref", "/", 
        RowBox[{"Max", "[", "spdref", "]"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"wave", "=", 
       RowBox[{"cie1931WaveLength", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "9"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "%", " ", "Equations", " ", "from", " ", "Wyszecki", " ", "and", " ", 
         "Sitles"}], ",", 
        RowBox[{"Color", " ", "Science"}], ",", 
        RowBox[{"2", "nd", " ", 
         RowBox[{"ed", ".", "1982"}]}], ",", 
        RowBox[{"page", " ", "%", " ", "226", " ", "and", " ", "227"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       RowBox[{
        RowBox[{"spdref", "*", "uBar", "*", "deltaLamda"}], "//", "Total"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"V", "=", 
       RowBox[{
        RowBox[{"spdref", "*", "vBar", "*", "deltaLamda"}], "//", "Total"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"W", "=", 
       RowBox[{
        RowBox[{"spdref", "*", "wBar", "*", "deltaLamda"}], "//", "Total"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"R", "=", 
       RowBox[{"U", "+", "V", "+", "W"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"U", "/", "R"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"v", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"V", "/", "R"}]}], ";", "\[IndentingNewLine]", "\n", "  ", 
      RowBox[{"Uprime", "=", 
       RowBox[{
        RowBox[{"c1", "*", "c2", "*", 
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", 
          RowBox[{"-", "2"}]}], "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"wave", "^", 
            RowBox[{"-", "6"}]}], "*", "uBar", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"c2", "/", 
             RowBox[{"(", 
              RowBox[{"wave", "*", 
               RowBox[{"T", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"c2", "/", 
                RowBox[{"(", 
                 RowBox[{"wave", "*", 
                  RowBox[{"(", 
                   RowBox[{"T", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ")"}]}], "]"}], 
              "-", "1"}], ")"}], "^", 
            RowBox[{"-", "2"}]}]}], ")"}], "*", "dwave"}], "//", "Total"}]}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{"%", " ", 
        RowBox[{"dU", "/", "dT"}]}], "*)"}], "\n", "  ", 
      RowBox[{"Vprime", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c1", "*", "c2", "*", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "^", 
            RowBox[{"-", "2"}]}], "*", 
           RowBox[{"wave", "^", 
            RowBox[{"-", "6"}]}], "*", "vBar", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"c2", "/", 
             RowBox[{"(", 
              RowBox[{"wave", "*", 
               RowBox[{"T", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"c2", "/", 
                RowBox[{"(", 
                 RowBox[{"wave", "*", 
                  RowBox[{"(", 
                   RowBox[{"T", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ")"}]}], "]"}], 
              "-", "1"}], ")"}], "^", 
            RowBox[{"-", "2"}]}]}], ")"}], "*", "dwave"}], "//", "Total"}]}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{"%", " ", 
        RowBox[{"dV", "/", "dT"}]}], "*)"}], "\n", "  ", 
      RowBox[{"Wprime", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c1", "*", "c2", "*", 
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "^", 
            RowBox[{"-", "2"}]}], "*", 
           RowBox[{"wave", "^", 
            RowBox[{"-", "6"}]}], "*", "wBar", "*", 
           RowBox[{"Exp", "[", 
            RowBox[{"c2", "/", 
             RowBox[{"(", 
              RowBox[{"wave", "*", 
               RowBox[{"T", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}], "]"}], "*", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"c2", "/", 
                RowBox[{"(", 
                 RowBox[{"wave", "*", 
                  RowBox[{"(", 
                   RowBox[{"T", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ")"}]}], ")"}]}], "]"}], 
              "-", "1"}], ")"}], "^", 
            RowBox[{"-", "2"}]}]}], ")"}], "*", "dwave"}], "//", "Total"}]}], 
      ";", 
      RowBox[{"(*", 
       RowBox[{"%", " ", 
        RowBox[{"dW", "/", "dT"}]}], "*)"}], "\n", "  ", 
      RowBox[{"Rprime", "=", 
       RowBox[{"Uprime", "+", "Vprime", "+", "Wprime"}]}], ";", 
      "\[IndentingNewLine]", "\n", "  ", 
      RowBox[{
       RowBox[{"sl", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Vprime", "*", "R"}], "-", 
          RowBox[{"V", "*", "Rprime"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Uprime", "*", "R"}], "-", 
          RowBox[{"U", "*", "Rprime"}]}], ")"}]}]}], ";", "        ", 
      RowBox[{"(*", 
       RowBox[{
       "%", "\:666e\:6717\:514b\:8f68\:8ff9\:7ebf\:4e0a\:5782\:8db3\:5904\
\:7684\:5207\:7ebf\:659c\:7387"}], "*)"}], "\n", "  ", 
      RowBox[{
       RowBox[{"m", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"-", "1"}], "/", 
        RowBox[{"sl", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}]}], 
    RowBox[{"(*", 
     RowBox[{"%", "\:7b49\:6e29\:7ebf\:659c\:7387"}], "*)"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ut", "=", "u"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"vt", "=", "v"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tt", "=", "m"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"isoTempLinesTable", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"T", ",", "ut", ",", "vt", ",", "tt"}], "}"}], "//", 
      "Transpose"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "u", "\:3001", "v\:524d\:9762\:5df2\:7ecf\:8ba1\:7b97\:8fc7", "\:ff0c", 
     "\:6b64\:5904\:91cd\:590d\:8ba1\:7b97\:7684\:539f\:56e0\:662f", "\:ff1a",
      " ", "u", "\:3001", "v\:88ab\:91cd\:65b0\:8d4b\:503c", "\:ff0c", 
     "\:539f\:6765\:6570\:503c\:88ab\:51b2\:6389\:4e86"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u", "=", 
     RowBox[{"4", "*", 
      RowBox[{"x", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "x"}], "+", 
         RowBox[{"12", "*", "y"}], "+", "3"}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"v", "=", 
     RowBox[{"6", "*", 
      RowBox[{"y", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], "*", "x"}], "+", 
         RowBox[{"12", "*", "y"}], "+", "3"}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<u=\>\"", ",", "u", ",", "\"\<;v=\>\"", ",", "v"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"d1", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"v", "-", 
          RowBox[{"vt", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "-", 
        RowBox[{
         RowBox[{"tt", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"(", 
          RowBox[{"u", "-", 
           RowBox[{"ut", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"tt", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "*", 
         RowBox[{"tt", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "2"}], ",", 
     RowBox[{"i", "\[LessEqual]", 
      RowBox[{"Length", "[", "T", "]"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"v", "-", 
            RowBox[{"vt", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "-", 
          RowBox[{
           RowBox[{"tt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"u", "-", 
             RowBox[{"ut", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ")"}]}]}], ")"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"tt", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "*", 
           RowBox[{"tt", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"d1", "/", "d2"}], "<", "0"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"index", "=", "i"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"d1", "=", "d2"}], ";"}]}], "]"}]}]}], "\n", "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"index", "==", "0"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tc", "=", 
         RowBox[{"-", "1"}]}], ",", 
        RowBox[{
        "Print", "[", 
         "\"\<Not able to calculate CCT,u,v coordinates outside range.\>\"", 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Tc", "=", 
         RowBox[{"1", "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"1", "/", 
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{"index", "-", "1"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"d1", "/", 
              RowBox[{"(", 
               RowBox[{"d1", "-", "d2"}], ")"}]}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"1", "/", 
                RowBox[{"T", "[", 
                 RowBox[{"[", "index", "]"}], "]"}]}], "-", 
               RowBox[{"1", "/", 
                RowBox[{"T", "[", 
                 RowBox[{"[", 
                  RowBox[{"index", "-", "1"}], "]"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}]}], ",", "   ", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<CCT=\>\"", ",", "Tc"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.656044551662611*^9, 3.65604473133047*^9}, {
   3.6560449303750496`*^9, 3.656044931167576*^9}, {3.656044995891722*^9, 
   3.6560451201304193`*^9}, {3.6560451994227047`*^9, 
   3.6560452250672493`*^9}, {3.6560457789325304`*^9, 
   3.6560459533875256`*^9}, {3.6560603196329613`*^9, 
   3.6560603307953677`*^9}, {3.656060381852831*^9, 3.6560604529756174`*^9}, {
   3.656060525437869*^9, 3.6560606505815496`*^9}, {3.656060681825283*^9, 
   3.656060686620463*^9}, {3.6560607246016836`*^9, 3.6560608201826715`*^9}, {
   3.6560608590124345`*^9, 3.656060881349084*^9}, {3.656060958099415*^9, 
   3.656061212666354*^9}, {3.656061262645093*^9, 3.656061265150755*^9}, {
   3.6560613072497654`*^9, 3.6560613188704762`*^9}, {3.6560614857838707`*^9, 
   3.656061621489953*^9}, {3.656061665843615*^9, 3.6560618575190463`*^9}, {
   3.65606190424146*^9, 3.6560619781235228`*^9}, {3.6560620121150784`*^9, 
   3.6560620673655415`*^9}, {3.656062114920741*^9, 3.6560623475898485`*^9}, {
   3.656062411926323*^9, 3.6560624144479933`*^9}, {3.6561126963496637`*^9, 
   3.656112719056402*^9}, {3.656113212280444*^9, 3.6561132617151318`*^9}, {
   3.656113995053588*^9, 3.6561140106015873`*^9}, {3.656114086779769*^9, 
   3.6561141173677444`*^9}, {3.656114189028053*^9, 3.6561142340495605`*^9}, {
   3.6561142735006943`*^9, 3.656114292910838*^9}, {3.656114418530402*^9, 
   3.6561144755286937`*^9}, {3.6561147036073675`*^9, 3.6561147665453796`*^9}, 
   3.656114809379445*^9, 3.6561247398040347`*^9, 3.6561256991969395`*^9, {
   3.656126420594716*^9, 3.656126498557197*^9}, {3.656126529867778*^9, 
   3.6561265324391327`*^9}, {3.656126654362162*^9, 3.6561266670971684`*^9}, {
   3.6561267005747995`*^9, 3.656126765436059*^9}, {3.656126870566415*^9, 
   3.656126896781559*^9}, {3.6561269365589104`*^9, 3.656126937637088*^9}, {
   3.65612705987431*^9, 3.656127151798509*^9}, {3.6561272013365507`*^9, 
   3.6561274090706377`*^9}, {3.6561274669125776`*^9, 
   3.6561276141891656`*^9}, {3.656127737620745*^9, 3.6561277677386165`*^9}, {
   3.656127851587859*^9, 3.656127915192738*^9}, {3.65612795349247*^9, 
   3.656128058464609*^9}, {3.656128102063467*^9, 3.6561282142786303`*^9}, {
   3.6561282999453783`*^9, 3.6561283944297695`*^9}, {3.6561284385882072`*^9, 
   3.656128439666381*^9}, {3.656128496517303*^9, 3.656128499158059*^9}, {
   3.656128590671059*^9, 3.656128629478546*^9}, {3.656128718913879*^9, 
   3.6561287245896215`*^9}, {3.6561292714700785`*^9, 
   3.6561293878818464`*^9}, {3.6561294604293385`*^9, 3.656129527222768*^9}, {
   3.6561296118060465`*^9, 3.6561297065169153`*^9}, {3.6561301902681675`*^9, 
   3.6561301947996554`*^9}, {3.6561302478934317`*^9, 3.656130478234369*^9}, {
   3.6561305255058575`*^9, 3.6561305990855494`*^9}, {3.656130629636742*^9, 
   3.656130720595606*^9}, {3.656131016013232*^9, 3.6561310179352036`*^9}, {
   3.6561310744732485`*^9, 3.6561311243305473`*^9}, {3.6561468601410513`*^9, 
   3.6561468894444804`*^9}, {3.6561469543595247`*^9, 
   3.6561469942597184`*^9}, {3.6561471153604584`*^9, 
   3.6561471232196665`*^9}, {3.6561471808285866`*^9, 3.656147210667373*^9}, {
   3.656147250541768*^9, 3.656147253515744*^9}, {3.656147308303542*^9, 
   3.6561473103198795`*^9}, {3.6561477368370533`*^9, 
   3.6561477370171723`*^9}, {3.656147791129285*^9, 3.65614784535145*^9}, {
   3.6561479086141653`*^9, 3.656147949768117*^9}, {3.6561480761586447`*^9, 
   3.6561480764648466`*^9}, {3.6561481616858244`*^9, 3.656148174564363*^9}, {
   3.6561482513687925`*^9, 3.6561484410305605`*^9}, {3.6561484831855516`*^9, 
   3.6561484864257*^9}, {3.65614851789958*^9, 3.6561485327914476`*^9}, {
   3.656148566835987*^9, 3.6561485764593706`*^9}, {3.656148798341508*^9, 
   3.65614880414876*^9}, {3.656148844797613*^9, 3.656148869911268*^9}, {
   3.6561494300495696`*^9, 3.6561494344875135`*^9}, 3.6561494695863037`*^9, 
   3.656154098141715*^9, {3.656218188862405*^9, 3.6562182306982484`*^9}, {
   3.6562182623155174`*^9, 3.6562183250617447`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"u=\"\>", "\[InvisibleSpace]", "0.23530149905025147`", 
   "\[InvisibleSpace]", "\<\";v=\"\>", "\[InvisibleSpace]", 
   "0.3368925080383407`"}],
  SequenceForm["u=", 0.23530149905025147`, ";v=", 0.3368925080383407],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.656154099063326*^9, 3.6562163445703278`*^9, 3.656217551044944*^9, 
   3.6562182335402994`*^9, 3.656218332978007*^9, {3.656220905997652*^9, 
   3.656220933503935*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"CCT=\"\>", "\[InvisibleSpace]", "3583.080167672832`"}],
  SequenceForm["CCT=", 3583.080167672832],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.656154099063326*^9, 3.6562163445703278`*^9, 3.656217551044944*^9, 
   3.6562182335402994`*^9, 3.656218332978007*^9, {3.656220905997652*^9, 
   3.6562209335159435`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"calc", " ", "CRI"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sunCompositionData", "=", 
     RowBox[{
      RowBox[{
      "Import", "[", 
       "\"\<D:\\\\smartLighting\\\\smartLighting\\\\data\\\\sunComposition.\
xls\>\"", "]"}], "//", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"#", ",", "1"}], "]"}], "&"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunCompositionWaveLength", "=", 
     RowBox[{"sunCompositionData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunCompositionS0", "=", 
     RowBox[{"sunCompositionData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunCompositionS1", "=", 
     RowBox[{"sunCompositionData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sunCompositionS2", "=", 
     RowBox[{"sunCompositionData", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "4"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"Tc", "<", "5000"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"<", "5000"}], ",", "begin"}], "*)"}], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"spdref", "=", 
         RowBox[{"c1", "*", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"10", "^", 
               RowBox[{"-", "9"}]}], "*", "cie1931WaveLength"}], ")"}], "^", 
            RowBox[{"-", "5"}]}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"c2", "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"T", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "*", 
                 RowBox[{"10", "^", 
                  RowBox[{"-", "9"}]}], "*", "cie1931WaveLength"}], ")"}]}], 
              "]"}], "-", "1"}], ")"}]}]}]}], ";", 
        RowBox[{"Print", "[", "\"\<Tc<5000\>\"", "]"}]}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"<", "5000"}], ",", "end"}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{">", "5000"}], ",", "begin"}], "*)"}], 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Tc", "\[LessEqual]", "25000"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"\[LessEqual]", "25000"}], ",", "begin"}], "*)"}], 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"Tc", "\[LessEqual]", "7000"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Print", "[", "\"\<5000<=Tc<=7000\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{"xd", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "4.6070"}], "*", 
                    RowBox[{
                    RowBox[{"10", "^", "9"}], "/", 
                    RowBox[{"Tc", "^", "3"}]}]}], "+", 
                    RowBox[{"2.9678", "*", 
                    RowBox[{
                    RowBox[{"10", "^", "6"}], "/", 
                    RowBox[{"Tc", "^", "2"}]}]}], "+", 
                    RowBox[{"0.09911", "*", 
                    RowBox[{
                    RowBox[{"10", "^", "3"}], "/", "Tc"}]}], "+", 
                    "0.244063"}]}], ";"}]}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"else", ",", 
                 RowBox[{">", "7000"}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Print", "[", "\"\<7000<=Tc<=25000\>\"", "]"}], ",", 
                 RowBox[{
                  RowBox[{"xd", "=", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2.0064"}], "*", 
                    RowBox[{
                    RowBox[{"10", "^", "9"}], "/", 
                    RowBox[{"Tc", "^", "3"}]}]}], "+", 
                    RowBox[{"1.9018", "*", 
                    RowBox[{
                    RowBox[{"10", "^", "6"}], "/", 
                    RowBox[{"Tc", "^", "2"}]}]}], "+", 
                    RowBox[{"0.24748", "*", 
                    RowBox[{
                    RowBox[{"10", "^", "3"}], "/", "Tc"}]}], "+", 
                    "0.237040"}]}], ";"}]}], "}"}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", "\"\<5000<=Tc<=25000\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"yd", "=", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3.000"}], "*", "xd", "*", "xd"}], "+", 
               RowBox[{"2.870", "*", "xd"}], "-", "0.275"}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"M1", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1.3515"}], "-", 
                 RowBox[{"1.7703", "*", "xd"}], "+", 
                 RowBox[{"5.9114", "*", "yd"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"0.0241", "+", 
                 RowBox[{"0.2562", "*", "xd"}], "-", 
                 RowBox[{"0.7341", "*", "yd"}]}], ")"}]}]}], ";", "\n", 
             "               ", 
             RowBox[{"M2", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"0.0300", "-", 
                 RowBox[{"31.4424", "*", "xd"}], "+", 
                 RowBox[{"30.0717", "*", "yd"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"0.0241", "+", 
                 RowBox[{"0.2562", "*", "xd"}], "-", 
                 RowBox[{"0.7341", "*", "yd"}]}], ")"}]}]}], ";", 
             "\[IndentingNewLine]", " ", 
             RowBox[{"spdref", "=", 
              RowBox[{"sunCompositionS0", "+", 
               RowBox[{"M1", "*", "sunCompositionS1"}], "+", 
               RowBox[{"M2", "*", "sunCompositionS2"}]}]}], ";"}]}], "\n", 
           "\t", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"spdref", "=", 
              RowBox[{"interp1", 
               RowBox[{"(", 
                RowBox[{"wavelength", ",", "spdref", ",", "wavelength_spd"}], 
                ")"}]}]}], ";", "\n", "\t", 
             RowBox[{"spdref", "=", "0.0"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "}"}]}], "]"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[LessEqual]", "25000"}], ",", "end"}], "*)"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{">", "25000"}], ",", "begin"}], "*)"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Tc>25000\>\"", "]"}], ",", 
          RowBox[{
           RowBox[{"R", "=", 
            RowBox[{"-", "1"}]}], ";", 
           RowBox[{"Return", "[", 
            RowBox[{"-", "2"}], "]"}]}]}], "}"}]}], 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{">", "25000"}], ",", "end"}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{">", "5000"}], ",", "end"}], "*)"}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
       "%", " ", "Interpolate", " ", "TCS", " ", "values", " ", "from", " ", 
        "5", " ", "nm", " ", "to", " ", "spd", " ", "nm", " ", "increments", 
        "\n", "TCS_", "1"}], "=", 
       RowBox[{"zeros", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"length", 
           RowBox[{"(", "wavelength_spd", ")"}]}], ",", "14"}], ")"}]}]}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"for", " ", "i"}], "=", 
       RowBox[{
        RowBox[{"1", ":", 
         RowBox[{"14", "\n", "TCS_", "1", 
          RowBox[{"(", 
           RowBox[{":", 
            RowBox[{",", "i"}]}], ")"}]}]}], "=", 
        RowBox[{"interp1", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TCS", 
            RowBox[{"(", 
             RowBox[{":", 
              RowBox[{",", "1"}]}], ")"}]}], ",", 
           RowBox[{"TCS", 
            RowBox[{"(", 
             RowBox[{":", 
              RowBox[{",", 
               RowBox[{"i", "+", "1"}]}]}], ")"}]}], ",", "wavelength_spd", 
           ",", 
           RowBox[{"'", 
            RowBox[{"linear", "'"}]}], ",", "0"}], ")"}]}]}]}], ";", 
      RowBox[{"%", "TCS\:7b2c1\:5217\:4e3a\:6ce2\:957f"}]}], "\:ff0c", 
     "\:989c\:8272\:6837\:54c1TCS0", "\:ff0c", "TCS1", "\:3002", "\:3002", 
     "\:3002", "\:662f\:7b2c2", "\:ff0c", "3", "\:ff0c", "\:3002", "\:3002", 
     "\:3002", 
     RowBox[{"\:5217", "\n", "end"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "TcsData", "=", 
     "\"\<1:eJyNmXvYz+Udx3+/\
H6M2chxGmnNIZA45ReIhOeZxqjFxFT0mcpiFDlyNKYldkbEmZEYTG41NmJG0MYdK5tCcRo5JlGrT5v\
16rvttv+f+PV37533dx9fz/d335/O5P/f9VB44vPug/olEYlTBq9IpZ9ToQcX+\
t5bzcDKRyBl9tZbTSNJM0lQyXdJV8qKkoyRLUltyj2S9pL2k2lXJA35E4CnqvF3S3PKG5F7J7yRdJH\
dLbvFfXCHplA94pMAvG3eHpKXklOQ+yX5JD0kHya2SXpJ5ku75gH8s8AZ13ilpJWkjKaqOESpVV+l+\
ldpJ6kkGSqYmQkcG8OOadcCzWnsBb1bHbJXGqfSwSndJvicZLnksEToygCdq1nkvW1tJNvPVsU2lbS\
pN9Bo1loyVDJY8lQ94smb92+vJZ/\
djvjqulxRJXZVXbTPNjWMVFrBaMXiqpiYkD3nfcyRN1JYtqSLwxzYctmGi9+\
1dSY0YPMPg4d53zLqp2uZKbha4lUoNvdBP2dKuY0gMnqX2r4zr4AVsro5dklsEnm9wGw9p6w/\
IAJ7rNR5jg3g8ET7xrKSewDtUamDcaBtoT3XUjMEvq/1zGw/gJ/nF/EXJbQIfTQZLw68ftW0+\
oI5aMXiR2i/51wGegH2o4xti1pecTgcPlRA/BqujdgxemgxbPs5r/DR/wpZWV3JS1fq2yBybZU4+\
4OVqP5cO/qmkizpKiVnHS3GbLRJ/G8+3s78xeJXaT6aDiQGYcPlUMLd9bKOHAJ4vITzWicF/UPsJ/\
31mzcCt1FEpFQSrqGvrZSl2SobnA16v9qM2MsCzvdt8bFnJpjA/\
NzIPkeBXIyS3xmAmHLEzYRW4P0cLy/tNyZqwR7khapikDqdPPuCtav+\
HjQwLWpYIXwL4S5VeDeaa00cyisFqGxPWKA94u9oP2sg6S9ZKnuATbWm/\
lCjW5PT3hrANj4VdzQPerXYOn8mSbpK/SZ5VR3WB96g0TVIVj/Dg76ttfLDDPOD31f53SHi+\
5LjkBXVUFHijSk9KKrNGkpkMVtuE4JJ5wAfU/r6Gcd7/QEKwm2sHeU2lYZLvskaSX+\
MqapsUwl4e8GGDSR8ekXyHk1tSWOCfJ4P13aTe5yUbJQ28RrfH4OMGkwMQ2BqqbSFhj+\
NOci8ro96FEo7f8mojoDeNwae9xsu9dp3U9koyGMQPJVmSG9VL/kMET6qNE6BlDD5vq9hgE+\
ZnL0gGg2CPGhvMx1Z1JGAH2sTgS2o/ZM9/SzLShotftiV+GVzIP2C7qm+\
o1DEGf2GXRj7AudU2R7KCncHSvMb1k8GEV/IpKmXH4K8chD6RXMD6k8GO5xEIJBVsFcTJByVz8SaV+\
sbgAqkAviIpqGE43XMSsg7Ws7TB7NYAzEXVd/g7Mfi6VFgFmGWMw/DH+\
mNvsIMQBAgTGD37OzQGFzWYzKOuZIqEIDRIUiIZtgzwFZU6Q1d1Lx8Qg0sKfEwjvsUu2CNG29JI4Aj\
qlTSOjKtZsIWc/fy8GMzxgEGSEI/0AlxzC9boX4kAztKMGsEtcg6q9HwMvlHDzmpEca/\
CcG9PIwkO9qWGEN0GakYxtZEYHVPpxRhcWcM+\
TYR9ny4ZKOklqW4wX1xFMk4zyJ04UE4Hw8sDrpEKlkZImeGV5dwpKykgIZQS6Kd5V6hycP0iBpNKFr\
JvPSNpL7nT+8Yap/gBBGqyAZVwxBuIrDGYjK+4owFXEnJuYuc1p8EY+\
e2LNWMdcZv1UPWFGNwoFVyAjcJfa1rwcD4WmyGvWOGbQxlJO1Wfi8HN1F5bs8hb+\
0nKEckkpxPBhPlR5G6/14w5KpWSDElltuNWam+\
pWR0kxPjCyWBQ7BH7VpLlUWmtZnDylpBMVfWJGNw2Fcygq4QLwmWv7BGDCSItVFofSLngJaqOicEdU\
sEjsr2DHP/QSZEKeGXIBzdqxkiD+\
TuPxuAuap9s660o4Ww96bhPYOOiOkjVP2sGSWFx4nGo5gFnsxUGs0ecTwctfGwLHN7gBw3ep+\
pDMbiP2pfYhzHXPxLADSaU9pVw3m7SjAcMPqzqwBjcT+2rDCYu8A7xtsEcphMcOzdrRl+\
DT6jaPwYTq9YaTL6wlA8zuI86Vkq6GXy/wadU7ReDBzvt62lLW8RuGzxEHVxuFhrc2+Az4e/kAQ/\
1PaCnfXh+Iiw0CQdxv7jGkSu8ieUbfFbV+2LwCLVvth2f0diXJGskeB7HahON4/\
AA3D0d3DsGj0kH4xvkC6+zgBJidF+Nmyh5S0KCXtLgXjF4vMHdJYc1VtE19+\
2Kpxcy5R8R0yRbJV3TwT1j8IR0MLvFdey3Ei7ZXLenaBxe9rakSzq4RwyeZDAZ8D6NnZUIxsxJRz45\
W+P+Kfnr/wd+1laBkZIpzzSYGL9askjjPpNsN7jU14GnG9w1A5jIzOX1NY1LFbgqOwwu/\
XXgmV4KrvsH0sFFMFwJ50ZRgXepxNtkWTtIhs2bY3AnW8UsWwVp218k6zSujMDvqMS9t5zBGex4ntq\
3GHzCVoEdc25w8SdYVhR4j0rce8sbnCE/fgWbd4bykR0Ez+\
NiRga8ReOqCrwvRJ3cdPlMiKJ5wBxZWw3Gvnhl5UJNXvBeMlhvLYEPqMRZUtXgQTGY3WYV73H6sNDR\
7SZOKsk2jasr8KFwyOW+JAMeFoNXYvM+/itJfqUJG/kmnEaC0zUQ+JhP6SYGj4/\
Ba7B5Tb3b2dUSTdgsIR36QLJT45oIzJExTb28mpxW9ZkYjBntMLiHhPxpq4Tjjgx4t8a1KBBIC9Q7w\
OAMSSFmtFNTyTG55P9GEzjzeLg8lQxu0VJgXG21eicYvDQGE115G+VpcHL6F3NV+\
NhL0UrgcyrxYr1Yciokn3nA7DY3LCAveY1JLgillzFmjWst8HmVOLPIEE7yk2MwPxEX4JTnjsuXvCn\
pr+p/JPhbG4EvqMQ1llzhQ1WPxuA96eA/ESJtFbwvFtKQvZK2An+\
SCkxu1XzxxRi8Px28PR3MExV3zH0GX1SJfI5LEGus1DQP+\
JDBbYjHdhCWggO6tIbwAVkGcxP6WTIYybdjMKfNuxpBRn/\
Em7clEaZWMLidwdXUsYGwpWqNGHzK4NasmGSZ7ZjXkCoGtzcYzzlucOMY/JHB3L/\
OSYjxWCrP1rXSwZcCKfflALPOisEXDeYicoFjSEyeC19XtV46+\
FOVuKTzVssaZ8fgzw0mteaJiLRtVyJYX6N0MEf1HSyewQNi8BWDudd8xrEs5nsS4mmzdPDlVDCh3ir\
lxuMYzIl+DUw+SSjeK+H5pFUGMKfCEIPHx+\
DCBrNsvD1tEpOciFB8VwYwucJYgyfH4CLp4IKpYMJkGBhUVgYw0WmSwdNjcAmDm9qCMGGueFhf+\
wzg3uqYoVJuoI/BZdLB/\
EeFF0AFrFwj4Y55IB3MJWquwfNjcAWSGx93xQgdYn4o4ZWjYwYwDzsLDV4cgyulg3mJ5g2V/+\
YkVO2UAcx/mJYYvCwGVzeYJ0wetY6IqRCb+0+\
szhnAvGssV4lgszIG104HE8m4eXwhuR7TMridPY9XuVUGr4nB9dLBlcJ5kHtGFE0HZzlW8MSz2uB1M\
bihxu42uJqG8UDBO1OJ/MA/IaYYvDEGNyWXNrimhnFTL+HDo6vBbR02eatdZ/\
DmGNzSYEIsr2U805TzXnbLAOZ1eYPByoP/C4Z3Bek=\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TCS", "=", 
     RowBox[{"Uncompress", "[", "TcsData", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TCS1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "spdDataWaveLength", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "14"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"TCS1", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "i"}], "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"Interpolation", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TCS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"TCS", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", 
               RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "}"}], "//", 
          "Transpose"}], "]"}], "[", "spdDataWaveLength", "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"%", " ", "Calculate", " ", "u"}], ",", 
     RowBox[{
     "v", " ", "chromaticity", " ", "coordinates", " ", "of", " ", "samples", 
      " ", "under", " ", "test", " ", "illuminant"}], ",", "uk", ",", 
     RowBox[{"vk", " ", "and", " ", "reference", " ", "illuminant"}], ",", 
     "ur", ",", 
     RowBox[{"vr", "."}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"uki", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vki", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"uri", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vri", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "\:5f85\:6d4b\:5149\:6e90\:7684u", "\:3001", 
     "v\:5df2\:7ecf\:8ba1\:7b97\:8fc7", "\:ff0c", 
     "\:6b64\:5904\:4e0d\:518d\:91cd\:590d"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"uk", "=", "u"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vk", "=", "v"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\:8ba1\:7b97\:53c2\:8003\:5149\:6e90\:7684u", "\:3001", "v"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fSpdref", "=", 
     RowBox[{
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"cie1931WaveLength", ",", "spdref"}], "}"}], "//", 
        "Transpose"}], "]"}], "[", "spdDataWaveLength", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{
      RowBox[{"fSpdref", "*", 
       RowBox[{"fCie1931X", "[", "spdDataWaveLength", "]"}], "*", 
       "deltaLamda"}], "//", "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y", "=", 
     RowBox[{
      RowBox[{"fSpdref", "*", 
       RowBox[{"fCie1931Y", "[", "spdDataWaveLength", "]"}], "*", 
       "deltaLamda"}], "//", "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Z", "=", 
     RowBox[{
      RowBox[{"fSpdref", "*", 
       RowBox[{"fCie1931Z", "[", "spdDataWaveLength", "]"}], "*", 
       "deltaLamda"}], "//", "Total"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yrnormal", "=", 
     RowBox[{"100", "/", "Y"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Yr", "=", 
     RowBox[{"Y", "*", "Yrnormal"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ur", "=", 
     RowBox[{"4", "*", 
      RowBox[{"X", "/", 
       RowBox[{"(", 
        RowBox[{"X", "+", 
         RowBox[{"15", "*", "Y"}], "+", 
         RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"vr", "=", 
     RowBox[{"6", "*", 
      RowBox[{"Y", "/", 
       RowBox[{"(", 
        RowBox[{"X", "+", 
         RowBox[{"15", "*", "Y"}], "+", 
         RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"DC", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"uk", "-", "ur"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vk", "-", "vr"}], ")"}], "^", "2"}]}], "]"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yki", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yri", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "14"}], ",", 
     RowBox[{"i", "++"}], ",", "\n", "   ", 
     RowBox[{
      RowBox[{"X", "=", 
       RowBox[{
        RowBox[{"spdData", "*", 
         RowBox[{"TCS1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", 
         RowBox[{"fCie1931X", "[", "spdDataWaveLength", "]"}], "*", 
         "deltaLamda"}], "//", "Total"}]}], ";", "\n", "   ", 
      RowBox[{"Y", "=", 
       RowBox[{
        RowBox[{"spdData", "*", 
         RowBox[{"TCS1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", 
         RowBox[{"fCie1931Y", "[", "spdDataWaveLength", "]"}], "*", 
         "deltaLamda"}], "//", "Total"}]}], ";", "\n", "   ", 
      RowBox[{"Z", "=", 
       RowBox[{
        RowBox[{"spdData", "*", 
         RowBox[{"TCS1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", 
         RowBox[{"fCie1931Z", "[", "spdDataWaveLength", "]"}], "*", 
         "deltaLamda"}], "//", "Total"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yki", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Y", "*", "Yknormal"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"uki", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"4", "*", 
        RowBox[{"X", "/", 
         RowBox[{"(", 
          RowBox[{"X", "+", 
           RowBox[{"15", "*", "Y"}], "+", 
           RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vki", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"6", "*", 
        RowBox[{"Y", "/", 
         RowBox[{"(", 
          RowBox[{"X", "+", 
           RowBox[{"15", "*", "Y"}], "+", 
           RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";", "\[IndentingNewLine]",
       "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{
        RowBox[{"fSpdref", "*", 
         RowBox[{"TCS1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", 
         RowBox[{"fCie1931X", "[", "spdDataWaveLength", "]"}], "*", 
         "deltaLamda"}], "//", "Total"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Y", "=", 
       RowBox[{
        RowBox[{"fSpdref", "*", 
         RowBox[{"TCS1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", 
         RowBox[{"fCie1931Y", "[", "spdDataWaveLength", "]"}], "*", 
         "deltaLamda"}], "//", "Total"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Z", "=", 
       RowBox[{
        RowBox[{"fSpdref", "*", 
         RowBox[{"TCS1", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "i"}], "]"}], "]"}], "*", 
         RowBox[{"fCie1931Z", "[", "spdDataWaveLength", "]"}], "*", 
         "deltaLamda"}], "//", "Total"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Yri", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Y", "*", "Yrnormal"}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"uri", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"4", "*", 
        RowBox[{"X", "/", 
         RowBox[{"(", 
          RowBox[{"X", "+", 
           RowBox[{"15", "*", "Y"}], "+", 
           RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"vri", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"6", "*", 
        RowBox[{"Y", "/", 
         RowBox[{"(", 
          RowBox[{"X", "+", 
           RowBox[{"15", "*", "Y"}], "+", 
           RowBox[{"3", "*", "Z"}]}], ")"}]}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "%", " ", "Check", " ", "tolorence", " ", "for", " ", "reference", " ", 
     "illuminant"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"DC", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"uk", "-", "ur"}], ")"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"vk", "-", "vr"}], ")"}], "^", "2"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<DC=\>\"", ",", "DC", ",", "\"\<  (It should <5.4*10^-3)\>\""}], 
    "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"%", " ", "Apply", " ", "adaptive", " ", 
     RowBox[{"(", "perceived", ")"}], " ", "color", " ", 
     RowBox[{"shift", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ck", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "-", "uk", "-", 
        RowBox[{"10", "*", "vk"}]}], ")"}], "/", "vk"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dk", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.708", "*", "vk"}], "+", "0.404", "-", 
        RowBox[{"1.481", "*", "uk"}]}], ")"}], "/", "vk"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cr", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"4", "-", "ur", "-", 
        RowBox[{"10", "*", "vr"}]}], ")"}], "/", "vr"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dr", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.708", "*", "vr"}], "+", "0.404", "-", 
        RowBox[{"1.481", "*", "ur"}]}], ")"}], "/", "vr"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ukip", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"vkip", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "14"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cki", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"4", "-", 
          RowBox[{"uki", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", 
          RowBox[{"10", "*", 
           RowBox[{"vki", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"vki", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\n", "   ", 
      RowBox[{"dki", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"1.708", "*", 
           RowBox[{"vki", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], "+", "0.404", "-", 
          RowBox[{"1.481", "*", 
           RowBox[{"uki", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"vki", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\n", "   ", 
      RowBox[{
       RowBox[{"ukip", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"10.872", "+", 
          RowBox[{"0.404", "*", 
           RowBox[{"cr", "/", "ck"}], "*", "cki"}], "-", 
          RowBox[{"4", "*", 
           RowBox[{"dr", "/", "dk"}], "*", "dki"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"16.518", "+", 
          RowBox[{"1.481", "*", 
           RowBox[{"cr", "/", "ck"}], "*", "cki"}], "-", 
          RowBox[{
           RowBox[{"dr", "/", "dk"}], "*", "dki"}]}], ")"}]}]}], ";", "\n", 
      "   ", 
      RowBox[{
       RowBox[{"vkip", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"5.520", "/", 
        RowBox[{"(", 
         RowBox[{"16.518", "+", 
          RowBox[{"1.481", "*", 
           RowBox[{"cr", "/", "ck"}], "*", "cki"}], "-", 
          RowBox[{
           RowBox[{"dr", "/", "dk"}], "*", "dki"}]}], ")"}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "%", " ", "Transformation", " ", "into", " ", "1964", " ", "Uniform", " ",
      "space", " ", 
     RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Wstarr", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ustarr", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstarr", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Wstark", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ustark", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Vstark", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "14"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Wstarr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"25", "*", 
         RowBox[{
          RowBox[{"Yri", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", ".333333"}]}], "-", "17"}]}], 
      ";", "\n", "   ", 
      RowBox[{
       RowBox[{"Ustarr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstarr", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"uri", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "ur"}], ")"}]}]}], ";", "\n", 
      "   ", 
      RowBox[{
       RowBox[{"Vstarr", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstarr", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vri", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "vr"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\n", "   ", 
      RowBox[{
       RowBox[{"Wstark", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"25", "*", 
         RowBox[{
          RowBox[{"Yki", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "^", ".333333"}]}], "-", "17"}]}], 
      ";", "\n", "   ", 
      RowBox[{
       RowBox[{"Ustark", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstark", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ukip", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "ur"}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "%", " ", "after", " ", "applying", " ", "the", " ", "adaptive", " ", 
         "color", " ", "shift"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "'"}], "k"}], "=", "ur"}]}], "*)"}], "\n", "   ", 
      RowBox[{
       RowBox[{"Vstark", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"13", "*", 
        RowBox[{"Wstark", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"vkip", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "-", "vr"}], ")"}]}]}], ";"}]}], 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "%", " ", "after", " ", "applying", " ", "the", " ", "adaptive", " ", 
       "color", " ", "shift"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "'"}], "k"}], "=", "vr"}]}], "*)"}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"deltaE", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"R", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"0", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "14"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "\[LessEqual]", "14"}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"deltaE", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Ustarr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"Ustark", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Vstarr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"Vstark", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Wstarr", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"Wstark", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ")"}], "^", "2"}]}], "]"}]}], 
      ";", "\n", "   ", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "=", 
       RowBox[{"100", "-", 
        RowBox[{"4.6", "*", 
         RowBox[{"deltaE", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}]}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ra", "=", 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"R", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "8"}], "]"}], "]"}], "]"}], "/", "8"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<CRI=\>\"", ",", "Ra"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.656044551662611*^9, 3.65604473133047*^9}, {
   3.6560449303750496`*^9, 3.656044931167576*^9}, {3.656044995891722*^9, 
   3.6560451201304193`*^9}, {3.6560451994227047`*^9, 
   3.6560452250672493`*^9}, {3.6560457789325304`*^9, 
   3.6560459533875256`*^9}, {3.6560603196329613`*^9, 
   3.6560603307953677`*^9}, {3.656060381852831*^9, 3.6560604529756174`*^9}, {
   3.656060525437869*^9, 3.6560606505815496`*^9}, {3.656060681825283*^9, 
   3.656060686620463*^9}, {3.6560607246016836`*^9, 3.6560608201826715`*^9}, {
   3.6560608590124345`*^9, 3.656060881349084*^9}, {3.656060958099415*^9, 
   3.656061212666354*^9}, {3.656061262645093*^9, 3.656061265150755*^9}, {
   3.6560613072497654`*^9, 3.6560613188704762`*^9}, {3.6560614857838707`*^9, 
   3.656061621489953*^9}, {3.656061665843615*^9, 3.6560618575190463`*^9}, {
   3.65606190424146*^9, 3.6560619781235228`*^9}, {3.6560620121150784`*^9, 
   3.6560620673655415`*^9}, {3.656062114920741*^9, 3.6560623475898485`*^9}, {
   3.656062411926323*^9, 3.6560624144479933`*^9}, {3.6561126963496637`*^9, 
   3.656112719056402*^9}, {3.656113212280444*^9, 3.6561132617151318`*^9}, {
   3.656113995053588*^9, 3.6561140106015873`*^9}, {3.656114086779769*^9, 
   3.6561141173677444`*^9}, {3.656114189028053*^9, 3.6561142340495605`*^9}, {
   3.6561142735006943`*^9, 3.656114292910838*^9}, {3.656114418530402*^9, 
   3.6561144755286937`*^9}, {3.6561147036073675`*^9, 3.6561147665453796`*^9}, 
   3.656114809379445*^9, 3.6561247398040347`*^9, 3.6561256991969395`*^9, {
   3.656126420594716*^9, 3.656126498557197*^9}, {3.656126529867778*^9, 
   3.6561265324391327`*^9}, {3.656126654362162*^9, 3.6561266670971684`*^9}, {
   3.6561267005747995`*^9, 3.656126765436059*^9}, {3.656126870566415*^9, 
   3.656126896781559*^9}, {3.6561269365589104`*^9, 3.656126937637088*^9}, {
   3.65612705987431*^9, 3.656127151798509*^9}, {3.6561272013365507`*^9, 
   3.6561274090706377`*^9}, {3.6561274669125776`*^9, 
   3.6561276141891656`*^9}, {3.656127737620745*^9, 3.6561277677386165`*^9}, {
   3.656127851587859*^9, 3.656127915192738*^9}, {3.65612795349247*^9, 
   3.656128058464609*^9}, {3.656128102063467*^9, 3.6561282142786303`*^9}, {
   3.6561282999453783`*^9, 3.6561283944297695`*^9}, {3.6561284385882072`*^9, 
   3.656128439666381*^9}, {3.656128496517303*^9, 3.656128499158059*^9}, {
   3.656128590671059*^9, 3.656128629478546*^9}, {3.656128718913879*^9, 
   3.6561287245896215`*^9}, {3.6561292714700785`*^9, 
   3.6561293878818464`*^9}, {3.6561294604293385`*^9, 3.656129527222768*^9}, {
   3.6561296118060465`*^9, 3.6561297065169153`*^9}, {3.6561301902681675`*^9, 
   3.6561301947996554`*^9}, {3.6561302478934317`*^9, 3.656130478234369*^9}, {
   3.6561305255058575`*^9, 3.6561305990855494`*^9}, {3.656130629636742*^9, 
   3.656130720595606*^9}, {3.656131016013232*^9, 3.6561310179352036`*^9}, {
   3.6561310744732485`*^9, 3.6561311243305473`*^9}, {3.6561468601410513`*^9, 
   3.6561468894444804`*^9}, {3.6561469543595247`*^9, 
   3.6561469942597184`*^9}, {3.6561471153604584`*^9, 
   3.6561471232196665`*^9}, {3.6561471808285866`*^9, 3.656147210667373*^9}, {
   3.656147250541768*^9, 3.656147253515744*^9}, {3.656147308303542*^9, 
   3.6561473103198795`*^9}, {3.6561477368370533`*^9, 
   3.6561477370171723`*^9}, {3.656147791129285*^9, 3.65614784535145*^9}, {
   3.6561479086141653`*^9, 3.656147949768117*^9}, {3.6561480761586447`*^9, 
   3.6561480764648466`*^9}, {3.6561481616858244`*^9, 3.656148174564363*^9}, {
   3.6561482513687925`*^9, 3.6561484410305605`*^9}, {3.6561484831855516`*^9, 
   3.6561484864257*^9}, {3.65614851789958*^9, 3.6561485327914476`*^9}, {
   3.656148566835987*^9, 3.6561485764593706`*^9}, {3.656148798341508*^9, 
   3.65614880414876*^9}, {3.656148844797613*^9, 3.656148869911268*^9}, {
   3.6561494300495696`*^9, 3.656149455684084*^9}, {3.6561498486369777`*^9, 
   3.6561499221585665`*^9}, {3.6561500350418797`*^9, 
   3.6561500651034174`*^9}, {3.656150371295707*^9, 3.6561504230972624`*^9}, {
   3.656150471938512*^9, 3.656150648015173*^9}, {3.656150679578224*^9, 
   3.6561506915021296`*^9}, 3.6561507524600163`*^9, 3.6561508576082067`*^9, {
   3.65615089235666*^9, 3.656150911456329*^9}, {3.656151051981143*^9, 
   3.656151077608843*^9}, 3.656151139909439*^9, {3.6561511733095875`*^9, 
   3.656151231835568*^9}, {3.656151329405452*^9, 3.6561513603750095`*^9}, {
   3.6561513960161185`*^9, 3.6561514055094166`*^9}, {3.6561514387017264`*^9, 
   3.656151452223693*^9}, {3.656151551783847*^9, 3.6561515818437753`*^9}, {
   3.656151644014662*^9, 3.656151816682768*^9}, {3.6561519226009684`*^9, 
   3.6561519233284483`*^9}, {3.656151973664959*^9, 3.6561519751419387`*^9}, {
   3.6561522155382595`*^9, 3.6561523306241174`*^9}, {3.656152406135696*^9, 
   3.6561524689719734`*^9}, {3.656152559088375*^9, 3.656152564780164*^9}, {
   3.6561525985325427`*^9, 3.6561526403833203`*^9}, 3.6561526966556473`*^9, {
   3.6561527991434755`*^9, 3.656152821259183*^9}, 3.6561528865490003`*^9, {
   3.6561529527204475`*^9, 3.656153091975849*^9}, {3.6561534485802174`*^9, 
   3.656153454508149*^9}, {3.6561535403292556`*^9, 3.656153612765312*^9}, {
   3.6561536582364864`*^9, 3.6561537096991773`*^9}, {3.656153744472446*^9, 
   3.6561537932192936`*^9}, {3.656153829001112*^9, 3.656153880050966*^9}, {
   3.656153923792485*^9, 3.6561540884853144`*^9}, {3.656154172667656*^9, 
   3.656154191604723*^9}, {3.6561543198219156`*^9, 3.6561543381170506`*^9}, {
   3.656154386168172*^9, 3.6561544185266314`*^9}, 3.6561544580018787`*^9, 
   3.6561545097872314`*^9, {3.6561545916975603`*^9, 3.656154601915851*^9}, {
   3.656154682128883*^9, 3.6561547618213124`*^9}, {3.656154792351638*^9, 
   3.6561551185914354`*^9}, {3.6561553453314095`*^9, 3.6561553670778294`*^9}, 
   3.6561554340232162`*^9, {3.6561555198840113`*^9, 3.656155600105253*^9}, 
   3.6561557438372083`*^9, {3.656155869915193*^9, 3.656155979470809*^9}, {
   3.6561560110167356`*^9, 3.656156077838076*^9}, {3.6561562933369293`*^9, 
   3.6561563420541067`*^9}, 3.656156585048107*^9, 3.656156685990625*^9, {
   3.6561569218872623`*^9, 3.65615694532803*^9}, {3.6561571037847967`*^9, 
   3.656157124606149*^9}, {3.656157298457774*^9, 3.656157448459957*^9}, 
   3.6561574812431803`*^9, {3.6561579122920237`*^9, 3.6561579869654093`*^9}, {
   3.656216446780238*^9, 3.6562165054423795`*^9}, {3.656216653546072*^9, 
   3.6562166755927258`*^9}, {3.656216975118718*^9, 3.656216980164077*^9}, {
   3.6562170167672367`*^9, 3.656217062363108*^9}, 3.6562171296857104`*^9, {
   3.6562171847888384`*^9, 3.656217272090044*^9}, {3.6562173757309723`*^9, 
   3.6562175125592594`*^9}, {3.656217546250757*^9, 3.6562175994770927`*^9}, {
   3.6562176312471104`*^9, 3.6562176705273743`*^9}, {3.6562177096396008`*^9, 
   3.6562177321403117`*^9}, {3.6562184406455007`*^9, 3.656218473626421*^9}, {
   3.656218506252122*^9, 3.6562185595765676`*^9}, {3.6562186422150116`*^9, 
   3.6562186885389776`*^9}, {3.6562189546035633`*^9, 3.6562191379174*^9}, {
   3.65621926474802*^9, 3.6562193836053877`*^9}, {3.6562194731826935`*^9, 
   3.6562194941236086`*^9}, {3.6562195355119524`*^9, 3.656219561954531*^9}, {
   3.65621960431032*^9, 3.6562196115211096`*^9}, {3.6562199505662117`*^9, 
   3.6562201053996563`*^9}, {3.656220149229313*^9, 3.6562204924501147`*^9}, {
   3.6562205548356085`*^9, 3.656220730125185*^9}, {3.6562207918997545`*^9, 
   3.65622081766288*^9}, {3.6562208977876563`*^9, 3.656220902656432*^9}, {
   3.656221020460439*^9, 3.656221028058489*^9}, 3.656221141755473*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Tc<5000\"\>"], "Print",
 CellChangeTimes->{{3.6561548423973875`*^9, 3.656154857122152*^9}, {
   3.6561551104030027`*^9, 3.656155119396967*^9}, 3.6561553464501505`*^9, 
   3.6561557471974354`*^9, 3.656155872437863*^9, 3.6561563465570927`*^9, 
   3.6561566069256144`*^9, 3.6561567598076687`*^9, 3.6561569496538987`*^9, 
   3.656157886407154*^9, 3.656157942923334*^9, 3.656216344705419*^9, 
   3.6562172742955093`*^9, {3.6562174320487843`*^9, 3.6562174541804953`*^9}, 
   3.656217513137644*^9, {3.65621754869238*^9, 3.6562175511149898`*^9}, 
   3.656219082598733*^9, 3.6562191180201693`*^9, 3.656219384942275*^9, 
   3.6562194815132256`*^9, 3.656219531222101*^9, 3.656220084624848*^9, 
   3.6562203606245975`*^9, 3.65622044557765*^9, {3.656220731834319*^9, 
   3.6562207534026556`*^9}, 3.656220818406374*^9, {3.6562209034469566`*^9, 
   3.656220933566977*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"DC=\"\>", "\[InvisibleSpace]", "0.0032850128279384876`", 
   "\[InvisibleSpace]", "\<\"  (It should <5.4*10^-3)\"\>"}],
  SequenceForm["DC=", 0.0032850128279384876`, "  (It should <5.4*10^-3)"],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6561548423973875`*^9, 3.656154857122152*^9}, {
   3.6561551104030027`*^9, 3.656155119396967*^9}, 3.6561553464501505`*^9, 
   3.6561557471974354`*^9, 3.656155872437863*^9, 3.6561563465570927`*^9, 
   3.6561566069256144`*^9, 3.6561567598076687`*^9, 3.6561569496538987`*^9, 
   3.656157886407154*^9, 3.656157942923334*^9, 3.656216344705419*^9, 
   3.6562172742955093`*^9, {3.6562174320487843`*^9, 3.6562174541804953`*^9}, 
   3.656217513137644*^9, {3.65621754869238*^9, 3.6562175511149898`*^9}, 
   3.656219082598733*^9, 3.6562191180201693`*^9, 3.656219384942275*^9, 
   3.6562194815132256`*^9, 3.656219531222101*^9, 3.656220084624848*^9, 
   3.6562203606245975`*^9, 3.65622044557765*^9, {3.656220731834319*^9, 
   3.6562207534026556`*^9}, 3.656220818406374*^9, {3.6562209034469566`*^9, 
   3.6562209342764482`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"CRI=\"\>", "\[InvisibleSpace]", 
   RowBox[{"-", "103.42692959293751`"}]}],
  SequenceForm["CRI=", -103.42692959293751`],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6561548423973875`*^9, 3.656154857122152*^9}, {
   3.6561551104030027`*^9, 3.656155119396967*^9}, 3.6561553464501505`*^9, 
   3.6561557471974354`*^9, 3.656155872437863*^9, 3.6561563465570927`*^9, 
   3.6561566069256144`*^9, 3.6561567598076687`*^9, 3.6561569496538987`*^9, 
   3.656157886407154*^9, 3.656157942923334*^9, 3.656216344705419*^9, 
   3.6562172742955093`*^9, {3.6562174320487843`*^9, 3.6562174541804953`*^9}, 
   3.656217513137644*^9, {3.65621754869238*^9, 3.6562175511149898`*^9}, 
   3.656219082598733*^9, 3.6562191180201693`*^9, 3.656219384942275*^9, 
   3.6562194815132256`*^9, 3.656219531222101*^9, 3.656220084624848*^9, 
   3.6562203606245975`*^9, 3.65622044557765*^9, {3.656220731834319*^9, 
   3.6562207534026556`*^9}, 3.656220818406374*^9, {3.6562209034469566`*^9, 
   3.656220934290471*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"this", " ", "unit", " ", "used", " ", "to", " ", "test"}], " ", 
     "&"}], " ", "data", " ", "visualization"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"spdref", ";"}], "\[IndentingNewLine]", 
   RowBox[{"cie1931WaveLength", ";"}], "\[IndentingNewLine]", "deltaE", 
   "\[IndentingNewLine]", "R", "\[IndentingNewLine]", 
   RowBox[{"R", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "8"}], "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.656044551662611*^9, 3.65604473133047*^9}, {
   3.6560449303750496`*^9, 3.656044931167576*^9}, {3.656044995891722*^9, 
   3.6560451201304193`*^9}, {3.6560451994227047`*^9, 
   3.6560452250672493`*^9}, {3.6560457789325304`*^9, 
   3.6560459533875256`*^9}, {3.6560603196329613`*^9, 
   3.6560603307953677`*^9}, {3.656060381852831*^9, 3.6560605440292063`*^9}, 
   3.656060791840038*^9, 3.656061226916812*^9, {3.6560612574016137`*^9, 
   3.656061274969269*^9}, {3.6560613590241203`*^9, 3.6560613608477182`*^9}, {
   3.6560613990640736`*^9, 3.6560613994063034`*^9}, {3.6560614382912626`*^9, 
   3.6560614389116735`*^9}, {3.6560614694179163`*^9, 
   3.6560614802842207`*^9}, {3.656061869197796*^9, 3.656061890435889*^9}, 
   3.6560621555713015`*^9, {3.6560624589265404`*^9, 3.65606246638949*^9}, {
   3.6561142418338165`*^9, 3.656114249118534*^9}, {3.6561268079449863`*^9, 
   3.6561268287988415`*^9}, {3.656128505413418*^9, 3.6561285788112717`*^9}, 
   3.656128636529682*^9, 3.656129496451317*^9, {3.6561295363705325`*^9, 
   3.656129537683116*^9}, {3.6561307374574385`*^9, 3.6561307742834873`*^9}, {
   3.656131137293187*^9, 3.656131139324537*^9}, {3.656147029195881*^9, 
   3.6561470294610567`*^9}, 3.6561477499827743`*^9, {3.6561494838187437`*^9, 
   3.6561494913377275`*^9}, {3.656149838683378*^9, 3.656149842257748*^9}, {
   3.6561531032669163`*^9, 3.6561531766400433`*^9}, 3.6561532067570124`*^9, {
   3.656153317849502*^9, 3.6561534336913443`*^9}, {3.6561534657882357`*^9, 
   3.6561534741527805`*^9}, 3.656155154944935*^9, {3.656155187340418*^9, 
   3.6561551950455284`*^9}, 3.6561552695349245`*^9, {3.656155704255374*^9, 
   3.656155716066207*^9}, {3.656155787522174*^9, 3.656155788018507*^9}, {
   3.6561563864825673`*^9, 3.6561563915119014`*^9}, {3.656156423651227*^9, 
   3.656156535679378*^9}, {3.656156700340232*^9, 3.656156704624073*^9}, 
   3.6561567405408907`*^9, 3.6561567975927334`*^9, {3.656156957235929*^9, 
   3.656156990072702*^9}, 3.656216337643716*^9, {3.656216536395539*^9, 
   3.6562165491730328`*^9}, {3.656216744745216*^9, 3.6562167488609533`*^9}, {
   3.656216876217579*^9, 3.656216879505762*^9}, {3.656217315170101*^9, 
   3.6562173291994257`*^9}, {3.6562208341218224`*^9, 3.656220863462843*^9}, {
   3.6562210542278843`*^9, 3.6562210562352204`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "45.57413264777728`", ",", "31.428129669071023`", ",", 
   "25.400116438505346`", ",", "48.03219054603417`", ",", 
   "48.832869170152414`", ",", "47.36955021580197`", ",", "33.0579800556468`",
    ",", "74.09099576646756`", ",", "187.44611488875603`", ",", 
   "76.71307539129037`", ",", "58.691008768145664`", ",", 
   "116.8083207250848`", ",", "41.232784519228225`", ",", 
   "17.429152396372274`"}], "}"}]], "Output",
 CellChangeTimes->{{3.656156425508459*^9, 3.6561564362105584`*^9}, {
   3.656156505834233*^9, 3.656156536198722*^9}, 3.6561567061610937`*^9, 
   3.656156741022209*^9, 3.6561567982011385`*^9, {3.656156966266914*^9, 
   3.656156991236474*^9}, {3.6562163382731333`*^9, 3.656216344872528*^9}, 
   3.656216549836474*^9, 3.6562167512855654`*^9, 3.6562168817571087`*^9, {
   3.6562173167041225`*^9, 3.6562173388028092`*^9}, 3.65621755132113*^9, {
   3.6562208401193237`*^9, 3.656220864788723*^9}, {3.65622090682421*^9, 
   3.656220934316484*^9}, 3.656221056856633*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "109.64101017977549`"}], ",", 
   RowBox[{"-", "44.569396477726684`"}], ",", 
   RowBox[{"-", "16.840535617124587`"}], ",", 
   RowBox[{"-", "120.94807651175717`"}], ",", 
   RowBox[{"-", "124.6311981827011`"}], ",", 
   RowBox[{"-", "117.89993099268906`"}], ",", 
   RowBox[{"-", "52.06670825597527`"}], ",", 
   RowBox[{"-", "240.81858052575075`"}], ",", 
   RowBox[{"-", "762.2521284882777`"}], ",", 
   RowBox[{"-", "252.8801467999357`"}], ",", 
   RowBox[{"-", "169.97864033347003`"}], ",", 
   RowBox[{"-", "437.31827533539`"}], ",", 
   RowBox[{"-", "89.67080878844982`"}], ",", "19.82589897668754`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.656156425508459*^9, 3.6561564362105584`*^9}, {
   3.656156505834233*^9, 3.656156536198722*^9}, 3.6561567061610937`*^9, 
   3.656156741022209*^9, 3.6561567982011385`*^9, {3.656156966266914*^9, 
   3.656156991236474*^9}, {3.6562163382731333`*^9, 3.656216344872528*^9}, 
   3.656216549836474*^9, 3.6562167512855654`*^9, 3.6562168817571087`*^9, {
   3.6562173167041225`*^9, 3.6562173388028092`*^9}, 3.65621755132113*^9, {
   3.6562208401193237`*^9, 3.656220864788723*^9}, {3.65622090682421*^9, 
   3.656220934316484*^9}, 3.656221056858633*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "109.64101017977549`"}], ",", 
   RowBox[{"-", "44.569396477726684`"}], ",", 
   RowBox[{"-", "16.840535617124587`"}], ",", 
   RowBox[{"-", "120.94807651175717`"}], ",", 
   RowBox[{"-", "124.6311981827011`"}], ",", 
   RowBox[{"-", "117.89993099268906`"}], ",", 
   RowBox[{"-", "52.06670825597527`"}], ",", 
   RowBox[{"-", "240.81858052575075`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.656156425508459*^9, 3.6561564362105584`*^9}, {
   3.656156505834233*^9, 3.656156536198722*^9}, 3.6561567061610937`*^9, 
   3.656156741022209*^9, 3.6561567982011385`*^9, {3.656156966266914*^9, 
   3.656156991236474*^9}, {3.6562163382731333`*^9, 3.656216344872528*^9}, 
   3.656216549836474*^9, 3.6562167512855654`*^9, 3.6562168817571087`*^9, {
   3.6562173167041225`*^9, 3.6562173388028092`*^9}, 3.65621755132113*^9, {
   3.6562208401193237`*^9, 3.656220864788723*^9}, {3.65622090682421*^9, 
   3.656220934316484*^9}, 3.6562210568606358`*^9}]
}, Open  ]]
},
WindowSize->{1350, 631},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (2013\:5e742\:670813\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 22191, 429, 3132, "Input"],
Cell[22773, 453, 582, 11, 23, "Print"],
Cell[23358, 466, 140, 2, 31, "Output"],
Cell[23501, 470, 142, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23680, 477, 18865, 486, 1258, "Input"],
Cell[CellGroupData[{
Cell[42570, 967, 484, 10, 23, "Print"],
Cell[43057, 979, 370, 8, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[43476, 993, 40602, 992, 3352, "Input"],
Cell[CellGroupData[{
Cell[84103, 1989, 875, 12, 23, "Print"],
Cell[84981, 2003, 1109, 17, 23, "Print"],
Cell[86093, 2022, 1034, 17, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87176, 2045, 2889, 47, 192, "Input"],
Cell[90068, 2094, 1026, 17, 31, "Output"],
Cell[91097, 2113, 1248, 24, 31, "Output"],
Cell[92348, 2139, 991, 18, 31, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
